(this.webpackJsonptranscribe=this.webpackJsonptranscribe||[]).push([[0],{276:function(e,t,n){"use strict";n.r(t);var a=n(8),r=(n(207),n(344)),s=n(321),i=n(0),c=n.n(i),o=n(28),l=n(37),u=n(1),d=n(2),p=n(168),h=n.n(p),b=n(190),j=function e(){Object(u.a)(this,e)};j.range=function(e,t){return e>t&&(e=t),Array(t-e+1).fill(e).map((function(t,n){return(e+n).toString()}))},j.bordersOf=function(e){return{start:parseInt(e[0]),end:parseInt(j.last(e))}},j.last=function(e){return e[e.length-1]};var f,m,O=j;function y(e){switch(e){case f.FOUR_FOUR.toString():return f.FOUR_FOUR;case f.THREE_FOUR.toString():return f.THREE_FOUR;default:throw Error("Unknown time signature type: "+e)}}function g(e,t,n,a){for(var r,s=t;s<n;s++)delete e.byId[e.allIds[s]];var i=[];a.forEach((function(t){var n=v(t);i.push(n),e.byId[n]=t})),(r=e.allIds).splice.apply(r,[t,n].concat(i))}function v(e){return e.type+"_"+e.measures[0]+"_"+e.measures[e.measures.length-1]}function x(e,t){return t.allIds.length-1>e?t.byId[e+1].time:2*t.byId[e].time-t.byId[e-1].time}function I(e,t,n,a){for(var r=60*function(e){switch(e){case f.FOUR_FOUR:return{beatUnit:4,beatsPerMeasure:4};case f.THREE_FOUR:return{beatUnit:4,beatsPerMeasure:3}}}(e).beatsPerMeasure/t,s={allIds:[],byId:{}},i=0,c=n;c<a;c+=r)s.allIds.push(""+i),s.byId[i]={time:c,color:"",editable:!1,id:""+i,labelText:""+i},i++;return s}!function(e){e.FOUR_FOUR="FOUR_FOUR",e.THREE_FOUR="THREE_FOUR"}(f||(f={})),function(e){e.INTRO="INTRO",e.VERSE="VERSE",e.PRECHORUS="PRECHORUS",e.CHORUS="CHORUS",e.BRIDGE="BRIDGE",e.SOLO="SOLO",e.OUTRO="OUTRO",e.UNDEFINED="UNDEFINED"}(m||(m={}));var E=Object(b.a)({palette:{type:"light",primary:h.a,background:{default:"#d5d8da"}},logo:{height:"40px",marginRight:"5px"},popover:{width:"200px",minHeight:"50px",margin:"10px",marginTop:"20px"},measureSelect:{minWidth:"40px"},formControl:{marginBottom:"20px"},sectionTypes:{INTRO:"#FFCA28",VERSE:"#FFA726",PRECHORUS:"#FF7043",CHORUS:"#9CCC65",SOLO:"#26C6DA",OUTRO:"#5C6BC0",BRIDGE:"#EC407A",UNDEFINED:"#f2f2f2"},sectionSelect:{minWidth:"140px"},view:{background:"#ffffff",headerBackground:"#f1f4f6",headerPadding:"4px"},waveform:{pointMarkerColor:"#006eb0"},overrides:{MuiListItemIcon:{root:{color:"#abb1b7"}}}});function S(e){var t=C.get(e);if(!t)throw Error("Unknown SectionType "+e);return t}var C=new Map([[m.INTRO,E.sectionTypes.INTRO],[m.VERSE,E.sectionTypes.VERSE],[m.PRECHORUS,E.sectionTypes.PRECHORUS],[m.CHORUS,E.sectionTypes.CHORUS],[m.SOLO,E.sectionTypes.SOLO],[m.OUTRO,E.sectionTypes.OUTRO],[m.BRIDGE,E.sectionTypes.BRIDGE],[m.UNDEFINED,E.sectionTypes.UNDEFINED]]),T=E,k="audio_dom_element",R="zoomview-container",N="overview-container",w=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"create",value:function(e,t){var n=document.getElementById(k);return{containers:{zoomview:document.getElementById(R),overview:document.getElementById(N)},mediaElement:n,webAudio:{audioBuffer:e,scale:128,multiChannel:!1},keyboard:!0,pointMarkerColor:T.waveform.pointMarkerColor,showPlayheadTime:!0,zoomLevels:[42],player:t}}},{key:"sectionsToSegment",value:function(e,t,n){var a=[];return e.allIds.forEach((function(r){var s=e.byId[r],i=t.byId[s.measures[0]].time,c=t.byId[s.measures[s.measures.length-1]].time+n,o={id:r,labelText:s.type,startTime:i,endTime:c,color:S(s.type),editable:!1};a.push(o)})),a}},{key:"measuresToPoints",value:function(e){var t=[];return e.allIds.forEach((function(n){var a=e.byId[n];t.push(a)})),t}}]),e}(),D=n(10),P=n(4),U=n(3),F=n(317),A=n(312),L=n(335),M=n(285),H=n(346),z=n(283),B=n(284),_=n(337),W=n(338),G=n(14),Z=n(336),V=n(48),Y=n(185),J=n.n(Y),K=n(182),X=n.n(K),q=n(183),Q=n.n(q),$=n(186),ee=n.n($),te=n(184),ne=n.n(te),ae=n(169),re=n.n(ae),se=function e(t,n){Object(u.a)(this,e),this.name=t,this.color=n};se.TRACE=new se("trace","lightblue"),se.INFO=new se("info","blue"),se.WARN=new se("warn","yellow"),se.ERROR=new se("error","red");var ie,ce,oe=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"generateMessage",value:function(e,t,n){var a="transcribe:".concat(e.name),r=re()(a);r.color=e.color,n?r(n,t):r(t)}},{key:"trace",value:function(e,t){this.generateMessage(se.TRACE,e,t)}},{key:"info",value:function(e,t){this.generateMessage(se.INFO,e,t)}},{key:"warn",value:function(e,t){this.generateMessage(se.WARN,e,t)}},{key:"error",value:function(e,t){this.generateMessage(se.ERROR,e,t)}}]),e}(),le=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{className:this.props.show?this.props.classes.inline:this.props.classes.invisible,children:this.props.children})}}]),n}(i.Component),ue=Object(G.a)((function(){return Object(A.a)({inline:{display:"inline"},invisible:{display:"none"}})}),{withTheme:!0})(le),de=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[this.props.version," (",Object(a.jsxs)("a",{href:"https://github.com/tscz/transcribe/commit/"+this.props.hash,children:[this.props.hash," - ",this.props.description]}),")"]})}}]),n}(c.a.Component),pe=n(315),he=n(314),be=n(316),je=Object(G.a)((function(e){return Object(A.a)({root:{height:"100%",backgroundColor:e.view.background},header:{backgroundColor:e.view.headerBackground,padding:e.view.headerPadding}})}))((function(e){return Object(a.jsxs)(he.a,{className:e.classes.root,raised:!1,children:[Object(a.jsx)(pe.a,{titleTypographyProps:{variant:"subtitle1"},title:e.title,className:e.classes.header,action:e.action}),Object(a.jsx)(be.a,{children:e.body})]})})),fe=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(je,{title:"Info",body:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{children:"No Transcription started!!"}),Object(a.jsx)("p",{children:"Please create a new Transcription or open an existing one."})]})})}}]),n}(i.Component),me=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(je,{title:"Drums View",body:Object(a.jsx)("p",{children:"In this section you'll be able to transcribe the drum part. Please come back later."})})}}]),n}(c.a.Component),Oe=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(je,{title:"Guitar",body:Object(a.jsx)("p",{children:"In this section you'll be able to transcribe the guitar part. Please come back later."})})}}]),n}(c.a.Component),ye=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(je,{title:"Harmony",body:Object(a.jsx)("p",{children:"In this section you'll be able to transcribe the harmony. Please come back later."})})}}]),n}(c.a.Component),ge=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(je,{title:"Print",body:Object(a.jsx)("p",{children:"In this section you'll be able to print the leadsheet. Please come back later."})})}}]),n}(c.a.Component),ve=n(152),xe=n(330),Ie=n(349),Ee=n(318),Se=n(319),Ce=n(132),Te=n(333),ke=n(179),Re=n.n(ke),Ne=n(178),we=n.n(Ne),De=n(175),Pe=n.n(De),Ue=n(177),Fe=n.n(Ue),Ae=n(173),Le=n.n(Ae),Me=n(174),He=n.n(Me),ze=n(176),Be=n.n(ze),_e=n(181),We=n.n(_e),Ge=n(334),Ze=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(F.a,{container:!0,spacing:2,alignItems:"stretch",children:[Object(a.jsx)(F.a,{item:!0,xs:10,children:Object(a.jsxs)(F.a,{container:!0,spacing:2,alignItems:"stretch",children:[Object(a.jsx)(F.a,{item:!0,xs:12,children:this.props.topLeft}),Object(a.jsx)(F.a,{item:!0,xs:12,children:Object(a.jsxs)(F.a,{container:!0,spacing:2,alignItems:"stretch",children:[Object(a.jsx)(F.a,{item:!0,xs:10,children:this.props.bottomLeft}),Object(a.jsx)(F.a,{item:!0,xs:2,children:this.props.bottomRight})]})})]})}),Object(a.jsx)(F.a,{item:!0,xs:2,children:this.props.topRight})]})}}]),n}(i.Component),Ve=n(347),Ye=n(348),Je=Object(G.a)((function(){return Object(A.a)({root:{width:"100%"}})}))((function(e){return Object(a.jsxs)(Ee.a,{className:e.classes.root,children:[Object(a.jsx)(Se.a,{shrink:!0,children:e.title}),Object(a.jsx)(Ve.a,{mt:2,children:Object(a.jsx)(Ye.a,{value:e.value,valueLabelDisplay:"auto",min:e.min,max:e.max,onChange:e.onChange,step:e.step})})]})})),Ke=n(41);!function(e){e.NOT_INITIALIZED="not_initialized",e.INITIALIZING="initializing",e.INITIALIZED="initialized"}(ie||(ie={})),function(e){e.DEFAULT="default",e.STRUCTURE="structure",e.HARMONY="harmony",e.GUITAR="guitar",e.DRUM="drum",e.PRINT="print"}(ce||(ce={}));var Xe,qe={status:ie.NOT_INITIALIZED,currentPage:ce.DEFAULT,title:"",audioUrl:"",syncFirstMeasureStart:!1},Qe=Object(Ke.c)({name:"project",initialState:qe,reducers:{switchedPage:function(e,t){e.currentPage=t.payload},createdProject:function(e,t){return Object(D.a)(Object(D.a)({},t.payload.project),{},{status:ie.INITIALIZING})},hotReloaded:function(e){e.status=ie.INITIALIZING},initializedProject:function(e){e.status=ie.INITIALIZED},enabledSyncFirstMeasureStart:function(e,t){e.syncFirstMeasureStart=t.payload}}}),$e=Qe.actions,et=$e.switchedPage,tt=$e.createdProject,nt=$e.initializedProject,at=$e.hotReloaded,rt=$e.enabledSyncFirstMeasureStart,st=Qe.reducer,it={sections:{allIds:[],byId:{}},bpm:120,firstMeasureStart:0,duration:180,measures:{allIds:[],byId:{}},timeSignature:f.FOUR_FOUR},ct=Object(Ke.c)({name:"analysis",initialState:it,extraReducers:function(e){return e.addCase(tt,(function(e,t){return t.payload.analysis}))},reducers:{addedSection:function(e,t){return lt(e,t.payload)},updatedSection:function(e,t){return ut(e,t.payload.before),lt(e,t.payload.after)},removedSection:function(e,t){return ut(e,t.payload),e},updatedRhythm:function(e,t){var n,a,r,s;if(e.duration=null!==(n=t.payload.duration)&&void 0!==n?n:e.duration,e.bpm=null!==(a=t.payload.bpm)&&void 0!==a?a:e.bpm,e.firstMeasureStart=null!==(r=t.payload.firstMeasureStart)&&void 0!==r?r:e.firstMeasureStart,e.timeSignature=null!==(s=t.payload.timeSignatureType)&&void 0!==s?s:e.timeSignature,e.measures=I(e.timeSignature,e.bpm,e.firstMeasureStart,e.duration),0===e.sections.allIds.length)return e.sections=function(e){var t="UNDEFINED_0_"+e,n={allIds:[t],byId:{}};return n.byId[t]={measures:O.range(0,e),type:m.UNDEFINED},n}(e.measures.allIds.length-1),e;var i=e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]];if(void 0===i)return e;if(parseInt(O.last(e.measures.allIds))>parseInt(i.measures[i.measures.length-1])){var c={type:i.type,measures:O.range(parseInt(i.measures[0]),parseInt(O.last(e.measures.allIds)))},o=v(c);delete e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]],e.sections.allIds[e.sections.allIds.length-1]=o,e.sections.byId[o]=c}return ot(e),e}}}),ot=function(e){for(var t=e.measures.allIds.length-1,n=-1,a=-1,r=0;r<=e.sections.allIds.length-1;r++){var s=e.sections.byId[e.sections.allIds[r]];if(parseInt(O.last(s.measures))>t){n=r,a=parseInt(s.measures[0]);break}}-1!==n&&g(e.sections,n,e.sections.allIds.length-n,[{measures:O.range(a,t),type:m.UNDEFINED}])},lt=function(e,t){if(n=t,parseInt(n.measures[0])>parseInt(n.measures[n.measures.length-1]))return e;var n,a=function(e,t){for(var n=O.bordersOf(e.measures),a=n.start,r=n.end,s=t.allIds.length,i=0;i<=s-1;i++){var c=t.byId[t.allIds[i]],o=O.bordersOf(c.measures).end;if(!(a>=o)){if(r>o)return;return{position:i,section:c}}}}(t,e.sections);if(void 0===a||a.section.type!==m.UNDEFINED)return e;var r=function(e,t){var n=[],a=O.bordersOf(t.measures),r=a.start,s=a.end,i=O.bordersOf(e.measures),c=i.start,o=i.end;if(r>c){var l={measures:O.range(c,r-1),type:m.UNDEFINED};n.push(l)}if(n.push(t),s<o){var u={measures:O.range(s+1,o),type:m.UNDEFINED};n.push(u)}return n}(a.section,t);return g(e.sections,a.position,1,r),e},ut=function(e,t){var n=e.sections.allIds.indexOf(t),a=e.sections.byId[t],r=e.sections.allIds[n-1],s=e.sections.allIds[n+1],i=O.bordersOf(a.measures),c=i.start,o=i.end,l=n,u=1;void 0!==r&&e.sections.byId[r].type===m.UNDEFINED&&(l--,u++,c=parseInt(e.sections.byId[r].measures[0])),void 0!==s&&e.sections.byId[s].type===m.UNDEFINED&&(u++,o=parseInt(O.last(e.sections.byId[s].measures))),g(e.sections,l,u,[{measures:O.range(c,o),type:m.UNDEFINED}])},dt=ct.actions,pt=dt.addedSection,ht=dt.removedSection,bt=dt.updatedRhythm,jt=dt.updatedSection,ft=ct.reducer,mt=Object(Ke.c)({name:"audio",initialState:{isPlaying:!1,detune:0,playbackRate:1,isLooping:!1,loopStart:0,loopEnd:0},reducers:{triggeredPlay:function(e){e.isPlaying=!0},triggeredPause:function(e){e.isPlaying=!1},updatedPlaybackSettings:function(e,t){void 0!==t.payload.detune&&(e.detune=t.payload.detune),void 0!==t.payload.playbackRate&&(e.playbackRate=t.payload.playbackRate)},toggledLoop:function(e){e.isLooping=!e.isLooping},updatedLoopSettings:function(e,t){void 0!==t.payload.start&&(e.loopStart=t.payload.start),void 0!==t.payload.end&&(e.loopEnd=t.payload.end)}}}),Ot=mt.actions,yt=Ot.triggeredPause,gt=Ot.triggeredPlay,vt=Ot.updatedPlaybackSettings,xt=Ot.toggledLoop,It=Ot.updatedLoopSettings,Et=mt.reducer;!function(e){e.NONE="none",e.NEW="new",e.OPEN="open",e.SAVE="save",e.ADD_SECTION="add_section"}(Xe||(Xe={}));var St,Ct={currentDialog:Xe.NONE},Tt=Object(Ke.c)({name:"dialogs",initialState:Ct,reducers:{openedDialog:function(e,t){e.currentDialog=t.payload},closedDialog:function(e){e.currentDialog=Xe.NONE}}}),kt=Tt.actions,Rt=kt.openedDialog,Nt=kt.closedDialog,wt=Tt.reducer,Dt=n(170),Pt=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Je,{title:"Bpm",value:this.props.bpm,min:40,max:220,step:1,onChange:function(t,n){Array.isArray(n)||e.props.updatedRhythm({bpm:n})}}),Object(a.jsxs)(Ee.a,{fullWidth:!0,children:[Object(a.jsx)(Se.a,{children:"Time Signature"}),Object(a.jsxs)(Dt.a,{value:this.props.timeSignature,onChange:function(t){return e.props.updatedRhythm({timeSignatureType:y(t.target.value)})},children:[Object(a.jsx)("option",{value:f.FOUR_FOUR,children:"4/4"}),Object(a.jsx)("option",{value:f.THREE_FOUR,children:"3/4"})]})]})]})}}]),n}(i.Component),Ut={updatedRhythm:bt},Ft=Object(l.b)((function(e){var t=e.analysis;return{bpm:t.bpm,timeSignature:t.timeSignature}}),Ut)(Pt),At=n(324),Lt=n(325),Mt=n(326),Ht=n(327),zt=n(328),Bt=n(329),_t=n(171),Wt=n.n(_t),Gt=n(323),Zt=n(110),Vt=n.n(Zt),Yt=Object(G.a)((function(e){return Object(A.a)({root:{minWidth:e.measureSelect.minWidth}})}))((function(e){return Object(a.jsx)(Vt.a,{value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},className:e.classes.root,disabled:e.disabled,children:new Array(e.max-e.min+1).fill(0).map((function(t,n){return Object(a.jsx)(Gt.a,{value:e.min+n,children:e.min+n},e.min+n)}))})})),Jt=n(13),Kt=Object(G.a)((function(e){return Object(A.a)({root:{minWidth:e.sectionSelect.minWidth},colored:{backgroundColor:function(e){return S(e.value)}}})}))((function(e){return Object(a.jsx)(Vt.a,{value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},className:Object(Jt.default)(e.classes.root),children:Object.values(m).map((function(e){return e===m.UNDEFINED?void 0:Object(a.jsx)(Gt.a,{value:e,children:e},e)}))})})),Xt=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleAddSection=function(t){e.props.addedSection(t)},e.handleUpdatedSection=function(t,a,r){oe.info("Change section "+t+" from "+JSON.stringify(a)+" to "+JSON.stringify(r),n.name),parseInt(r.measures[0])>parseInt(r.measures[r.measures.length-1])||e.props.updatedSection({before:t,after:r})},e.handleRemoveSection=function(t){e.props.removedSection(t)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsx)(At.a,{children:Object(a.jsxs)(Lt.a,{size:"small",children:[Object(a.jsx)(Mt.a,{children:Object(a.jsxs)(Ht.a,{children:[Object(a.jsx)(zt.a,{className:this.props.classes.column1}),Object(a.jsx)(zt.a,{className:this.props.classes.column2,children:"Section"}),Object(a.jsx)(zt.a,{className:this.props.classes.column3,children:"First Measure"}),Object(a.jsx)(zt.a,{className:this.props.classes.column4,children:"Last Measure"})]})}),Object(a.jsx)(Bt.a,{children:this.props.sections.allIds.map((function(t){var n=e.props.sections.byId[t];return Object(a.jsxs)(Ht.a,{children:[Object(a.jsx)(zt.a,{component:"th",scope:"row",children:n.type!==m.UNDEFINED&&Object(a.jsx)(xe.a,{onClick:function(){return e.handleRemoveSection(t)},size:"small",children:Object(a.jsx)(Wt.a,{})})}),Object(a.jsx)(zt.a,{children:n.type===m.UNDEFINED?"UNDEFINED":Object(a.jsx)(Kt,{value:n.type,onChange:function(a){return e.handleUpdatedSection(t,n,Object(D.a)(Object(D.a)({},n),{},{type:a}))}})}),Object(a.jsx)(zt.a,{children:Object(a.jsx)(Yt,{disabled:n.type===m.UNDEFINED,value:parseInt(n.measures[0]),min:0,max:e.props.measuresCount-1,onChange:function(a){return e.handleUpdatedSection(t,n,Object(D.a)(Object(D.a)({},n),{},{measures:O.range(a,parseInt(n.measures[n.measures.length-1]))}))}})}),Object(a.jsx)(zt.a,{children:Object(a.jsx)(Yt,{disabled:n.type===m.UNDEFINED,value:parseInt(n.measures[n.measures.length-1]),min:0,max:e.props.measuresCount-1,onChange:function(a){return e.handleUpdatedSection(t,n,Object(D.a)(Object(D.a)({},n),{},{measures:O.range(parseInt(n.measures[0]),a)}))}})})]},t)}))})]})})}}]),n}(i.Component),qt={addedSection:pt,updatedSection:jt,removedSection:ht},Qt=Object(l.b)((function(e){var t=e.analysis;return{sections:t.sections,measuresCount:t.measures.allIds.length}}),qt)(Object(G.a)((function(){return Object(A.a)({column1:{width:"10%"},column2:{width:"30%"},column3:{width:"30%"},column4:{width:"30%"}})}),{withTheme:!0})(Xt)),$t=n(54),en=n(331);!function(e){e[e.OUTSIDE=0]="OUTSIDE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INSIDE=3]="INSIDE",e[e.LEFT_AND_RIGHT=4]="LEFT_AND_RIGHT"}(St||(St={}));var tn=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={start:0,end:0},e}return Object(d.a)(n,[{key:"getArea",value:function(e){return this.state.start>e||this.state.end<e?St.OUTSIDE:e===this.state.start&&e===this.state.end?St.LEFT_AND_RIGHT:e===this.state.start?St.LEFT:e===this.state.end?St.RIGHT:St.INSIDE}},{key:"render",value:function(){var e=this,t=this.props,n=t.sections,r=t.measures,s=function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n};return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(F.a,{container:!0,direction:"column",children:n.allIds.map((function(t){return Object(a.jsx)(F.a,{item:!0,children:Object(a.jsxs)(F.a,{container:!0,direction:"column",children:[Object(a.jsx)(F.a,{item:!0,children:Object(a.jsx)(V.a,{variant:"caption",children:n.byId[t].type.toLowerCase()})},t+"_caption"),Object(a.jsx)(F.a,{item:!0,children:Object(a.jsx)(F.a,{container:!0,direction:"column",className:e.props.classes.mainGrid,children:s(n.byId[t].measures,8).map((function(s){return Object(a.jsx)(en.a,{orientation:"horizontal",size:"small",className:e.props.classes.section,children:s.map((function(s){var i=r.byId[s],c=Number(s);return i?Object(a.jsx)(an,{value:i.id,sectiontype:n.byId[t].type,onClick:function(){c<=e.state.end?(e.setState((function(){return{start:c,end:c}})),e.props.updatedLoopSettings({start:r.byId[c].time,end:x(c,r)})):(e.setState((function(){return{end:c}})),e.props.updatedLoopSettings({end:x(c,r)}))},position:e.getArea(c)},i.id):Object(a.jsx)("div",{children:"?"})}))},t+"_buttonGroup_"+s[0])}))})},t+"_body")]})},t)}))})})}}]),n}(c.a.Component),nn=function(e){switch(e.position){case St.OUTSIDE:return Object(Jt.default)(e.classes.root);case St.INSIDE:return Object(Jt.default)(e.classes.root,e.classes.selected);case St.LEFT:return Object(Jt.default)(e.classes.root,e.classes.selected,e.classes.selectedLeft);case St.RIGHT:return Object(Jt.default)(e.classes.root,e.classes.selected,e.classes.selectedRight);case St.LEFT_AND_RIGHT:return Object(Jt.default)(e.classes.root,e.classes.selected,e.classes.selectedLeft,e.classes.selectedRight)}},an=Object(G.a)((function(){return Object(A.a)({root:{backgroundColor:function(e){return S(e.sectiontype)},minWidth:"12%",minHeight:"15px",padding:"0px",marginLeft:"2px",marginBottom:"2px",opacity:"0.7"},selected:{opacity:"1",borderTopColor:"#000000",borderBottomColor:"#000000"},selectedLeft:{borderLeftWidth:"4px",borderLeftColor:"#000000"},selectedRight:{borderRightWidth:"4px",borderRightColor:"#000000"}})}))((function(e){e.classes;var t=Object($t.a)(e,["classes"]);return Object(a.jsx)(M.a,Object(D.a)(Object(D.a)({},t),{},{onClick:function(){return e.onClick()},className:nn(e),children:e.value}))})),rn={updatedLoopSettings:It},sn=Object(l.b)((function(e){var t=e.analysis;return{sections:t.sections,measures:t.measures}}),rn)(Object(G.a)((function(){return Object(A.a)({mainGrid:{marginBottom:"5px"},section:{}})}),{withTheme:!0})(tn)),cn=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsx)(F.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",alignContent:"stretch",children:Object(a.jsx)(F.a,{style:{width:"100%"},children:Object(a.jsx)(sn,{})})})}}]),n}(i.Component),on=n(332),ln=n(11),un=n.n(ln),dn=n(18),pn=n(172),hn=n(133),bn=n.n(hn),jn=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"save",value:function(){var t=Object(dn.a)(un.a.mark((function t(n,a){var r,s,i;return un.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new bn.a).file(e.stateFile,JSON.stringify(a.state)),t.next=4,fetch(a.audioFileUrl);case 4:return s=t.sent,t.next=7,s.blob();case 7:return i=t.sent,r.file(e.songFile,i),t.next=11,r.generateAsync({type:"blob"}).then((function(e){Object(pn.saveAs)(e,n)}));case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"open",value:function(){var t=Object(dn.a)(un.a.mark((function t(n){var a,r,s,i,c,o;return un.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bn.a.loadAsync(n);case 2:if(a=t.sent,null!==(r=a.file(e.songFile))){t.next=6;break}throw new Error("Project must contain an audio file "+e.songFile);case 6:if(null!==(s=a.file(e.stateFile))){t.next=9;break}throw new Error("Project must contain a project config/state file "+e.stateFile);case 9:return t.next=11,r.async("blob");case 11:return i=t.sent,t.next=14,s.async("text");case 14:return c=t.sent,o=JSON.parse(c),t.abrupt("return",{audioBlob:i,state:o});case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"revokeLocalFile",value:function(e){window.URL.revokeObjectURL(e)}},{key:"getLocalFileUrl",value:function(e){return window.URL.createObjectURL(e)}}]),e}();jn.songFile="song.blob",jn.stateFile="state.json";var fn,mn=jn,On=n(189),yn=n(35),gn=function(){function e(t,n){var a=this;Object(u.a)(this,e),this.audioBuffer=t,this.onSongComplete=n,this.shouldLoop=void 0,this.player=void 0,this.pitchShift=void 0,this.detune=void 0,this.eventEmitter=void 0,this.loopStart=void 0,this.loopEnd=void 0,this.init=function(t){oe.info("init",e.name),a.eventEmitter=t,yn.c.scheduleRepeat((function(){t.emit("player.timeupdate",a.getCurrentTime()),a.shouldLoop&&(a.getCurrentTime()>=a.loopEnd||a.getCurrentTime()<=a.loopStart)&&a.seek(a.loopStart),a.getCurrentTime()>=a.getDuration()&&(yn.c.stop(),a.onSongComplete())}),.25),t.emit("player.canplay")},this.shiftToSemitones=function(e){return 12*Math.log2(1/e)},this.destroy=function(){oe.info("destroy",e.name),a.player.dispose(),a.pitchShift.dispose(),yn.c.cancel(),yn.c.position=0},this.play=function(){var e;return yn.c.start(Object(yn.e)(),a.getCurrentTime()/a.player.playbackRate),null===(e=a.eventEmitter)||void 0===e||e.emit("player.play",a.getCurrentTime()/a.player.playbackRate),Promise.resolve()},this.playSegment=function(e){var t;yn.c.start(Object(yn.e)(),e.startTime/a.player.playbackRate),null===(t=a.eventEmitter)||void 0===t||t.emit("player.play",a.getCurrentTime()/a.player.playbackRate)},this.pause=function(){var e;yn.c.pause(),null===(e=a.eventEmitter)||void 0===e||e.emit("player.pause",a.getCurrentTime())},this.isPlaying=function(){return"started"===yn.c.state},this.isSeeking=function(){return!1},this.getCurrentTime=function(){return a.player.toSeconds(yn.c.position)*a.player.playbackRate},this.getDuration=function(){return a.player.buffer.duration},this.seek=function(e){var t,n,r=e/a.player.playbackRate;yn.c.seconds=r,null===(t=a.eventEmitter)||void 0===t||t.emit("player.seeked",a.getCurrentTime()),null===(n=a.eventEmitter)||void 0===n||n.emit("player.timeupdate",a.getCurrentTime())},this.player=new yn.b(this.audioBuffer),this.pitchShift=new yn.a,this.detune=0,this.shouldLoop=!1,this.loopStart=0,this.loopEnd=0,this.player.sync(),this.player.start(),this.player.connect(this.pitchShift),this.pitchShift.toDestination()}return Object(d.a)(e,[{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e,this.setDetune(this.detune),this.isPlaying()&&this.seek(this.getCurrentTime())}},{key:"setDetune",value:function(e){this.detune=e,this.pitchShift.pitch=this.shiftToSemitones(this.player.playbackRate)+e}},{key:"toggleLoop",value:function(){this.shouldLoop=!this.shouldLoop}},{key:"setLoop",value:function(e,t){if(this.loopStart<0||this.loopStart>this.getDuration())throw new Error("Loop start invalid. Must be a millisecond between 0 and "+this.getDuration());if(this.loopEnd<this.loopStart||this.loopEnd>this.getDuration())throw new Error("Loop start invalid. Must be a millisecond between "+this.loopStart+" and "+this.getDuration());this.loopStart=e,this.loopEnd=t}}]),e}(),vn=Object(Ke.b)("switchAudioFile"),xn=Object(Ke.b)("updateWaveform"),In=function(){function e(){var t=this;Object(u.a)(this,e),this.peaks=void 0,this.player=void 0,this.url=void 0,this.getPlayer=function(){if(!t.player)throw new Error("player undefined");return t.player},this.createMiddleware=function(n){return function(a){return function(r){if(oe.info("action "+r.type,e.name),tt.match(r))return t.initAudioContext(r.payload.project.audioUrl,n),a(r);if(at.match(r))return a(r);if(gt.match(r))return t.getPlayer().play(),a(r);if(yt.match(r))return t.getPlayer().pause(),a(r);if(xn.match(r))return t.repaintWaveform(r.payload.sections,r.payload.measures),a(r);if(vt.match(r))return r.payload.playbackRate&&t.getPlayer().setPlaybackRate(r.payload.playbackRate),r.payload.detune&&t.getPlayer().setDetune(r.payload.detune),a(r);if(xt.match(r))return t.getPlayer().toggleLoop(),a(r);if(It.match(r)){var s,i,c=null!==(s=r.payload.start)&&void 0!==s?s:n.getState().audio.loopStart,o=null!==(i=r.payload.end)&&void 0!==i?i:n.getState().audio.loopEnd;return t.getPlayer().seek(c),t.getPlayer().setLoop(c,o),t.setZoom(c,o),a(r)}return a(r)}}},this.computeSecondsPerMeasure=function(e){return e&&e.byId[1]&&e.byId[0]?e.byId[1].time-e.byId[0].time:0}}return Object(d.a)(e,[{key:"cleanupPreviousInit",value:function(){var e,t;null===(e=this.peaks)||void 0===e||e.destroy(),null===(t=this.player)||void 0===t||t.destroy(),this.url&&mn.revokeLocalFile(this.url)}},{key:"initAudioContext",value:function(t,n){var a=this;this.cleanupPreviousInit(),this.url=t,oe.info("start fetch audio file into audiobuffer from "+this.url,e.name),fetch(this.url).then((function(e){return e.arrayBuffer()})).then((function(e){return yn.d.decodeAudioData(e)})).then((function(t){oe.info("audiobuffer loaded from "+a.url,e.name),r(t)}));var r=function(t){oe.info("init peaks start",e.name),a.player=new gn(t,(function(){})),On.a.init(w.create(t,a.player),(function(r,s){if(r)throw new Error("Peaks could not be initialized: "+r);if(!s)throw new Error("Peaks instance is not correctly initialized.");oe.info("init peaks end",e.name),s.on("player.seeked",(function(e){n.getState().project.syncFirstMeasureStart&&n.dispatch(bt({firstMeasureStart:e}))})),a.peaks=s,n.dispatch(nt()),n.dispatch(bt({duration:t.duration}))}))}}},{key:"repaintWaveform",value:function(e,t){var n,a,r,s,i=this.computeSecondsPerMeasure(t);null===(n=this.peaks)||void 0===n||n.segments.removeAll(),null===(a=this.peaks)||void 0===a||a.segments.add(w.sectionsToSegment(e,t,i)),null===(r=this.peaks)||void 0===r||r.points.removeAll(),null===(s=this.peaks)||void 0===s||s.points.add(w.measuresToPoints(t))}},{key:"setZoom",value:function(e,t){var n,a=null===(n=this.peaks)||void 0===n?void 0:n.views.getView("zoomview");if(a){var r=t-e;a.setZoom({seconds:r}),a.setStartTime(e)}}}]),e}(),En=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return oe.info("render",n.name),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{id:"waveform-container",children:[Object(a.jsx)("div",{id:R,className:this.props.classes.zoomview}),Object(a.jsx)("div",{id:N,className:this.props.classes.overview})]})})}}]),n}(i.Component),Sn=Object(G.a)((function(){return Object(A.a)({zoomview:{maxHeight:"400px"},overview:{marginTop:"30px",height:"50px"}})}),{withTheme:!0})(En),Cn=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(e){return Object(u.a)(this,n),t.call(this,e)}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(e){e.sections===this.props.sections&&e.measures===this.props.measures||this.props.updateWaveform({sections:this.props.sections,measures:this.props.measures})}},{key:"render",value:function(){return oe.info("render",n.name),Object(a.jsxs)("div",{children:[this.props.status!==ie.INITIALIZED&&Object(a.jsx)(on.a,{}),Object(a.jsx)(Sn,{})]})}}]),n}(i.Component),Tn={hotReloaded:at,updateWaveform:xn},kn=Object(l.b)((function(e){var t=e.project,n=e.analysis;return{status:t.status,sections:n.sections,measures:n.measures,audioUrl:t.audioUrl}}),Tn)(Cn);!function(e){e[e.RHYTHM=0]="RHYTHM",e[e.PLAYBACKRATE=1]="PLAYBACKRATE",e[e.DETUNE=2]="DETUNE",e[e.STARTMEASURE=3]="STARTMEASURE",e[e.NONE=4]="NONE"}(fn||(fn={}));var Rn=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null,activePopover:fn.NONE},e.handlePopoverOpen=function(t,n){t&&t.currentTarget&&e.setState({anchorEl:t.currentTarget,activePopover:n})},e.handlePopoverClose=function(){e.setState({anchorEl:null,activePopover:fn.NONE})},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;oe.info("render",n.name);var t=this.props.shouldLoop?"Turn Loop off":"Turn Loop on",r=this.props.shouldLoop?"secondary":"primary";return Object(a.jsx)(Ze,{topLeft:Object(a.jsx)(je,{title:"Song Overview",body:Object(a.jsx)(kn,{}),action:Object(a.jsxs)(a.Fragment,{children:[this.props.isPlaying?Object(a.jsx)(Nn,{title:"Pause",icon:Object(a.jsx)(Le.a,{}),onClick:function(){return e.props.triggeredPause()}}):Object(a.jsx)(Nn,{title:"Play",icon:Object(a.jsx)(He.a,{}),onClick:function(){return e.props.triggeredPlay()}}),Object(a.jsx)(Nn,{title:t,icon:Object(a.jsx)(Pe.a,{}),onClick:function(){return e.props.toggledLoop()},disabled:!1,color:r}),Object(a.jsx)(Nn,{title:"Playback Rate",icon:Object(a.jsx)(Be.a,{}),onClick:function(t){return e.handlePopoverOpen(t,fn.PLAYBACKRATE)},disabled:!1}),Object(a.jsx)(Nn,{title:"Detune",icon:Object(a.jsx)(Fe.a,{}),onClick:function(t){return e.handlePopoverOpen(t,fn.DETUNE)},disabled:!1}),Object(a.jsx)(ve.a,{className:this.props.classes.popover,open:this.state.activePopover!==fn.NONE,anchorEl:this.state.anchorEl,onClose:function(){return e.handlePopoverClose()},anchorOrigin:{vertical:"bottom",horizontal:"left"},anchorPosition:{top:50,left:0},transformOrigin:{vertical:"top",horizontal:"center"},children:this.state.activePopover!==fn.NONE&&Object(a.jsx)("div",{className:this.props.classes.content,children:wn(this.state.activePopover,this.props)})})]})}),topRight:Object(a.jsx)(je,{title:"Song Measures",body:Object(a.jsx)(cn,{})}),bottomLeft:Object(a.jsx)(je,{title:"Song Sections",action:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Nn,{title:"Start Measure 0",icon:Object(a.jsx)(we.a,{}),onClick:function(t){return e.handlePopoverOpen(t,fn.STARTMEASURE)},disabled:!1}),Object(a.jsx)(Nn,{title:"Add section",icon:Object(a.jsx)(Re.a,{}),onClick:function(){return e.props.openedDialog(Xe.ADD_SECTION)}})]}),body:Object(a.jsx)(Qt,{})}),bottomRight:Object(a.jsx)(je,{title:"Song Properties",body:Object(a.jsx)(Ft,{})})})}}]),n}(c.a.Component),Nn=Object(G.a)((function(){return Object(A.a)({root:{marginTop:"8px",marginRight:"5px"}})}))((function(e){var t=Object(a.jsx)(xe.a,{className:e.classes.root,onClick:e.onClick,size:"small",disabled:e.disabled,color:e.color,children:e.icon});return e.disabled?t:Object(a.jsx)(Ie.a,{title:e.title,children:t})})),wn=function(e,t){switch(e){case fn.DETUNE:return Object(a.jsx)(Dn,Object(D.a)({},t));case fn.PLAYBACKRATE:return Object(a.jsx)(Un,Object(D.a)({},t));case fn.STARTMEASURE:return Object(a.jsx)(Pn,Object(D.a)({},t));default:throw Error("Popup type undefined: "+e)}},Dn=function(e){return Object(a.jsx)(Je,{title:"Detune",value:e.detune,min:-12,max:12,step:.5,onChange:function(t,n){Array.isArray(n)||n===e.detune||e.updatedPlaybackSettings({detune:n})}})},Pn=Object(G.a)((function(){return Object(A.a)({toggleButton:{width:"15px",height:"25px"}})}))((function(e){return Object(a.jsxs)(Ee.a,{fullWidth:!0,children:[Object(a.jsx)(Se.a,{children:"Start Measure 1"}),Object(a.jsx)(Ce.a,{type:"text",id:"startMeasure1",value:e.firstMeasureStart,startAdornment:Object(a.jsx)(Te.a,{position:"start",children:Object(a.jsx)(Ie.a,{title:"Toggle sync with mouse click. If enabled, clicking into the waveform will update the start of measure 0 to the selected position.",children:Object(a.jsx)(Ge.a,{className:e.classes.toggleButton,value:"check",selected:e.syncFirstMeasureStart,onChange:function(){e.enabledSyncFirstMeasureStart(!e.syncFirstMeasureStart)},children:Object(a.jsx)(We.a,{})})})})})]})})),Un=function(e){return Object(a.jsx)(Je,{title:"Playback rate",value:e.playbackRate,min:.4,max:1.2,step:.05,onChange:function(t,n){Array.isArray(n)||n===e.playbackRate||e.updatedPlaybackSettings({playbackRate:n})}})},Fn={triggeredPlay:gt,triggeredPause:yt,enabledSyncFirstMeasureStart:rt,updatedRhythm:bt,updatedPlaybackSettings:vt,openedDialog:Rt,toggledLoop:xt},An=Object(l.b)((function(e){var t=e.project,n=e.audio,a=e.analysis;return{loaded:t.status===ie.INITIALIZED,isPlaying:n.isPlaying,firstMeasureStart:a.firstMeasureStart,syncFirstMeasureStart:t.syncFirstMeasureStart,detune:n.detune,playbackRate:n.playbackRate,shouldLoop:n.isLooping}}),Fn)(Object(G.a)((function(e){return Object(A.a)({content:{width:e.popover.width,minHeight:e.popover.minHeight,margin:e.popover.margin,marginTop:e.popover.marginTop},popover:{height:"400px"}})}),{withTheme:!0})(Rn));function Ln(){return(Ln=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Mn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Hn=i.createElement("path",{d:"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z"}),zn=i.createElement("path",{d:"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z"}),Bn=i.createElement("path",{d:"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z"}),_n=i.createElement("path",{d:"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z"}),Wn=i.createElement("path",{d:"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z"}),Gn=i.createElement("path",{d:"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z"}),Zn=i.createElement("path",{d:"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z"}),Vn=i.createElement("path",{d:"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z"}),Yn=i.createElement("path",{d:"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z"}),Jn=i.createElement("path",{d:"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z"}),Kn=i.createElement("g",null),Xn=i.createElement("g",null),qn=i.createElement("g",null),Qn=i.createElement("g",null),$n=i.createElement("g",null),ea=i.createElement("g",null),ta=i.createElement("g",null),na=i.createElement("g",null),aa=i.createElement("g",null),ra=i.createElement("g",null),sa=i.createElement("g",null),ia=i.createElement("g",null),ca=i.createElement("g",null),oa=i.createElement("g",null),la=i.createElement("g",null);function ua(e,t){var n=e.title,a=e.titleId,r=Mn(e,["title","titleId"]);return i.createElement("svg",Ln({id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("path",{style:{fill:"#EADCD6"},d:"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z"}),i.createElement("path",{style:{fill:"#DDCDC7"},d:"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z"}),i.createElement("path",{style:{fill:"#EADCD6"},d:"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z "}),i.createElement("path",{style:{fill:"#DDCDC7"},d:"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z"}),i.createElement("g",null,i.createElement("path",{style:{fill:"#F8BF00"},d:"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z"}),i.createElement("circle",{style:{fill:"#F8BF00"},cx:201.212,cy:201.242,r:22.708}),i.createElement("circle",{style:{fill:"#F8BF00"},cx:331.22,cy:201.242,r:22.708})),i.createElement("g",null,i.createElement("path",{style:{fill:"#EFA603"},d:"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z"}),i.createElement("path",{style:{fill:"#EFA603"},d:"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z"}),i.createElement("path",{style:{fill:"#EFA603"},d:"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z"})),i.createElement("path",{style:{fill:"#DDCDC7"},d:"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z"}),i.createElement("path",{style:{fill:"#C9BCB8"},d:"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z"}),Hn,zn,Bn,_n,Wn,Gn,Zn,Vn,Yn,Jn,Kn,Xn,qn,Qn,$n,ea,ta,na,aa,ra,sa,ia,ca,oa,la)}var da,pa=i.forwardRef(ua),ha=(n.p,function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e,t,r,s=this;return oe.info("render",n.name),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:this.props.classes.root,children:[Object(a.jsx)(L.a,{color:"inherit",className:this.props.classes.appBar,children:Object(a.jsxs)(Z.a,{children:[Object(a.jsx)(pa,{className:this.props.classes.logo}),Object(a.jsx)(V.a,{color:"textPrimary",variant:"h4",noWrap:!0,children:"Transcribe"}),Object(a.jsxs)(V.a,{color:"textPrimary",variant:"caption",noWrap:!0,className:this.props.classes.title,children:["[",""!==this.props.title?this.props.title:"no file loaded","]"]}),Object(a.jsx)(M.a,{onClick:function(){return s.props.openedDialog(Xe.NEW)},disabled:this.props.status===ie.INITIALIZING,children:"New"}),Object(a.jsx)(M.a,{onClick:function(){return s.props.openedDialog(Xe.OPEN)},disabled:this.props.status===ie.INITIALIZING,children:"Open"}),Object(a.jsx)(M.a,{onClick:function(){return s.props.openedDialog(Xe.SAVE)},disabled:this.props.status!==ie.INITIALIZED,children:"Save"})]})}),Object(a.jsxs)(H.a,{className:this.props.classes.drawer,variant:"permanent",classes:{paper:this.props.classes.drawerPaper},children:[Object(a.jsx)("div",{className:this.props.classes.toolbar}),Object(a.jsxs)(z.a,{className:this.props.classes.menuItem,children:[Object(a.jsxs)(B.a,{button:!0,onClick:function(){return s.props.switchedPage(ce.STRUCTURE)},disabled:this.props.status!==ie.INITIALIZED,children:[Object(a.jsx)(_.a,{children:Object(a.jsx)(X.a,{})}),Object(a.jsx)(W.a,{primary:"Structure"})]},"Structure"),Object(a.jsxs)(B.a,{button:!0,onClick:function(){return s.props.switchedPage(ce.HARMONY)},disabled:this.props.status!==ie.INITIALIZED,children:[Object(a.jsx)(_.a,{children:Object(a.jsx)(Q.a,{})}),Object(a.jsx)(W.a,{primary:"Harmony"})]},"Harmony"),Object(a.jsxs)(B.a,{button:!0,onClick:function(){return s.props.switchedPage(ce.GUITAR)},disabled:this.props.status!==ie.INITIALIZED,children:[Object(a.jsx)(_.a,{children:Object(a.jsx)(ne.a,{})}),Object(a.jsx)(W.a,{primary:"Guitar"})]},"Guitar"),Object(a.jsxs)(B.a,{button:!0,onClick:function(){return s.props.switchedPage(ce.DRUM)},disabled:this.props.status!==ie.INITIALIZED,children:[Object(a.jsx)(_.a,{children:Object(a.jsx)(J.a,{})}),Object(a.jsx)(W.a,{primary:"Drum"})]},"Drum"),Object(a.jsxs)(B.a,{button:!0,onClick:function(){return s.props.switchedPage(ce.PRINT)},disabled:this.props.status!==ie.INITIALIZED,children:[Object(a.jsx)(_.a,{children:Object(a.jsx)(ee.a,{})}),Object(a.jsx)(W.a,{primary:"Print"})]},"Print")]})]}),Object(a.jsxs)("main",{className:this.props.classes.content,children:[Object(a.jsx)("div",{className:this.props.classes.toolbar}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.DEFAULT,children:Object(a.jsx)(fe,{})}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.STRUCTURE,children:Object(a.jsx)(An,{})}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.HARMONY,children:Object(a.jsx)(ye,{})}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.GUITAR,children:Object(a.jsx)(Oe,{})}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.DRUM,children:Object(a.jsx)(me,{})}),Object(a.jsx)(ue,{show:this.props.currentPage===ce.PRINT,children:Object(a.jsx)(ge,{})}),Object(a.jsx)(F.a,{container:!0,direction:"column",justifyContent:"flex-end",alignItems:"flex-end",className:this.props.classes.footer,children:Object(a.jsxs)(F.a,{item:!0,children:["App version:"," ",Object(a.jsx)(de,{version:null!==(e="0.0.10")?e:"",hash:null!==(t="af2630a")?t:"",description:null!==(r="'#15 Update deps")?r:""})]})})]})]})})}}]),n}(c.a.Component)),ba={switchedPage:et,openedDialog:Rt},ja=Object(l.b)((function(e){var t=e.project;return{currentPage:t.currentPage,status:t.status,title:t.title}}),ba)(Object(G.a)((function(e){return Object(A.a)({root:{display:"flex",backgroundColor:e.palette.background.default},drawer:{width:190,flexShrink:0},drawerPaper:{width:190,backgroundColor:"#202a2f"},content:{flexGrow:1,padding:e.spacing(3)},title:{flexGrow:1,marginLeft:"50px"},toolbar:Object(D.a)({},e.mixins.toolbar),menuItem:{color:"#abb1b7"},logo:{height:e.logo.height,marginRight:e.logo.marginRight},footer:{marginTop:"20px"},appBar:{zIndex:e.zIndex.drawer+1}})}),{withTheme:!0})(ha)),fa=n(20),ma=n(281),Oa=n(345),ya=n(195),ga=n(117),va=n(187),xa=n.n(va);!function(e){e.AUDIO="audio/*",e.ZIP=".zip"}(da||(da={}));var Ia=function(e){switch(e){case da.AUDIO:return"Audio File";case da.ZIP:return"Project Zip File"}},Ea=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={display:""},a.fileInput=void 0,a.handleChange=function(e){if(null!==e){var t=e[0],n=mn.getLocalFileUrl(t);a.setState({display:t.name}),a.props.callback(t,n)}},a.fileInput=c.a.createRef(),a}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(ga.a,{component:"form",className:this.props.classes.root,children:[Object(a.jsx)(ya.a,{className:this.props.classes.input,placeholder:"Choose "+Ia(this.props.fileType)+" ...",inputProps:{"aria-label":"Choose "+Ia(this.props.fileType)},value:this.state.display,readOnly:!0,onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()}}),Object(a.jsxs)(xe.a,{"aria-label":"menu",onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()},className:this.props.classes.iconButton,children:[Object(a.jsx)(xa.a,{})," "]})]}),Object(a.jsx)("input",{hidden:!0,id:this.props.id,type:"file",accept:this.props.fileType,ref:this.fileInput,onChange:function(t){return e.handleChange(t.target.files)}})]})}}]),n}(c.a.Component),Sa=Object(G.a)((function(e){return Object(A.a)({root:{padding:"4px 0px",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10}})}),{withTheme:!0})(Ea),Ca=n(341),Ta=n(342),ka=n(343),Ra=n(339),Na=n(340),wa=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e;return Object(a.jsxs)(Ra.a,{onClose:this.props.onCancel,open:!0,fullWidth:!0,maxWidth:"sm",children:[Object(a.jsx)(Na.a,{children:this.props.title}),Object(a.jsxs)(Ca.a,{children:[Object(a.jsx)(Ta.a,{children:this.props.subTitle}),this.props.children]}),Object(a.jsx)(ka.a,{children:null===(e=this.props.actions)||void 0===e?void 0:e.map((function(e){var t;return Object(a.jsx)(M.a,{onClick:e.onClick,color:"primary",disabled:null!==(t=e.disabled)&&void 0!==t&&t,children:e.label},e.label)}))})]})}}]),n}(i.Component),Da=n(188),Pa=Object(Ke.b)("restoredPersistedState"),Ua=Object(Da.a)({analysis:ft,audio:Et,dialog:wt,project:st}),Fa=function(e,t){return e=Ua(e,t),Pa.match(t),e},Aa=Object(Ke.a)({reducer:Fa,preloadedState:void 0,middleware:[(new In).createMiddleware]}),La=function(e){Object(P.a)(n,e);var t=Object(U.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;switch(this.props.type){case Xe.NONE:return null;case Xe.NEW:return Object(a.jsx)(Ma,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,n){e.props.createdProject({analysis:it,project:Object(D.a)(Object(D.a)({},qe),{},{audioUrl:n,title:t})}),e.props.switchedPage(ce.STRUCTURE),e.props.closedDialog()}});case Xe.OPEN:return Object(a.jsx)(Ha,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,n){mn.open(t).then((function(t){var a=t.audioBlob,r=t.state,s=mn.getLocalFileUrl(a);mn.revokeLocalFile(n),e.props.createdProject({analysis:r.analysis,project:Object(D.a)(Object(D.a)({},r.project),{},{audioUrl:s})}),e.props.switchedPage(ce.STRUCTURE),e.props.closedDialog()}))}});case Xe.SAVE:return Object(a.jsx)(wa,{title:"Save Transcription",subTitle:"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.",onCancel:function(){return e.props.closedDialog()},actions:[{label:"Cancel",onClick:function(){return e.props.closedDialog()}},{label:"Save",onClick:function(){mn.save("transcription.zip",{audioFileUrl:e.props.audioUrl,state:Aa.getState()}),e.props.closedDialog()}}]});case Xe.ADD_SECTION:return Object(a.jsx)(za,{maxMeasure:this.props.maxMeasure,onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,n,a){e.props.addedSection({measures:O.range(n,a),type:t}),e.props.closedDialog()}});default:throw Error()}}}]),n}(i.Component),Ma=function(e){var t=Object(i.useState)(""),n=Object(fa.a)(t,2),r=n[0],s=n[1],c=Object(i.useState)(""),o=Object(fa.a)(c,2),l=o[0],u=o[1];return Object(a.jsx)(wa,{title:"Create new Transcription",subTitle:"Please add a project title and select an audio file from your hard disk below.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Create",onClick:function(){return e.onSubmit(l,r)},disabled:""===r||""===l}],onCancel:e.onCancel,children:Object(a.jsxs)(Ee.a,{fullWidth:!0,children:[Object(a.jsx)(Oa.a,{id:"title",label:"Project title",margin:"normal",InputProps:{readOnly:!1},variant:"outlined",onChange:function(e){return u(e.target.value)}}),Object(a.jsx)(Sa,{fileType:da.AUDIO,id:"audio_file",callback:function(e,t){s(t)}})]})})},Ha=function(e){var t=Object(i.useState)(""),n=Object(fa.a)(t,2),r=n[0],s=n[1],c=Object(i.useState)(),o=Object(fa.a)(c,2),l=o[0],u=o[1];return Object(a.jsx)(wa,{title:"Open Transcription",subTitle:"Please select a project zip file from your hard disk below.",onCancel:e.onCancel,actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Open",onClick:function(){if(!l)throw Error("file undefined");e.onSubmit(l,r)},disabled:""===r}],children:Object(a.jsx)(Ee.a,{fullWidth:!0,children:Object(a.jsx)(Sa,{fileType:da.ZIP,id:"zip_file",callback:function(e,t){s(t),u(e)}})})})},za=Object(G.a)((function(e){return Object(A.a)({formControl:{marginBottom:e.formControl.marginBottom}})}))((function(e){var t=Object(i.useState)(m.INTRO),n=Object(fa.a)(t,2),r=n[0],s=n[1],c=Object(i.useState)(0),o=Object(fa.a)(c,2),l=o[0],u=o[1],d=Object(i.useState)(0),p=Object(fa.a)(d,2),h=p[0],b=p[1];return Object(a.jsxs)(wa,{title:"Add new Section",subTitle:"Please define section and add it to the song structure.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Add",onClick:function(){return e.onSubmit(r,l,h)},disabled:r===m.UNDEFINED||l>h}],onCancel:e.onCancel,children:[Object(a.jsxs)(Ee.a,{fullWidth:!0,className:e.classes.formControl,children:[Object(a.jsx)(ma.a,{component:"legend",children:"Section Type"}),Object(a.jsx)(Kt,{value:r,onChange:function(e){return s(e)}})]}),Object(a.jsxs)(Ee.a,{fullWidth:!0,className:e.classes.formControl,children:[Object(a.jsx)(ma.a,{component:"legend",children:"First Measure"}),Object(a.jsx)(Yt,{value:l,min:0,max:e.maxMeasure,onChange:function(e){return u(e)}})]}),Object(a.jsxs)(Ee.a,{fullWidth:!0,className:e.classes.formControl,children:[Object(a.jsx)(ma.a,{component:"legend",children:"Last Measure"}),Object(a.jsx)(Yt,{value:h,min:0,max:e.maxMeasure,onChange:function(e){return b(e)}})]})]})})),Ba={closedDialog:Nt,switchedPage:et,createdProject:tt,addedSection:pt,switchAudioFile:vn},_a=Object(l.b)((function(e){var t=e.dialog,n=e.project,a=e.analysis;return{type:t.currentDialog,audioUrl:n.audioUrl,maxMeasure:a.measures.allIds.length-1}}),Ba)(La);var Wa=function(){return Object(a.jsx)("audio",{id:k,controls:!0,hidden:!0,children:"Your browser does not support the audio element."})};Object(o.render)(Object(a.jsx)(l.a,{store:Aa,children:Object(a.jsxs)(s.a,{theme:T,children:[Object(a.jsx)(r.a,{}),Object(a.jsx)(Wa,{}),Object(a.jsx)(_a,{}),Object(a.jsx)(ja,{})]})}),document.getElementById("root"))}},[[276,1,2]]]);
//# sourceMappingURL=main.d90913b0.chunk.js.map