{"version":3,"sources":["states/project/projectSlice.ts","util/ArrayUtil.ts","states/analysis/analysisSlice.ts","states/analysis/analysisUtil.ts","styles/theme.ts","states/middleware/peaksConfig.ts","components/log/log.ts","states/dialog/dialogsSlice.ts","components/toggle/toggle.tsx","components/versionInfo/versionInfo.tsx","components/view/view.tsx","pages/default/defaultPage.tsx","pages/drum/drumPage.tsx","pages/guitar/guitarPage.tsx","pages/harmony/harmonyPage.tsx","pages/print/printPage.tsx","components/contentLayout/contentLayout.tsx","components/sliderInput/sliderInput.tsx","states/audio/audioSlice.ts","components/sectionOverview/sectionOverview.tsx","views/properties/propertiesView.tsx","components/measureSelect/measureSelect.tsx","components/sectionSelect/sectionSelect.tsx","views/structure/structureView.tsx","views/structureNavigation/structureNavigationView.tsx","api/persistenceApi.ts","pages/structure/structurePage.tsx","states/middleware/audioPlayer.ts","states/middleware/audioMiddleware.ts","views/wave/waveView.tsx","views/wave/waveContainer.tsx","components/app/logo.svg","components/fileInput/fileInput.tsx","components/app/app.tsx","components/modalDialog/modalDialog.tsx","states/store.ts","components/dialogManagement/dialogManagement.tsx","index.tsx"],"names":["LoadingStatus","Page","initialProjectState","status","NOT_INITIALIZED","currentPage","DEFAULT","title","audioUrl","syncFirstMeasureStart","projectSlice","createSlice","name","initialState","reducers","switchedPage","state","action","payload","createdProject","project","INITIALIZING","hotReloaded","initializedProject","INITIALIZED","enabledSyncFirstMeasureStart","actions","ArrayUtil","range","start","end","Array","fill","map","_","idx","toString","bordersOf","array","parseInt","last","length","TimeSignatureType","SectionType","toTimeSignatureType","type","FOUR_FOUR","THREE_FOUR","Error","replaceSections","sections","deleteCount","newSections","section","byId","allIds","ids","forEach","id","generateSectionId","push","splice","measures","getMeasureEnd","position","time","distributeMeasures","timeSignatureType","bpm","firstMeasureStart","lengthOfOneMeasure","beatUnit","beatsPerMeasure","toTimeSignature","index","color","editable","labelText","initialAnalysisState","duration","timeSignature","analysisSlice","extraReducers","builder","addCase","analysis","addedSection","addSection","updatedSection","removeSection","before","after","removedSection","updatedRhythm","undefinedSectionId","UNDEFINED","undefinedSection","lastSection","undefined","newLastSection","removeSectionsAfterLastMeasure","lastMeasure","removalStart","removalStartMeasure","newSection","enclosingSection","allSections","newSectionStart","newSectionEnd","sectionCount","current","currentSectionEnd","enclosingSectionOf","mergedSections","embeddedSection","currentSectionStart","mergeSections","sectionId","indexOf","firstMeasure","removalCount","theme","createMuiTheme","palette","primary","blueGrey","background","default","logo","height","marginRight","popover","width","minHeight","margin","marginTop","measureSelect","minWidth","formControl","marginBottom","sectionTypes","INTRO","VERSE","PRECHORUS","CHORUS","SOLO","OUTRO","BRIDGE","sectionSelect","view","headerBackground","headerPadding","waveform","pointMarkerColor","overrides","MuiListItemIcon","root","getColor","sectionType","result","SECTIONTYPE_TO_COLOR","get","Map","PeaksConfig","create","audioBuffer","audioPlayer","mediaelement","document","getElementById","containers","zoomview","overview","mediaElement","webAudio","scale","multiChannel","keyboard","showPlayheadTime","zoomLevels","player","sectionsToSegment","timePerMeasure","segments","segment","startTime","endTime","measuresToPoints","points","point","Level","TRACE","INFO","WARN","ERROR","DialogType","Log","level","message","source","namespace","createDebug","debug","this","generateMessage","Toggle","className","props","show","classes","inline","invisible","children","Component","withStyles","createStyles","display","withTheme","VersionInfo","version","href","hash","description","React","View","backgroundColor","header","padding","Card","raised","CardHeader","titleTypographyProps","variant","CardContent","body","DefaultPage","DrumPage","GuitarPage","HarmonyPage","PrintPage","ContentLayout","Grid","container","spacing","alignItems","item","xs","topLeft","bottomLeft","bottomRight","topRight","SliderInput","FormControl","InputLabel","shrink","Box","mt","Slider","value","valueLabelDisplay","min","max","onChange","step","audioSlice","isPlaying","detune","playbackRate","isLooping","loopStart","loopEnd","triggeredPlay","triggeredPause","updatedPlaybackSettings","toggledLoop","updatedLoopSettings","Area","initialDialogState","currentDialog","NONE","dialogsSlice","openedDialog","closedDialog","PropertiesView","_e","isArray","fullWidth","NativeSelect","e","target","mapDispatchToProps","connect","MeasureSelect","event","newMeasure","disabled","MenuItem","key","SectionSelect","colored","clsx","Object","values","StructureView","handleAddSection","handleUpdatedSection","info","JSON","stringify","handleRemoveSection","TableContainer","Table","size","TableHead","TableRow","TableCell","column1","column2","column3","column4","TableBody","component","scope","IconButton","onClick","measuresCount","measure","SectionOverview","OUTSIDE","LEFT_AND_RIGHT","LEFT","RIGHT","INSIDE","direction","Typography","toLowerCase","mainGrid","arr","res","i","slice","generateMatrix","row","ButtonGroup","orientation","measureId","Number","Square","sectiontype","setState","getArea","getCssClass","selected","selectedLeft","selectedRight","marginLeft","opacity","borderTopColor","borderBottomColor","borderLeftWidth","borderLeftColor","borderRightWidth","borderRightColor","Button","StructureNavigationView","justify","alignContent","style","PersistenceApi","zip","JSZip","loadAsync","archive","file","songFile","async","audioBlob","stateFile","json","parse","url","window","URL","revokeObjectURL","blob","createObjectURL","save","filename","options","a","fetch","audioFileUrl","response","generateAsync","then","saveAs","PopoverType","AudioPlayer","onSongComplete","pitchShift","eventEmitter","init","Tone","scheduleRepeat","emit","getCurrentTime","getDuration","stop","shiftToSemitones","shift","Math","log2","destroy","dispose","cancel","play","playSegment","pause","isSeeking","toSeconds","buffer","seek","normalizedTime","seconds","TonejsPlayer","PitchShift","sync","toDestination","setDetune","pitch","switchAudioFile","createAction","updateWaveform","AudioMiddleware","peaks","getPeaks","getPlayer","createMiddleware","dispatch","next","match","initAudioContext","repaintWaveform","setPlaybackRate","getState","audio","setZoom","computeSecondsPerMeasure","revokeLocalFile","cleanupPreviousInit","arrayBuffer","decodeAudioData","initTonejsAndPeaksjs","Peaks","err","on","removeAll","add","views","getView","setStartTime","WaveView","maxHeight","WaveContainer","prevProps","CircularProgress","StructurePage","anchorEl","activePopover","handlePopoverOpen","currentTarget","handlePopoverClose","WaveformControlButton","icon","PLAYBACKRATE","DETUNE","Popover","open","onClose","anchorOrigin","vertical","horizontal","anchorPosition","top","left","transformOrigin","content","PopoverContent","STARTMEASURE","ADD_SECTION","button","Tooltip","StartMeasurePopover","DetunePopover","toggleButton","Input","startAdornment","InputAdornment","ToggleButton","PlaybackRatePopover","loaded","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","FileType","_ref2","createElement","d","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref17","_ref18","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","_ref25","_ref26","_ref","svgRef","x","y","viewBox","enableBackground","xmlSpace","ref","cx","cy","r","ForwardRef","forwardRef","App","AppBar","appBar","Toolbar","noWrap","NEW","OPEN","SAVE","Drawer","drawer","paper","drawerPaper","toolbar","List","menuItem","ListItem","STRUCTURE","ListItemIcon","ListItemText","HARMONY","GUITAR","DRUM","PRINT","footer","process","flexShrink","flexGrow","mixins","zIndex","AUDIO","ZIP","FileInput","fileInput","handleChange","fileList","fileURL","getLocalFileUrl","callback","createRef","Paper","InputBase","input","placeholder","fileType","inputProps","readOnly","click","aria-label","iconButton","hidden","accept","files","flex","ModalDialog","Dialog","onCancel","maxWidth","DialogTitle","DialogContent","DialogContentText","subTitle","DialogActions","label","restoredPersistedState","sliceReducer","combineReducers","analysisReducer","audioReducer","dialog","dialogReducer","projectReducer","createRootReducer","createAppStore","configureStore","reducer","preloadedState","middleware","DialogManagement","onSubmit","zipUrl","store","AddSectionDialog","maxMeasure","NewDialog","useState","fileUrl","setFileUrl","setTitle","TextField","InputProps","OpenDialog","setFile","setSectionType","setStart","setEnd","FormLabel","MediaElement","controls","render","ThemeProvider","CssBaseline"],"mappings":"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","file":"static/js/main.5171dce8.chunk.js","sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { PersistedState } from \"states/store\";\n\nexport interface ProjectState {\n  readonly status: LoadingStatus;\n  readonly currentPage: Page;\n  readonly title: string;\n  readonly audioUrl: string;\n  readonly syncFirstMeasureStart: boolean;\n}\n\nexport enum LoadingStatus {\n  NOT_INITIALIZED = \"not_initialized\",\n  INITIALIZING = \"initializing\",\n  INITIALIZED = \"initialized\"\n}\n\nexport enum Page {\n  DEFAULT = \"default\",\n  STRUCTURE = \"structure\",\n  HARMONY = \"harmony\",\n  GUITAR = \"guitar\",\n  DRUM = \"drum\",\n  PRINT = \"print\"\n}\n\nexport const initialProjectState: ProjectState = {\n  status: LoadingStatus.NOT_INITIALIZED,\n  currentPage: Page.DEFAULT,\n  title: \"\",\n  audioUrl: \"\",\n  syncFirstMeasureStart: false\n};\n\nconst projectSlice = createSlice({\n  name: \"project\",\n  initialState: initialProjectState,\n  reducers: {\n    switchedPage(state, action: PayloadAction<Page>) {\n      state.currentPage = action.payload;\n    },\n    createdProject(state, action: PayloadAction<PersistedState>) {\n      return { ...action.payload.project, status: LoadingStatus.INITIALIZING };\n    },\n    hotReloaded(state) {\n      state.status = LoadingStatus.INITIALIZING;\n    },\n    initializedProject(state) {\n      state.status = LoadingStatus.INITIALIZED;\n    },\n    enabledSyncFirstMeasureStart(state, action: PayloadAction<boolean>) {\n      state.syncFirstMeasureStart = action.payload;\n    }\n  }\n});\n\nexport const {\n  switchedPage,\n  createdProject,\n  initializedProject,\n  hotReloaded,\n  enabledSyncFirstMeasureStart\n} = projectSlice.actions;\n\nexport default projectSlice.reducer;\n","class ArrayUtil {\n  static range: (start: number, end: number) => string[] = (start, end) => {\n    if (start > end) start = end;\n\n    return Array(end - start + 1)\n      .fill(start)\n      .map((_, idx) => (start + idx).toString());\n  };\n\n  static bordersOf: (array: Array<string>) => { start: number; end: number } = (\n    array\n  ) => {\n    return {\n      start: parseInt(array[0]),\n      end: parseInt(ArrayUtil.last(array))\n    };\n  };\n\n  static last: <T>(array: Array<T>) => T = (array) => {\n    return array[array.length - 1];\n  };\n}\n\nexport default ArrayUtil;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { createdProject } from \"states/project/projectSlice\";\nimport { NormalizedObjects } from \"states/store\";\nimport ArrayUtil from \"util/ArrayUtil\";\n\nimport {\n  distributeMeasures,\n  enclosingSectionOf,\n  generateSectionId,\n  mergeSections,\n  replaceSections,\n  sectionInvalid,\n  undefinedSection\n} from \"./analysisUtil\";\n\nexport interface AnalysisState {\n  readonly sections: NormalizedObjects<Section>;\n  readonly duration: number;\n  readonly firstMeasureStart: number;\n  readonly timeSignature: TimeSignatureType;\n  readonly bpm: number;\n  readonly measures: NormalizedObjects<Measure>;\n}\n\nexport interface Section {\n  type: SectionType;\n  measures: string[];\n}\n\nexport interface Measure {\n  time: number;\n  editable?: boolean;\n  color?: string;\n  labelText?: string;\n  id: string;\n}\n\nexport interface TimeSignature {\n  beatsPerMeasure: number;\n  beatUnit: number;\n}\n\nexport enum TimeSignatureType {\n  FOUR_FOUR = \"FOUR_FOUR\",\n  THREE_FOUR = \"THREE_FOUR\"\n}\n\nexport enum SectionType {\n  INTRO = \"INTRO\",\n  VERSE = \"VERSE\",\n  PRECHORUS = \"PRECHORUS\",\n  CHORUS = \"CHORUS\",\n  BRIDGE = \"BRIDGE\",\n  SOLO = \"SOLO\",\n  OUTRO = \"OUTRO\",\n  UNDEFINED = \"UNDEFINED\"\n}\n\nexport const initialAnalysisState: AnalysisState = {\n  sections: { allIds: [], byId: {} },\n  bpm: 120,\n  firstMeasureStart: 0,\n  duration: 180,\n  measures: { allIds: [], byId: {} },\n  timeSignature: TimeSignatureType.FOUR_FOUR\n};\n\nconst analysisSlice = createSlice({\n  name: \"analysis\",\n  initialState: initialAnalysisState,\n  extraReducers: (builder) =>\n    builder.addCase(createdProject, (state, action) => {\n      return action.payload.analysis;\n    }),\n  reducers: {\n    addedSection(state, action: PayloadAction<Section>) {\n      return addSection(state, action.payload);\n    },\n    updatedSection(\n      state,\n      action: PayloadAction<{ before: string; after: Section }>\n    ) {\n      removeSection(state, action.payload.before);\n      return addSection(state, action.payload.after);\n    },\n    removedSection(state, action: PayloadAction<string>) {\n      removeSection(state, action.payload);\n\n      return state;\n    },\n    updatedRhythm(\n      state,\n      action: PayloadAction<{\n        firstMeasureStart?: number;\n        bpm?: number;\n        timeSignatureType?: TimeSignatureType;\n        duration?: number;\n      }>\n    ) {\n      state.duration = action.payload.duration ?? state.duration;\n      state.bpm = action.payload.bpm ?? state.bpm;\n      state.firstMeasureStart =\n        action.payload.firstMeasureStart ?? state.firstMeasureStart;\n      state.timeSignature =\n        action.payload.timeSignatureType ?? state.timeSignature;\n\n      state.measures = distributeMeasures(\n        state.timeSignature,\n        state.bpm,\n        state.firstMeasureStart,\n        state.duration\n      );\n\n      if (state.sections.allIds.length === 0) {\n        state.sections = undefinedSection(state.measures.allIds.length - 1);\n        return state;\n      }\n\n      const lastSection =\n        state.sections.byId[\n          state.sections.allIds[state.sections.allIds.length - 1]\n        ];\n\n      if (lastSection === undefined) return state;\n\n      if (\n        parseInt(ArrayUtil.last(state.measures.allIds)) >\n        parseInt(lastSection.measures[lastSection.measures.length - 1])\n      ) {\n        const newLastSection: Section = {\n          type: lastSection.type,\n          measures: ArrayUtil.range(\n            parseInt(lastSection.measures[0]),\n            parseInt(ArrayUtil.last(state.measures.allIds))\n          )\n        };\n        const id = generateSectionId(newLastSection);\n        delete state.sections.byId[\n          state.sections.allIds[state.sections.allIds.length - 1]\n        ];\n        state.sections.allIds[state.sections.allIds.length - 1] = id;\n        state.sections.byId[id] = newLastSection;\n      }\n\n      removeSectionsAfterLastMeasure(state);\n\n      return state;\n    }\n  }\n});\n\nconst removeSectionsAfterLastMeasure: (state: AnalysisState) => void = (\n  state\n) => {\n  const lastMeasure = state.measures.allIds.length - 1;\n  let removalStart = -1;\n  let removalStartMeasure = -1;\n\n  for (let index = 0; index <= state.sections.allIds.length - 1; index++) {\n    const section = state.sections.byId[state.sections.allIds[index]];\n    const sectionEnd = parseInt(ArrayUtil.last(section.measures));\n\n    if (sectionEnd > lastMeasure) {\n      removalStart = index;\n      removalStartMeasure = parseInt(section.measures[0]);\n      break;\n    }\n  }\n\n  if (removalStart === -1) return; // No sections after last measure\n\n  replaceSections(\n    state.sections,\n    removalStart,\n    state.sections.allIds.length - removalStart,\n    [\n      {\n        measures: ArrayUtil.range(removalStartMeasure, lastMeasure),\n        type: SectionType.UNDEFINED\n      }\n    ]\n  );\n};\n\nconst addSection: (\n  state: AnalysisState,\n  newSection: Section\n) => AnalysisState = (state, newSection) => {\n  if (sectionInvalid(newSection)) return state;\n\n  const enclosingSection = enclosingSectionOf(newSection, state.sections);\n  if (\n    enclosingSection === undefined ||\n    enclosingSection.section.type !== SectionType.UNDEFINED\n  )\n    return state;\n\n  const mergedSections = mergeSections(enclosingSection.section, newSection);\n\n  replaceSections(state.sections, enclosingSection.position, 1, mergedSections);\n\n  return state;\n};\n\nconst removeSection: (state: AnalysisState, sectionId: string) => void = (\n  state,\n  sectionId\n) => {\n  const position = state.sections.allIds.indexOf(sectionId);\n  const section = state.sections.byId[sectionId];\n\n  const before = state.sections.allIds[position - 1];\n  const after = state.sections.allIds[position + 1];\n\n  let { start: firstMeasure, end: lastMeasure } = ArrayUtil.bordersOf(\n    section.measures\n  );\n  let removalStart = position;\n  let removalCount = 1;\n\n  if (\n    before !== undefined &&\n    state.sections.byId[before].type === SectionType.UNDEFINED\n  ) {\n    removalStart--;\n    removalCount++;\n    firstMeasure = parseInt(state.sections.byId[before].measures[0]);\n  }\n\n  if (\n    after !== undefined &&\n    state.sections.byId[after].type === SectionType.UNDEFINED\n  ) {\n    removalCount++;\n    lastMeasure = parseInt(ArrayUtil.last(state.sections.byId[after].measures));\n  }\n\n  replaceSections(state.sections, removalStart, removalCount, [\n    {\n      measures: ArrayUtil.range(firstMeasure, lastMeasure),\n      type: SectionType.UNDEFINED\n    }\n  ]);\n};\n\nexport const {\n  addedSection,\n  removedSection,\n  updatedRhythm,\n  updatedSection\n} = analysisSlice.actions;\n\nexport default analysisSlice.reducer;\n","import { NormalizedObjects } from \"states/store\";\nimport ArrayUtil from \"util/ArrayUtil\";\n\nimport {\n  Measure,\n  Section,\n  SectionType,\n  TimeSignatureType\n} from \"./analysisSlice\";\n\nexport const toTimeSignature = (type: TimeSignatureType) => {\n  switch (type) {\n    case TimeSignatureType.FOUR_FOUR:\n      return { beatUnit: 4, beatsPerMeasure: 4 };\n    case TimeSignatureType.THREE_FOUR:\n      return { beatUnit: 4, beatsPerMeasure: 3 };\n  }\n};\n\nexport const toTimeSignatureType = (type: string) => {\n  switch (type) {\n    case TimeSignatureType.FOUR_FOUR.toString():\n      return TimeSignatureType.FOUR_FOUR;\n    case TimeSignatureType.THREE_FOUR.toString():\n      return TimeSignatureType.THREE_FOUR;\n    default:\n      throw Error(\"Unknown time signature type: \" + type);\n  }\n};\n\nexport const undefinedSection = (length: number) => {\n  const undefinedSectionId = \"UNDEFINED_0_\" + length;\n  const sections: NormalizedObjects<Section> = {\n    allIds: [undefinedSectionId],\n    byId: {}\n  };\n\n  sections.byId[undefinedSectionId] = {\n    measures: ArrayUtil.range(0, length),\n    type: SectionType.UNDEFINED\n  };\n\n  return sections;\n};\n\nexport const sectionInvalid = (section: Section) => {\n  return (\n    parseInt(section.measures[0]) >\n    parseInt(section.measures[section.measures.length - 1])\n  );\n};\n\nexport const enclosingSectionOf = (\n  section: Section,\n  allSections: NormalizedObjects<Section>\n) => {\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\n    section.measures\n  );\n\n  const sectionCount = allSections.allIds.length;\n\n  for (let current = 0; current <= sectionCount - 1; current++) {\n    const section = allSections.byId[allSections.allIds[current]];\n    const { end: currentSectionEnd } = ArrayUtil.bordersOf(section.measures);\n\n    //Go to next section if not included\n    if (newSectionStart >= currentSectionEnd) continue;\n\n    //Exit if new section overlaps current section's border\n    if (newSectionEnd > currentSectionEnd) return undefined;\n\n    return { position: current, section: section };\n  }\n};\n\nexport const mergeSections: (\n  enclosingSection: Section,\n  embeddedSection: Section\n) => Section[] = (enclosingSection, embeddedSection) => {\n  const newSections: Section[] = [];\n\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\n    embeddedSection.measures\n  );\n\n  const {\n    start: currentSectionStart,\n    end: currentSectionEnd\n  } = ArrayUtil.bordersOf(enclosingSection.measures);\n\n  //Add a new undefined block before the new section\n  if (newSectionStart > currentSectionStart) {\n    const section: Section = {\n      measures: ArrayUtil.range(currentSectionStart, newSectionStart - 1),\n      type: SectionType.UNDEFINED\n    };\n    newSections.push(section);\n  }\n\n  //add new section\n  newSections.push(embeddedSection);\n\n  //Add a new undefined block after the new section\n  if (newSectionEnd < currentSectionEnd) {\n    const section: Section = {\n      measures: ArrayUtil.range(newSectionEnd + 1, currentSectionEnd),\n      type: SectionType.UNDEFINED\n    };\n    newSections.push(section);\n  }\n\n  return newSections;\n};\n\nexport const replaceSections = (\n  sections: NormalizedObjects<Section>,\n  start: number,\n  deleteCount: number,\n  newSections: Section[]\n) => {\n  for (let section = start; section < deleteCount; section++) {\n    delete sections.byId[sections.allIds[section]];\n  }\n\n  const ids: string[] = [];\n\n  newSections.forEach((section) => {\n    const id = generateSectionId(section);\n    ids.push(id);\n    sections.byId[id] = section;\n  });\n\n  sections.allIds.splice(start, deleteCount, ...ids);\n};\n\nexport const generateSectionId = (section: Section) =>\n  section.type +\n  \"_\" +\n  section.measures[0] +\n  \"_\" +\n  section.measures[section.measures.length - 1];\n\nexport const getMeasureEnd: (\n  position: number,\n  measures: NormalizedObjects<Measure>\n) => number = (position, measures) => {\n  if (measures.allIds.length - 1 > position)\n    return measures.byId[position + 1].time;\n  else {\n    return 2 * measures.byId[position].time - measures.byId[position - 1].time;\n  }\n};\n\nexport const distributeMeasures = (\n  timeSignatureType: TimeSignatureType,\n  bpm: number,\n  firstMeasureStart: number,\n  length: number\n) => {\n  const timeSignature = toTimeSignature(timeSignatureType);\n  const lengthOfOneMeasure = (60 * timeSignature.beatsPerMeasure) / bpm;\n  const measures: NormalizedObjects<Measure> = { allIds: [], byId: {} };\n\n  let index = 0;\n  for (\n    let start = firstMeasureStart;\n    start < length;\n    start += lengthOfOneMeasure\n  ) {\n    measures.allIds.push(\"\" + index);\n    measures.byId[index] = {\n      time: start,\n      color: \"\",\n      editable: false,\n      id: \"\" + index,\n      labelText: \"\" + index\n    };\n    index++;\n  }\n\n  return measures;\n};\n","import blueGrey from \"@material-ui/core/colors/blueGrey\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\nimport { Theme } from \"@material-ui/core/styles/createMuiTheme\";\nimport { SectionType } from \"states/analysis/analysisSlice\";\n\n// Extend Material UI theme type declaration\ndeclare module \"@material-ui/core/styles/createMuiTheme\" {\n  // add custom theme options\n  interface ThemeOptions {\n    logo: {\n      height: React.CSSProperties[\"height\"];\n      marginRight: React.CSSProperties[\"marginRight\"];\n    };\n    popover: {\n      width: React.CSSProperties[\"width\"];\n      minHeight: React.CSSProperties[\"minHeight\"];\n      margin: React.CSSProperties[\"margin\"];\n      marginTop: React.CSSProperties[\"marginTop\"];\n    };\n    measureSelect: {\n      minWidth: React.CSSProperties[\"minWidth\"];\n    };\n    formControl: {\n      marginBottom: React.CSSProperties[\"marginBottom\"];\n    };\n    sectionTypes: {\n      INTRO: React.CSSProperties[\"color\"];\n      VERSE: React.CSSProperties[\"color\"];\n      PRECHORUS: React.CSSProperties[\"color\"];\n      CHORUS: React.CSSProperties[\"color\"];\n      SOLO: React.CSSProperties[\"color\"];\n      OUTRO: React.CSSProperties[\"color\"];\n      BRIDGE: React.CSSProperties[\"color\"];\n      UNDEFINED: React.CSSProperties[\"color\"];\n    };\n    sectionSelect: {\n      minWidth: React.CSSProperties[\"minWidth\"];\n    };\n    view: {\n      background: React.CSSProperties[\"color\"];\n      headerBackground: React.CSSProperties[\"color\"];\n      headerPadding: React.CSSProperties[\"padding\"];\n    };\n    waveform: {\n      pointMarkerColor: React.CSSProperties[\"color\"];\n    };\n  }\n\n  // make custom theme options available in theme\n  interface Theme extends ThemeOptions {}\n}\n\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"light\",\n    primary: blueGrey,\n    background: {\n      default: \"#d5d8da\"\n    }\n  },\n  logo: {\n    height: \"40px\",\n    marginRight: \"5px\"\n  },\n  popover: {\n    width: \"200px\",\n    minHeight: \"50px\",\n    margin: \"10px\",\n    marginTop: \"20px\"\n  },\n  measureSelect: {\n    minWidth: \"40px\"\n  },\n  formControl: {\n    marginBottom: \"20px\"\n  },\n  sectionTypes: {\n    INTRO: \"#FFCA28\",\n    VERSE: \"#FFA726\",\n    PRECHORUS: \"#FF7043\",\n    CHORUS: \"#9CCC65\",\n    SOLO: \"#26C6DA\",\n    OUTRO: \"#5C6BC0\",\n    BRIDGE: \"#EC407A\",\n    UNDEFINED: \"#f2f2f2\"\n  },\n  sectionSelect: {\n    minWidth: \"140px\"\n  },\n  view: {\n    background: \"#ffffff\",\n    headerBackground: \"#f1f4f6\",\n    headerPadding: \"4px\"\n  },\n  waveform: {\n    pointMarkerColor: \"#006eb0\"\n  },\n  overrides: {\n    MuiListItemIcon: {\n      root: {\n        color: \"#abb1b7\"\n      }\n    }\n  }\n});\n\nexport const getColor = (sectionType: SectionType) => {\n  const result = SECTIONTYPE_TO_COLOR.get(sectionType);\n\n  if (!result) throw Error(\"Unknown SectionType \" + sectionType);\n\n  return result;\n};\n\nconst SECTIONTYPE_TO_COLOR = new Map<SectionType, React.CSSProperties[\"color\"]>(\n  [\n    [SectionType.INTRO, theme.sectionTypes.INTRO],\n    [SectionType.VERSE, theme.sectionTypes.VERSE],\n    [SectionType.PRECHORUS, theme.sectionTypes.PRECHORUS],\n    [SectionType.CHORUS, theme.sectionTypes.CHORUS],\n    [SectionType.SOLO, theme.sectionTypes.SOLO],\n    [SectionType.OUTRO, theme.sectionTypes.OUTRO],\n    [SectionType.BRIDGE, theme.sectionTypes.BRIDGE],\n    [SectionType.UNDEFINED, theme.sectionTypes.UNDEFINED]\n  ]\n) as ReadonlyMap<SectionType, string>;\n\nexport default theme;\n","import { PeaksOptions, PointAddOptions, SegmentAddOptions } from \"peaks.js\";\nimport { Measure, Section } from \"states/analysis/analysisSlice\";\nimport { NormalizedObjects } from \"states/store\";\nimport theme, { getColor } from \"styles/theme\";\n\nimport AudioPlayer from \"./audioPlayer\";\n\nexport const AUDIO_DOM_ELEMENT = \"audio_dom_element\";\nexport const ZOOMVIEW_CONTAINER = \"zoomview-container\";\nexport const OVERVIEW_CONTAINER = \"overview-container\";\n\nclass PeaksConfig {\n  static create: (\n    audioBuffer: AudioBuffer,\n    audioPlayer: AudioPlayer\n  ) => PeaksOptions = (audioBuffer, audioPlayer) => {\n    const mediaelement: HTMLAudioElement = document.getElementById(\n      AUDIO_DOM_ELEMENT\n    ) as HTMLAudioElement;\n\n    return {\n      containers: {\n        zoomview: document.getElementById(ZOOMVIEW_CONTAINER),\n        overview: document.getElementById(OVERVIEW_CONTAINER)\n      },\n      mediaElement: mediaelement,\n      webAudio: {\n        audioBuffer: audioBuffer,\n        scale: 128,\n        multiChannel: false\n      },\n      keyboard: true,\n      pointMarkerColor: theme.waveform.pointMarkerColor,\n      showPlayheadTime: true,\n      zoomLevels: [42], //TODO: Define good initial default\n      player: audioPlayer\n    };\n  };\n\n  static sectionsToSegment = (\n    sections: NormalizedObjects<Section>,\n    measures: NormalizedObjects<Measure>,\n    timePerMeasure: number\n  ) => {\n    const segments: SegmentAddOptions[] = [];\n    sections.allIds.forEach((id) => {\n      const section = sections.byId[id];\n\n      const start = measures.byId[section.measures[0]].time;\n      const end =\n        measures.byId[section.measures[section.measures.length - 1]].time +\n        timePerMeasure;\n\n      const segment: SegmentAddOptions = {\n        id,\n        labelText: section.type,\n        startTime: start,\n        endTime: end,\n        color: getColor(section.type),\n        editable: false\n      };\n\n      segments.push(segment);\n    });\n\n    return segments;\n  };\n\n  static measuresToPoints = (measures: NormalizedObjects<Measure>) => {\n    const points: PointAddOptions[] = [];\n    measures.allIds.forEach((id) => {\n      const measure = measures.byId[id];\n\n      const point: PointAddOptions = measure;\n\n      points.push(point);\n    });\n\n    return points;\n  };\n}\n\nexport default PeaksConfig;\n","import debug from \"debug\";\n\nexport class Level {\n  public static readonly TRACE = new Level(\"trace\", \"lightblue\");\n  public static readonly INFO = new Level(\"info\", \"blue\");\n  public static readonly WARN = new Level(\"warn\", \"yellow\");\n  public static readonly ERROR = new Level(\"error\", \"red\");\n\n  private constructor(\n    public readonly name: string,\n    public readonly color: string\n  ) {}\n}\n\nclass Log {\n  private static generateMessage(\n    level: Level,\n    message: string,\n    source: string\n  ) {\n    const namespace = `transcribe:${level.name}`;\n    const createDebug = debug(namespace);\n\n    createDebug.color = level.color;\n\n    if (source) {\n      createDebug(source, message);\n    } else {\n      createDebug(message);\n    }\n  }\n\n  static trace(message: string, source: string) {\n    return this.generateMessage(Level.TRACE, message, source);\n  }\n\n  static info(message: string, source: string) {\n    return this.generateMessage(Level.INFO, message, source);\n  }\n\n  static warn(message: string, source: string) {\n    return this.generateMessage(Level.WARN, message, source);\n  }\n\n  static error(message: string, source: string) {\n    return this.generateMessage(Level.ERROR, message, source);\n  }\n}\n\nexport default Log;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\nexport interface DialogState {\n  readonly currentDialog: DialogType;\n}\n\nexport enum DialogType {\n  NONE = \"none\",\n  NEW = \"new\",\n  OPEN = \"open\",\n  SAVE = \"save\",\n  ADD_SECTION = \"add_section\"\n}\n\nconst initialDialogState: DialogState = {\n  currentDialog: DialogType.NONE\n};\n\nconst dialogsSlice = createSlice({\n  name: \"dialogs\",\n  initialState: initialDialogState,\n  reducers: {\n    openedDialog(state, action: PayloadAction<DialogType>) {\n      state.currentDialog = action.payload;\n    },\n    closedDialog(state) {\n      state.currentDialog = DialogType.NONE;\n    }\n  }\n});\n\nexport const { openedDialog, closedDialog } = dialogsSlice.actions;\n\nexport default dialogsSlice.reducer;\n","import { createStyles, WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { Component } from \"react\";\n\ninterface Props extends WithStyles<typeof stylesForToggle> {\n  show: boolean;\n}\n\nclass Toggle extends Component<Props> {\n  render() {\n    return (\n      <div\n        className={\n          this.props.show\n            ? this.props.classes.inline\n            : this.props.classes.invisible\n        }\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nconst stylesForToggle = () =>\n  createStyles({\n    inline: {\n      display: \"inline\"\n    },\n    invisible: {\n      display: \"none\"\n    }\n  });\n\nexport default withStyles(stylesForToggle, { withTheme: true })(Toggle);\n","import React from \"react\";\n\nclass VersionInfo extends React.Component<{\n  version: string;\n  hash: string;\n  description: string;\n}> {\n  render() {\n    return (\n      <>\n        {this.props.version} (\n        <a\n          href={\"https://github.com/tscz/transcribe/commit/\" + this.props.hash}\n        >\n          {this.props.hash} - {this.props.description}\n        </a>\n        )\n      </>\n    );\n  }\n}\n\nexport default VersionInfo;\n","import {\n  CardHeader,\n  createStyles,\n  Theme,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport React, { ReactElement } from \"react\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      height: \"100%\",\n      backgroundColor: theme.view.background\n    },\n    header: {\n      backgroundColor: theme.view.headerBackground,\n      padding: theme.view.headerPadding\n    }\n  });\n\ninterface Props {\n  body: ReactElement;\n  title: string;\n  action?: ReactElement;\n}\n\ntype PropsWithStyle = Props & WithStyles<typeof styles>;\n\nconst View = withStyles(styles)((props: PropsWithStyle) => {\n  return (\n    <Card className={props.classes.root} raised={false}>\n      <CardHeader\n        titleTypographyProps={{ variant: \"subtitle1\" }}\n        title={props.title}\n        className={props.classes.header}\n        action={props.action}\n      />\n      <CardContent>{props.body}</CardContent>\n    </Card>\n  );\n});\n\nexport default View;\n","import View from \"components/view/view\";\nimport React from \"react\";\n\nclass DefaultPage extends React.Component {\n  render() {\n    return (\n      <View\n        title=\"Info\"\n        body={\n          <>\n            <p>No Transcription started!!</p>\n            <p>Please create a new Transcription or open an existing one.</p>\n          </>\n        }\n      ></View>\n    );\n  }\n}\n\nexport default DefaultPage;\n","import View from \"components/view/view\";\nimport React from \"react\";\n\nclass DrumPage extends React.Component {\n  render() {\n    return (\n      <View\n        title=\"Drums View\"\n        body={\n          <p>\n            In this section you&apos;ll be able to transcribe the drum part.\n            Please come back later.\n          </p>\n        }\n      ></View>\n    );\n  }\n}\n\nexport default DrumPage;\n","import View from \"components/view/view\";\nimport React from \"react\";\n\nclass GuitarPage extends React.Component {\n  render() {\n    return (\n      <View\n        title=\"Guitar\"\n        body={\n          <p>\n            In this section you&apos;ll be able to transcribe the guitar part.\n            Please come back later.\n          </p>\n        }\n      ></View>\n    );\n  }\n}\n\nexport default GuitarPage;\n","import View from \"components/view/view\";\nimport React from \"react\";\n\nclass HarmonyPage extends React.Component {\n  render() {\n    return (\n      <View\n        title=\"Harmony\"\n        body={\n          <p>\n            In this section you&apos;ll be able to transcribe the harmony.\n            Please come back later.\n          </p>\n        }\n      ></View>\n    );\n  }\n}\n\nexport default HarmonyPage;\n","import View from \"components/view/view\";\nimport React from \"react\";\n\nclass PrintPage extends React.Component {\n  render() {\n    return (\n      <View\n        title=\"Print\"\n        body={\n          <p>\n            In this section you&apos;ll be able to print the leadsheet. Please\n            come back later.\n          </p>\n        }\n      ></View>\n    );\n  }\n}\n\nexport default PrintPage;\n","import Grid from \"@material-ui/core/Grid\";\nimport React, { ReactElement } from \"react\";\n\ninterface Props {\n  topLeft: ReactElement;\n  topRight: ReactElement;\n  bottomLeft: ReactElement;\n  bottomRight: ReactElement;\n}\n\nclass ContentLayout extends React.Component<Props> {\n  render() {\n    return (\n      <Grid container spacing={2} alignItems=\"stretch\">\n        <Grid item xs={10}>\n          <Grid container spacing={2} alignItems=\"stretch\">\n            <Grid item xs={12}>\n              {this.props.topLeft}\n            </Grid>\n            <Grid item xs={12}>\n              <Grid container spacing={2} alignItems=\"stretch\">\n                <Grid item xs={10}>\n                  {this.props.bottomLeft}\n                </Grid>\n                <Grid item xs={2}>\n                  {this.props.bottomRight}\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n        <Grid item xs={2}>\n          {this.props.topRight}\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default ContentLayout;\n","import {\n  Box,\n  createStyles,\n  FormControl,\n  InputLabel,\n  Slider,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nconst styles = () =>\n  createStyles({\n    root: {\n      width: \"100%\"\n    }\n  });\n\ninterface Props {\n  title: string;\n  min: number;\n  max: number;\n  step: number;\n  value: number;\n  onChange: (event: React.ChangeEvent<{}>, value: number | number[]) => void;\n}\n\ntype PropsWithStyle = Props & WithStyles<typeof styles>;\n\nconst SliderInput = withStyles(styles)((props: PropsWithStyle) => {\n  return (\n    <FormControl className={props.classes.root}>\n      <InputLabel shrink>{props.title}</InputLabel>\n      <Box mt={2}>\n        <Slider\n          value={props.value}\n          valueLabelDisplay=\"auto\"\n          min={props.min}\n          max={props.max}\n          onChange={props.onChange}\n          step={props.step}\n        />\n      </Box>\n    </FormControl>\n  );\n});\n\nexport default SliderInput;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\nexport interface AudioState {\n  readonly isPlaying: boolean;\n  readonly detune: number;\n  readonly playbackRate: number;\n  readonly isLooping: boolean;\n  readonly loopStart: number;\n  readonly loopEnd: number;\n}\n\nexport interface PlaybackSettings {\n  readonly detune?: number;\n  readonly playbackRate?: number;\n}\n\nexport const initialAudioState: AudioState = {\n  isPlaying: false,\n  detune: 0,\n  playbackRate: 1,\n  isLooping: false,\n  loopStart: 0,\n  loopEnd: 0\n};\n\nconst audioSlice = createSlice({\n  name: \"audio\",\n  initialState: initialAudioState,\n  reducers: {\n    triggeredPlay(state) {\n      state.isPlaying = true;\n    },\n    triggeredPause(state) {\n      state.isPlaying = false;\n    },\n    updatedPlaybackSettings(\n      state,\n      action: PayloadAction<{ playbackRate?: number; detune?: number }>\n    ) {\n      if (action.payload.detune !== undefined)\n        state.detune = action.payload.detune;\n      if (action.payload.playbackRate !== undefined)\n        state.playbackRate = action.payload.playbackRate;\n    },\n    toggledLoop(state) {\n      state.isLooping = !state.isLooping;\n    },\n    updatedLoopSettings(\n      state,\n      action: PayloadAction<{ start?: number; end?: number }>\n    ) {\n      if (action.payload.start !== undefined)\n        state.loopStart = action.payload.start;\n      if (action.payload.end !== undefined) state.loopEnd = action.payload.end;\n    }\n  }\n});\n\nexport const {\n  triggeredPause,\n  triggeredPlay,\n  updatedPlaybackSettings,\n  toggledLoop,\n  updatedLoopSettings\n} = audioSlice.actions;\n\nexport default audioSlice.reducer;\n","import {\n  Button,\n  ButtonGroup,\n  createStyles,\n  Grid,\n  Typography,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Measure, Section, SectionType } from \"states/analysis/analysisSlice\";\nimport { getMeasureEnd } from \"states/analysis/analysisUtil\";\nimport { updatedLoopSettings } from \"states/audio/audioSlice\";\nimport { ApplicationState, NormalizedObjects } from \"states/store\";\nimport { getColor } from \"styles/theme\";\n\nenum Area {\n  OUTSIDE,\n  LEFT,\n  RIGHT,\n  INSIDE,\n  LEFT_AND_RIGHT\n}\n\ninterface PropsFromState {\n  sections: NormalizedObjects<Section>;\n  measures: NormalizedObjects<Measure>;\n}\n\ninterface PropsFromDispatch {\n  updatedLoopSettings: typeof updatedLoopSettings;\n}\n\ninterface Props {}\n\ntype AllProps = PropsFromState &\n  PropsFromDispatch &\n  Props &\n  WithStyles<typeof styles>;\n\ninterface State {\n  start: number;\n  end: number;\n}\n\nconst styles = () =>\n  createStyles({\n    mainGrid: {\n      marginBottom: \"5px\"\n    },\n    section: {}\n  });\n\nclass SectionOverview extends React.Component<AllProps, State> {\n  state: State = {\n    start: 0,\n    end: 0\n  };\n\n  getArea(measure: number) {\n    if (this.state.start > measure || this.state.end < measure)\n      return Area.OUTSIDE;\n\n    if (measure === this.state.start && measure === this.state.end)\n      return Area.LEFT_AND_RIGHT;\n\n    if (measure === this.state.start) return Area.LEFT;\n\n    if (measure === this.state.end) return Area.RIGHT;\n\n    return Area.INSIDE;\n  }\n\n  render() {\n    const { sections, measures } = this.props;\n\n    const generateMatrix = (arr: string[], size: number) => {\n      const res = [];\n      for (let i = 0; i < arr.length; i = i + size)\n        res.push(arr.slice(i, i + size));\n      return res;\n    };\n\n    return (\n      <>\n        <Grid container direction=\"column\">\n          {sections.allIds.map((sectionId) => (\n            <Grid item key={sectionId}>\n              <Grid container direction=\"column\">\n                <Grid item key={sectionId + \"_caption\"}>\n                  <Typography variant=\"caption\">\n                    {sections.byId[sectionId].type.toLowerCase()}\n                  </Typography>\n                </Grid>\n                <Grid item key={sectionId + \"_body\"}>\n                  <Grid\n                    container\n                    direction=\"column\"\n                    className={this.props.classes.mainGrid}\n                  >\n                    {generateMatrix(sections.byId[sectionId].measures, 8).map(\n                      (row) => (\n                        <ButtonGroup\n                          key={sectionId + \"_buttonGroup_\" + row[0]}\n                          orientation=\"horizontal\"\n                          size=\"small\"\n                          className={this.props.classes.section}\n                        >\n                          {row.map((measureId) => {\n                            const measure: Measure = measures.byId[measureId];\n                            const position = Number(measureId);\n                            return (\n                              <Square\n                                key={measure.id}\n                                value={measure.id}\n                                sectiontype={sections.byId[sectionId].type}\n                                onClick={() => {\n                                  if (position <= this.state.end) {\n                                    this.setState(() => ({\n                                      start: position,\n                                      end: position\n                                    }));\n                                    this.props.updatedLoopSettings({\n                                      start: measures.byId[position].time,\n                                      end: getMeasureEnd(position, measures)\n                                    });\n                                  } else {\n                                    this.setState(() => ({\n                                      end: position\n                                    }));\n                                    this.props.updatedLoopSettings({\n                                      end: getMeasureEnd(position, measures)\n                                    });\n                                  }\n                                }}\n                                position={this.getArea(position)}\n                              ></Square>\n                            );\n                          })}\n                        </ButtonGroup>\n                      )\n                    )}\n                  </Grid>\n                </Grid>\n              </Grid>\n            </Grid>\n          ))}\n        </Grid>\n      </>\n    );\n  }\n}\n\nconst squareStyles = () =>\n  createStyles({\n    root: {\n      backgroundColor: (props: SquareProps) => getColor(props.sectiontype),\n      minWidth: \"12%\",\n      minHeight: \"15px\",\n      padding: \"0px\",\n      marginLeft: \"2px\",\n      marginBottom: \"2px\",\n      opacity: \"0.7\"\n    },\n    selected: {\n      opacity: \"1\",\n      borderTopColor: \"#000000\",\n      borderBottomColor: \"#000000\"\n    },\n    selectedLeft: {\n      borderLeftWidth: \"4px\",\n      borderLeftColor: \"#000000\"\n    },\n    selectedRight: {\n      borderRightWidth: \"4px\",\n      borderRightColor: \"#000000\"\n    }\n  });\n\ninterface SquareProps {\n  value: string;\n  sectiontype: SectionType;\n  onClick: () => void;\n  position: Area;\n}\n\ntype SquarePropsWithStyle = SquareProps & WithStyles<typeof squareStyles>;\n\nconst getCssClass = (props: SquarePropsWithStyle) => {\n  switch (props.position) {\n    case Area.OUTSIDE:\n      return clsx(props.classes.root);\n    case Area.INSIDE:\n      return clsx(props.classes.root, props.classes.selected);\n    case Area.LEFT:\n      return clsx(\n        props.classes.root,\n        props.classes.selected,\n        props.classes.selectedLeft\n      );\n    case Area.RIGHT:\n      return clsx(\n        props.classes.root,\n        props.classes.selected,\n        props.classes.selectedRight\n      );\n    case Area.LEFT_AND_RIGHT:\n      return clsx(\n        props.classes.root,\n        props.classes.selected,\n        props.classes.selectedLeft,\n        props.classes.selectedRight\n      );\n  }\n};\n\nconst Square = withStyles(squareStyles)((props: SquarePropsWithStyle) => {\n  return (\n    <Button\n      {...props}\n      onClick={() => props.onClick()}\n      className={getCssClass(props)}\n    >\n      {props.value}\n    </Button>\n  );\n});\n\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\n  return {\n    sections: analysis.sections,\n    measures: analysis.measures\n  };\n};\n\nconst mapDispatchToProps = { updatedLoopSettings };\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(styles, { withTheme: true })(SectionOverview));\n","import { FormControl, InputLabel, NativeSelect } from \"@material-ui/core\";\nimport SliderInput from \"components/sliderInput/sliderInput\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  TimeSignatureType,\n  updatedRhythm\n} from \"states/analysis/analysisSlice\";\nimport { toTimeSignatureType } from \"states/analysis/analysisUtil\";\nimport { ApplicationState } from \"states/store\";\n\ninterface PropsFromState {\n  readonly timeSignature: TimeSignatureType;\n  readonly bpm: number;\n}\n\ninterface PropsFromDispatch {\n  updatedRhythm: typeof updatedRhythm;\n}\n\ntype AllProps = PropsFromState & PropsFromDispatch;\n\nclass PropertiesView extends Component<AllProps> {\n  render() {\n    return (\n      <>\n        <SliderInput\n          title=\"Bpm\"\n          value={this.props.bpm}\n          min={40}\n          max={220}\n          step={1}\n          onChange={(_e, bpm) => {\n            if (!Array.isArray(bpm)) {\n              this.props.updatedRhythm({ bpm: bpm });\n            }\n          }}\n        ></SliderInput>\n        <FormControl fullWidth={true}>\n          <InputLabel>Time Signature</InputLabel>\n          <NativeSelect\n            value={this.props.timeSignature}\n            onChange={(e) =>\n              this.props.updatedRhythm({\n                timeSignatureType: toTimeSignatureType(e.target.value)\n              })\n            }\n          >\n            <option value={TimeSignatureType.FOUR_FOUR}>4/4</option>\n            <option value={TimeSignatureType.THREE_FOUR}>3/4</option>\n          </NativeSelect>\n        </FormControl>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\n  return {\n    bpm: analysis.bpm,\n    timeSignature: analysis.timeSignature\n  };\n};\n\nconst mapDispatchToProps = {\n  updatedRhythm\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PropertiesView);\n","import {\n  createStyles,\n  MenuItem,\n  Theme,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport Select from \"@material-ui/core/Select/Select\";\nimport React from \"react\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      minWidth: theme.measureSelect.minWidth\n    }\n  });\n\ninterface Props extends WithStyles<typeof styles> {\n  value: number;\n  min: number;\n  max: number;\n  onChange: (value: number) => void;\n  disabled?: boolean;\n}\n\nconst MeasureSelect = withStyles(styles)((props: Props) => {\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    const newMeasure = event.target.value as number;\n    props.onChange(newMeasure);\n  };\n\n  return (\n    <Select\n      value={props.value}\n      onChange={handleChange}\n      className={props.classes.root}\n      disabled={props.disabled}\n    >\n      {new Array<number>(props.max - props.min + 1)\n        .fill(0)\n        .map((_, idx: number) => {\n          return (\n            <MenuItem key={props.min + idx} value={props.min + idx}>\n              {props.min + idx}\n            </MenuItem>\n          );\n        })}\n    </Select>\n  );\n});\n\nexport default MeasureSelect;\n","import {\n  createStyles,\n  MenuItem,\n  Theme,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport Select from \"@material-ui/core/Select/Select\";\nimport clsx from \"clsx\";\nimport React from \"react\";\nimport { SectionType } from \"states/analysis/analysisSlice\";\nimport { getColor } from \"styles/theme\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      minWidth: theme.sectionSelect.minWidth\n    },\n    colored: {\n      backgroundColor: (props: Props) => getColor(props.value)\n    }\n  });\n\ninterface Props {\n  value: SectionType;\n  onChange: (sectionType: SectionType) => void;\n}\n\ntype PropsWithStyle = Props & WithStyles<typeof styles>;\n\nconst SectionSelect = withStyles(styles)((props: PropsWithStyle) => {\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    const newSection = event.target.value as SectionType;\n    props.onChange(newSection);\n  };\n\n  return (\n    <Select\n      value={props.value}\n      onChange={handleChange}\n      className={clsx(props.classes.root)}\n    >\n      {Object.values(SectionType).map((sectionType) => {\n        return sectionType === SectionType.UNDEFINED ? undefined : (\n          <MenuItem key={sectionType} value={sectionType}>\n            {sectionType}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n});\n\nexport default SectionSelect;\n","import {\n  createStyles,\n  IconButton,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport RemoveIcon from \"@material-ui/icons/Remove\";\nimport Log from \"components/log/log\";\nimport MeasureSelect from \"components/measureSelect/measureSelect\";\nimport SectionSelect from \"components/sectionSelect/sectionSelect\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  addedSection,\n  removedSection,\n  Section,\n  SectionType,\n  updatedSection\n} from \"states/analysis/analysisSlice\";\nimport { ApplicationState, NormalizedObjects } from \"states/store\";\nimport ArrayUtil from \"util/ArrayUtil\";\n\ninterface PropsFromState {\n  readonly sections: NormalizedObjects<Section>;\n  readonly measuresCount: number;\n}\n\ninterface PropsFromDispatch {\n  addedSection: typeof addedSection;\n  updatedSection: typeof updatedSection;\n  removedSection: typeof removedSection;\n}\n\ntype AllProps = PropsFromState & PropsFromDispatch & WithStyles<typeof styles>;\n\nclass StructureView extends Component<AllProps> {\n  handleAddSection = (section: Section) => {\n    this.props.addedSection(section);\n  };\n\n  handleUpdatedSection = (id: string, before: Section, after: Section) => {\n    Log.info(\n      \"Change section \" +\n        id +\n        \" from \" +\n        JSON.stringify(before) +\n        \" to \" +\n        JSON.stringify(after),\n      StructureView.name\n    );\n\n    if (\n      parseInt(after.measures[0]) >\n      parseInt(after.measures[after.measures.length - 1])\n    )\n      return;\n\n    this.props.updatedSection({ before: id, after });\n  };\n\n  handleRemoveSection = (id: string) => {\n    this.props.removedSection(id);\n  };\n\n  render() {\n    return (\n      <TableContainer>\n        <Table size=\"small\">\n          <TableHead>\n            <TableRow>\n              <TableCell className={this.props.classes.column1}></TableCell>\n              <TableCell className={this.props.classes.column2}>\n                Section\n              </TableCell>\n              <TableCell className={this.props.classes.column3}>\n                First Measure\n              </TableCell>\n              <TableCell className={this.props.classes.column4}>\n                Last Measure\n              </TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {this.props.sections.allIds.map((id: string) => {\n              const section = this.props.sections.byId[id];\n              return (\n                <TableRow key={id}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    {section.type !== SectionType.UNDEFINED && (\n                      <IconButton\n                        onClick={() => this.handleRemoveSection(id)}\n                        size=\"small\"\n                      >\n                        <RemoveIcon></RemoveIcon>\n                      </IconButton>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    {section.type === SectionType.UNDEFINED ? (\n                      \"UNDEFINED\"\n                    ) : (\n                      <SectionSelect\n                        value={section.type}\n                        onChange={(sectionType) =>\n                          this.handleUpdatedSection(id, section, {\n                            ...section,\n                            type: sectionType\n                          })\n                        }\n                      ></SectionSelect>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    <MeasureSelect\n                      disabled={section.type === SectionType.UNDEFINED}\n                      value={parseInt(section.measures[0])}\n                      min={0}\n                      max={this.props.measuresCount - 1}\n                      onChange={(measure) =>\n                        this.handleUpdatedSection(id, section, {\n                          ...section,\n                          measures: ArrayUtil.range(\n                            measure,\n                            parseInt(\n                              section.measures[section.measures.length - 1]\n                            )\n                          )\n                        })\n                      }\n                    />\n                  </TableCell>\n                  <TableCell>\n                    <MeasureSelect\n                      disabled={section.type === SectionType.UNDEFINED}\n                      value={parseInt(\n                        section.measures[section.measures.length - 1]\n                      )}\n                      min={0}\n                      max={this.props.measuresCount - 1}\n                      onChange={(measure) =>\n                        this.handleUpdatedSection(id, section, {\n                          ...section,\n                          measures: ArrayUtil.range(\n                            parseInt(section.measures[0]),\n                            measure\n                          )\n                        })\n                      }\n                    />\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </TableContainer>\n    );\n  }\n}\n\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\n  return {\n    sections: analysis.sections,\n    measuresCount: analysis.measures.allIds.length\n  };\n};\n\nconst mapDispatchToProps = {\n  addedSection,\n  updatedSection,\n  removedSection\n};\n\nconst styles = () =>\n  createStyles({\n    column1: {\n      width: \"10%\"\n    },\n    column2: {\n      width: \"30%\"\n    },\n    column3: {\n      width: \"30%\"\n    },\n    column4: {\n      width: \"30%\"\n    }\n  });\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(styles, { withTheme: true })(StructureView));\n","/* eslint-disable react/forbid-component-props */\nimport { Grid } from \"@material-ui/core\";\nimport SectionOverview from \"components/sectionOverview/sectionOverview\";\nimport React, { Component } from \"react\";\n\nclass StructureNavigationView extends Component<{}> {\n  render() {\n    return (\n      <Grid\n        container\n        direction=\"column\"\n        justify=\"center\"\n        alignItems=\"center\"\n        alignContent=\"stretch\"\n      >\n        <Grid style={{ width: \"100%\" }}>\n          <SectionOverview></SectionOverview>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default StructureNavigationView;\n","import { saveAs } from \"file-saver\";\nimport JSZip from \"jszip\";\nimport { PersistedState } from \"states/store\";\n\ninterface SaveOptions {\n  audioFileUrl: string;\n  state: PersistedState;\n}\n\nclass PersistenceApi {\n  private constructor() {\n    //not instanciable\n  }\n\n  private static songFile = \"song.blob\";\n  private static stateFile = \"state.json\";\n\n  static save = async (filename: string, options: SaveOptions) => {\n    const zip = new JSZip();\n    zip.file(PersistenceApi.stateFile, JSON.stringify(options.state));\n\n    const response = await fetch(options.audioFileUrl);\n    const audioBlob: Blob = await response.blob();\n    zip.file(PersistenceApi.songFile, audioBlob);\n\n    await zip.generateAsync({ type: \"blob\" }).then((file) => {\n      saveAs(file, filename);\n    });\n  };\n\n  static async open(\n    zip: File\n  ): Promise<{ audioBlob: Blob; state: PersistedState }> {\n    const archive = await JSZip.loadAsync(zip);\n    const audioBlob = await archive.file(PersistenceApi.songFile).async(\"blob\");\n\n    const json = await archive.file(PersistenceApi.stateFile).async(\"text\");\n    const state: PersistedState = JSON.parse(json);\n\n    return { audioBlob, state };\n  }\n\n  static revokeLocalFile(url: string) {\n    window.URL.revokeObjectURL(url);\n  }\n\n  static getLocalFileUrl(blob: Blob) {\n    return window.URL.createObjectURL(blob);\n  }\n}\n\nexport default PersistenceApi;\n","import {\n  createStyles,\n  FormControl,\n  IconButton,\n  Input,\n  InputAdornment,\n  InputLabel,\n  Popover,\n  Theme,\n  Tooltip,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport BorderLeftIcon from \"@material-ui/icons/BorderLeft\";\nimport LoopIcon from \"@material-ui/icons/Loop\";\nimport MusicNoteIcon from \"@material-ui/icons/MusicNote\";\nimport PauseIcon from \"@material-ui/icons/Pause\";\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\nimport SpeedIcon from \"@material-ui/icons/Speed\";\nimport SyncAltIcon from \"@material-ui/icons/SyncAlt\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport ContentLayout from \"components/contentLayout/contentLayout\";\nimport Log from \"components/log/log\";\nimport SliderInput from \"components/sliderInput/sliderInput\";\nimport View from \"components/view/view\";\nimport React, { ReactElement } from \"react\";\nimport { connect } from \"react-redux\";\nimport { updatedRhythm } from \"states/analysis/analysisSlice\";\nimport {\n  triggeredPause,\n  triggeredPlay,\n  updatedPlaybackSettings\n} from \"states/audio/audioSlice\";\nimport { DialogType, openedDialog } from \"states/dialog/dialogsSlice\";\nimport {\n  enabledSyncFirstMeasureStart,\n  LoadingStatus\n} from \"states/project/projectSlice\";\nimport { ApplicationState } from \"states/store\";\nimport PropertiesView from \"views/properties/propertiesView\";\nimport StructureView from \"views/structure/structureView\";\nimport StructureNavigationView from \"views/structureNavigation/structureNavigationView\";\nimport WaveContainer from \"views/wave/waveContainer\";\n\ninterface PropsFromState {\n  readonly loaded: boolean;\n  readonly isPlaying: boolean;\n  readonly syncFirstMeasureStart: boolean;\n  readonly firstMeasureStart: number;\n  readonly detune: number;\n  readonly playbackRate: number;\n}\n\ninterface PropsFromDispatch {\n  triggeredPlay: typeof triggeredPlay;\n  triggeredPause: typeof triggeredPause;\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\n  updatedRhythm: typeof updatedRhythm;\n  updatedPlaybackSettings: typeof updatedPlaybackSettings;\n  openedDialog: typeof openedDialog;\n}\n\ninterface Props extends WithStyles<typeof popoverStyles> {}\n\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\n\ninterface State {\n  anchorEl: HTMLButtonElement | null;\n  activePopover: PopoverType;\n}\n\nenum PopoverType {\n  RHYTHM,\n  PLAYBACKRATE,\n  DETUNE,\n  STARTMEASURE,\n  NONE\n}\n\nclass StructurePage extends React.Component<AllProps, State> {\n  state: State = {\n    anchorEl: null,\n    activePopover: PopoverType.NONE\n  };\n\n  handlePopoverOpen = (\n    event: React.MouseEvent<HTMLButtonElement> | undefined,\n    type: PopoverType\n  ) => {\n    if (event && event.currentTarget)\n      this.setState({ anchorEl: event.currentTarget, activePopover: type });\n  };\n\n  handlePopoverClose = () => {\n    this.setState({ anchorEl: null, activePopover: PopoverType.NONE });\n  };\n\n  render() {\n    Log.info(\"render\", StructurePage.name);\n    return (\n      <ContentLayout\n        topLeft={\n          <View\n            title=\"Song Overview\"\n            body={<WaveContainer />}\n            action={\n              <>\n                {this.props.isPlaying ? (\n                  <WaveformControlButton\n                    title=\"Pause\"\n                    icon={<PauseIcon />}\n                    onClick={() => this.props.triggeredPause()}\n                  />\n                ) : (\n                  <WaveformControlButton\n                    title=\"Play\"\n                    icon={<PlayArrowIcon />}\n                    onClick={() => this.props.triggeredPlay()}\n                  />\n                )}\n\n                <WaveformControlButton\n                  title=\"Loop\"\n                  icon={<LoopIcon />}\n                  disabled={true}\n                />\n                <WaveformControlButton\n                  title=\"Playback Rate\"\n                  icon={<SpeedIcon />}\n                  onClick={(e) =>\n                    this.handlePopoverOpen(e, PopoverType.PLAYBACKRATE)\n                  }\n                  disabled={false}\n                />\n                <WaveformControlButton\n                  title=\"Detune\"\n                  icon={<MusicNoteIcon />}\n                  onClick={(e) => this.handlePopoverOpen(e, PopoverType.DETUNE)}\n                  disabled={false}\n                />\n                <Popover\n                  className={this.props.classes.popover}\n                  open={this.state.activePopover !== PopoverType.NONE}\n                  anchorEl={this.state.anchorEl}\n                  onClose={() => this.handlePopoverClose()}\n                  anchorOrigin={{\n                    vertical: \"bottom\",\n                    horizontal: \"left\"\n                  }}\n                  anchorPosition={{ top: 50, left: 0 }}\n                  transformOrigin={{\n                    vertical: \"top\",\n                    horizontal: \"center\"\n                  }}\n                >\n                  {this.state.activePopover !== PopoverType.NONE && (\n                    <div className={this.props.classes.content}>\n                      {PopoverContent(this.state.activePopover, this.props)}\n                    </div>\n                  )}\n                </Popover>\n              </>\n            }\n          ></View>\n        }\n        topRight={\n          <View title=\"Song Measures\" body={<StructureNavigationView />}></View>\n        }\n        bottomLeft={\n          <View\n            title=\"Song Sections\"\n            action={\n              <>\n                <WaveformControlButton\n                  title=\"Start Measure 0\"\n                  icon={<BorderLeftIcon />}\n                  onClick={(e) =>\n                    this.handlePopoverOpen(e, PopoverType.STARTMEASURE)\n                  }\n                  disabled={false}\n                />\n                <WaveformControlButton\n                  title=\"Add section\"\n                  icon={<AddIcon />}\n                  onClick={() =>\n                    this.props.openedDialog(DialogType.ADD_SECTION)\n                  }\n                />\n              </>\n            }\n            body={<StructureView />}\n          ></View>\n        }\n        bottomRight={\n          <View title=\"Song Properties\" body={<PropertiesView />}></View>\n        }\n      ></ContentLayout>\n    );\n  }\n}\n\nconst popoverStyles = (theme: Theme) =>\n  createStyles({\n    content: {\n      width: theme.popover.width,\n      minHeight: theme.popover.minHeight,\n      margin: theme.popover.margin,\n      marginTop: theme.popover.marginTop\n    },\n    popover: {\n      height: \"400px\"\n    }\n  });\n\nconst waveformControlButtonStyles = () =>\n  createStyles({\n    root: {\n      marginTop: \"8px\",\n      marginRight: \"5px\"\n    }\n  });\n\ninterface WaveformControlButtonProps {\n  title: string;\n  icon: ReactElement;\n  disabled?: boolean;\n  onClick?: (e?: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n}\n\nconst WaveformControlButton = withStyles(waveformControlButtonStyles)(\n  (\n    props: WaveformControlButtonProps &\n      WithStyles<typeof waveformControlButtonStyles>\n  ) => {\n    const button = (\n      <IconButton\n        className={props.classes.root}\n        onClick={props.onClick}\n        size=\"small\"\n        disabled={props.disabled}\n      >\n        {props.icon}\n      </IconButton>\n    );\n\n    if (props.disabled) return button;\n\n    return <Tooltip title={props.title}>{button}</Tooltip>;\n  }\n);\n\nconst PopoverContent = (type: PopoverType, props: AllProps) => {\n  switch (type) {\n    case PopoverType.DETUNE:\n      return <DetunePopover {...props} />;\n    case PopoverType.PLAYBACKRATE:\n      return <PlaybackRatePopover {...props} />;\n    case PopoverType.STARTMEASURE:\n      return <StartMeasurePopover {...props} />;\n    default:\n      throw Error(\"Popup type undefined: \" + type);\n  }\n};\n\nconst DetunePopover = (props: AllProps) => (\n  <SliderInput\n    title=\"Detune\"\n    value={props.detune}\n    min={-12}\n    max={12}\n    step={0.5}\n    onChange={(e, detune) => {\n      if (!Array.isArray(detune) && detune !== props.detune) {\n        props.updatedPlaybackSettings({ detune: detune });\n      }\n    }}\n  ></SliderInput>\n);\n\nconst startMeasurePopoverStyles = () =>\n  createStyles({\n    toggleButton: {\n      width: \"15px\",\n      height: \"25px\"\n    }\n  });\n\ninterface StartMeasurePopoverProps {\n  firstMeasureStart: number;\n  syncFirstMeasureStart: boolean;\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\n}\n\nconst StartMeasurePopover = withStyles(startMeasurePopoverStyles)(\n  (\n    props: StartMeasurePopoverProps &\n      WithStyles<typeof startMeasurePopoverStyles>\n  ) => (\n    <FormControl fullWidth={true}>\n      <InputLabel>Start Measure 1</InputLabel>\n      <Input\n        type=\"text\"\n        id=\"startMeasure1\"\n        value={props.firstMeasureStart}\n        startAdornment={\n          <InputAdornment position=\"start\">\n            <Tooltip\n              title=\"Toggle sync with mouse click.\n          If enabled, clicking into the waveform will update the start of measure 0 to the selected position.\"\n            >\n              <ToggleButton\n                className={props.classes.toggleButton}\n                value=\"check\"\n                selected={props.syncFirstMeasureStart}\n                onChange={() => {\n                  props.enabledSyncFirstMeasureStart(\n                    !props.syncFirstMeasureStart\n                  );\n                }}\n              >\n                <SyncAltIcon />\n              </ToggleButton>\n            </Tooltip>\n          </InputAdornment>\n        }\n      />\n    </FormControl>\n  )\n);\n\nconst PlaybackRatePopover = (props: AllProps) => (\n  <SliderInput\n    title=\"Playback rate\"\n    value={props.playbackRate}\n    min={0.4}\n    max={1.2}\n    step={0.05}\n    onChange={(e, playbackRate) => {\n      if (!Array.isArray(playbackRate) && playbackRate !== props.playbackRate) {\n        props.updatedPlaybackSettings({ playbackRate: playbackRate });\n      }\n    }}\n  ></SliderInput>\n);\n\nconst mapStateToProps = ({ project, audio, analysis }: ApplicationState) => {\n  return {\n    loaded: project.status === LoadingStatus.INITIALIZED,\n    isPlaying: audio.isPlaying,\n    firstMeasureStart: analysis.firstMeasureStart,\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\n    detune: audio.detune,\n    playbackRate: audio.playbackRate\n  };\n};\n\nconst mapDispatchToProps = {\n  triggeredPlay,\n  triggeredPause,\n  enabledSyncFirstMeasureStart,\n  updatedRhythm,\n  updatedPlaybackSettings,\n  openedDialog\n};\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(popoverStyles, { withTheme: true })(StructurePage));\n","import Log from \"components/log/log\";\nimport { EventEmitterForPlayerEvents, PlayerAdapter, Segment } from \"peaks.js\";\nimport * as Tone from \"tone\";\nimport { PitchShift, Player as TonejsPlayer } from \"tone\";\n\n/**\n * External Tone.js based Player for Peaks.js\n */\nclass AudioPlayer implements PlayerAdapter {\n  player: TonejsPlayer;\n  pitchShift: PitchShift;\n  detune: number;\n  eventEmitter: EventEmitterForPlayerEvents | undefined;\n\n  constructor(\n    private audioBuffer: AudioBuffer,\n    private onSongComplete: () => void\n  ) {\n    this.player = new TonejsPlayer(this.audioBuffer);\n    this.pitchShift = new PitchShift();\n    this.detune = 0;\n\n    this.player.sync();\n    this.player.start();\n\n    this.player.connect(this.pitchShift);\n    this.pitchShift.toDestination();\n  }\n\n  init = (eventEmitter: EventEmitterForPlayerEvents) => {\n    Log.info(\"init\", AudioPlayer.name);\n\n    this.eventEmitter = eventEmitter;\n\n    Tone.Transport.scheduleRepeat(() => {\n      eventEmitter.emit(\"player.timeupdate\", this.getCurrentTime());\n      if (this.getCurrentTime() >= this.getDuration()) {\n        Tone.Transport.stop();\n        this.onSongComplete();\n      }\n    }, 0.25);\n\n    eventEmitter.emit(\"player.canplay\");\n  };\n\n  shiftToSemitones = (shift: number) => 12 * Math.log2(1 / shift);\n\n  setPlaybackRate(playbackRate: number) {\n    this.player.playbackRate = playbackRate;\n\n    // Detune to keep consistent pitch, even if the playback speed changed\n    this.setDetune(this.detune);\n\n    // Adjust playback to new playbackrate\n    if (this.isPlaying()) {\n      this.seek(this.getCurrentTime());\n    }\n  }\n\n  setDetune(detune: number) {\n    this.detune = detune;\n\n    this.pitchShift.pitch =\n      this.shiftToSemitones(this.player.playbackRate) + detune;\n  }\n\n  destroy = () => {\n    Log.info(\"destroy\", AudioPlayer.name);\n\n    this.player.dispose();\n    this.pitchShift.dispose();\n    Tone.Transport.cancel();\n    Tone.Transport.position = 0;\n  };\n\n  play = () => {\n    Tone.Transport.start(\n      Tone.now(),\n      this.getCurrentTime() / this.player.playbackRate\n    );\n    this.eventEmitter?.emit(\n      \"player.play\",\n      this.getCurrentTime() / this.player.playbackRate\n    );\n  };\n\n  playSegment = (segment: Segment) => {\n    Tone.Transport.start(\n      Tone.now(),\n      segment.startTime / this.player.playbackRate\n    );\n    this.eventEmitter?.emit(\n      \"player.play\",\n      this.getCurrentTime() / this.player.playbackRate\n    );\n  };\n\n  pause = () => {\n    Tone.Transport.pause();\n    this.eventEmitter?.emit(\"player.pause\", this.getCurrentTime());\n  };\n\n  isPlaying = () => {\n    return Tone.Transport.state === \"started\";\n  };\n\n  isSeeking = () => {\n    return false;\n  };\n\n  getCurrentTime = () => {\n    return (\n      this.player.toSeconds(Tone.Transport.position) * this.player.playbackRate\n    );\n  };\n\n  getDuration = () => {\n    return this.player.buffer.duration;\n  };\n\n  seek = (time: number) => {\n    const normalizedTime = time / this.player.playbackRate;\n\n    Tone.Transport.seconds = normalizedTime;\n    this.eventEmitter?.emit(\"player.seeked\", this.getCurrentTime());\n    this.eventEmitter?.emit(\"player.timeupdate\", this.getCurrentTime());\n  };\n}\n\nexport default AudioPlayer;\n","import { createAction } from \"@reduxjs/toolkit\";\nimport PersistenceApi from \"api/persistenceApi\";\nimport Log from \"components/log/log\";\nimport Peaks, { PeaksInstance } from \"peaks.js\";\nimport { Action, AnyAction, Dispatch, Middleware, MiddlewareAPI } from \"redux\";\nimport { Measure, Section, updatedRhythm } from \"states/analysis/analysisSlice\";\nimport {\n  toggledLoop,\n  triggeredPause,\n  triggeredPlay,\n  updatedLoopSettings,\n  updatedPlaybackSettings\n} from \"states/audio/audioSlice\";\nimport AudioPlayer from \"states/middleware/audioPlayer\";\nimport PeaksConfig from \"states/middleware/peaksConfig\";\nimport {\n  createdProject,\n  hotReloaded,\n  initializedProject\n} from \"states/project/projectSlice\";\nimport { ApplicationState, NormalizedObjects } from \"states/store\";\nimport * as Tone from \"tone\";\n\nexport const switchAudioFile = createAction<{ url: string }>(\"switchAudioFile\");\nexport const updateWaveform = createAction<{\n  sections: NormalizedObjects<Section>;\n  measures: NormalizedObjects<Measure>;\n}>(\"updateWaveform\");\n\n/**\n * Redux Middleware for handling audio related actions (sync and async).\n *\n * This middleware is basically the glue code between internal app state changes\n * and the major 3rd party libraries Peaks.js (the audio waveform) and Tone.js (the audio player).\n *\n */\nclass AudioMiddleware {\n  peaks: Peaks.PeaksInstance | undefined;\n  player: AudioPlayer | undefined;\n  url: string | undefined;\n\n  private getPeaks: () => PeaksInstance = () => {\n    if (!this.peaks) throw new Error(\"peaks undefined\");\n    return this.peaks;\n  };\n  private getPlayer = () => {\n    if (!this.player) throw new Error(\"player undefined\");\n    return this.player;\n  };\n\n  /**\n   * Redux Middleware function. Intercepts all audio related actions.\n   */\n  createMiddleware: Middleware<Dispatch, ApplicationState> = (dispatch) => (\n    next\n  ) => (action: Action<string>) => {\n    Log.info(\"action \" + action.type, AudioMiddleware.name);\n\n    //Case: Audio file changed and Peaks.js and Tone.js should be initialized\n    if (createdProject.match(action)) {\n      this.initAudioContext(action.payload.project.audioUrl, dispatch);\n\n      return next(action);\n    }\n\n    //Case: Application hot reloaded during development\n    if (hotReloaded.match(action)) {\n      //TODO: support Hot reload for audio files https://github.com/tscz/transcribe/issues/39\n      //this.initAudioContext(dispatch.getState().project.audioUrl, dispatch);\n\n      return next(action);\n    }\n\n    // Case: Play was triggered\n    if (triggeredPlay.match(action)) {\n      this.getPlayer().play();\n      return next(action);\n    }\n\n    // Case: Pause was triggered\n    if (triggeredPause.match(action)) {\n      this.getPlayer().pause();\n      return next(action);\n    }\n\n    // Case: Waveform needs to be updated\n    if (updateWaveform.match(action)) {\n      this.repaintWaveform(action.payload.sections, action.payload.measures);\n\n      return next(action);\n    }\n\n    // Case: playback settings need to be updated\n    if (updatedPlaybackSettings.match(action)) {\n      if (action.payload.playbackRate)\n        this.getPlayer().setPlaybackRate(action.payload.playbackRate);\n\n      if (action.payload.detune)\n        this.getPlayer().setDetune(action.payload.detune);\n\n      return next(action);\n    }\n\n    // Case: Looping needs to be toggled\n    if (toggledLoop.match(action)) {\n      // TODO toggle looping mode (https://github.com/tscz/transcribe/issues/11)\n\n      return next(action);\n    }\n\n    // Case: Looping settings should be updated\n    if (updatedLoopSettings.match(action)) {\n      const start = action.payload.start ?? dispatch.getState().audio.loopStart;\n      const end = action.payload.end ?? dispatch.getState().audio.loopEnd;\n\n      this.getPlayer().seek(start);\n      this.setZoom(start, end);\n\n      return next(action);\n    }\n\n    // Case: given action does not trigger audio related side effects\n    return next(action);\n  };\n\n  private cleanupPreviousInit() {\n    try {\n      const peaks = this.getPeaks();\n      peaks.destroy();\n    } catch {}\n    try {\n      const player = this.getPlayer();\n      player.destroy();\n    } catch {}\n    if (this.url) PersistenceApi.revokeLocalFile(this.url);\n  }\n\n  private initAudioContext(\n    url: string,\n    dispatch: MiddlewareAPI<Dispatch<AnyAction>, ApplicationState>\n  ) {\n    this.cleanupPreviousInit();\n\n    // Read local audio file url into an audiobuffer\n    this.url = url;\n\n    Log.info(\n      \"start fetch audio file into audiobuffer from \" + this.url,\n      AudioMiddleware.name\n    );\n    fetch(this.url)\n      .then((response) => response.arrayBuffer())\n      .then((buffer) => Tone.context.decodeAudioData(buffer))\n      .then((audioBuffer) => {\n        Log.info(\"audiobuffer loaded from \" + this.url, AudioMiddleware.name);\n        initTonejsAndPeaksjs(audioBuffer);\n      });\n\n    const initTonejsAndPeaksjs = (audioBuffer: AudioBuffer) => {\n      Log.info(\"init peaks start\", AudioMiddleware.name);\n\n      this.player = new AudioPlayer(audioBuffer, () => {});\n\n      Peaks.init(PeaksConfig.create(audioBuffer, this.player), (err, peaks) => {\n        if (err) throw err;\n        if (!peaks)\n          throw new Error(\"Peaks instance is not correctly initialized.\");\n\n        Log.info(\"init peaks end\", AudioMiddleware.name);\n\n        peaks.on(\"player.seeked\", (time: number) => {\n          if (dispatch.getState().project.syncFirstMeasureStart)\n            dispatch.dispatch(updatedRhythm({ firstMeasureStart: time }));\n        });\n\n        this.peaks = peaks;\n\n        dispatch.dispatch(initializedProject());\n        dispatch.dispatch(updatedRhythm({ duration: audioBuffer.duration }));\n      });\n    };\n  }\n\n  private repaintWaveform(\n    sections: NormalizedObjects<Section>,\n    measures: NormalizedObjects<Measure>\n  ) {\n    const timePerMeasure = this.computeSecondsPerMeasure(measures);\n\n    this.peaks?.segments.removeAll();\n    this.peaks?.segments.add(\n      PeaksConfig.sectionsToSegment(sections, measures, timePerMeasure)\n    );\n    this.peaks?.points.removeAll();\n    this.peaks?.points.add(PeaksConfig.measuresToPoints(measures));\n  }\n\n  private computeSecondsPerMeasure = (measures: NormalizedObjects<Measure>) => {\n    if (!measures || !measures.byId[\"1\"] || !measures.byId[\"0\"]) return 0;\n    return measures.byId[\"1\"].time - measures.byId[\"0\"].time;\n  };\n\n  private setZoom(start: number, end: number) {\n    const zoomview:\n      | Peaks.WaveformView\n      | null\n      | undefined = this.peaks?.views.getView(\"zoomview\");\n\n    if (!zoomview)\n      throw new Error(\"could not set zoom. zoomview does not exist\");\n\n    const duration = end - start;\n    zoomview.setZoom({ seconds: duration });\n    zoomview.setStartTime(start);\n  }\n}\n\nexport default AudioMiddleware;\n","import { createStyles, WithStyles, withStyles } from \"@material-ui/core\";\nimport Log from \"components/log/log\";\nimport React, { Component } from \"react\";\nimport {\n  OVERVIEW_CONTAINER,\n  ZOOMVIEW_CONTAINER\n} from \"states/middleware/peaksConfig\";\n\nconst styles = () =>\n  createStyles({\n    zoomview: {\n      maxHeight: \"400px\"\n    },\n    overview: {\n      marginTop: \"30px\",\n      height: \"50px\"\n    }\n  });\n\nclass WaveView extends Component<WithStyles<typeof styles>> {\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  render() {\n    Log.info(\"render\", WaveView.name);\n    return (\n      <div>\n        <div id=\"waveform-container\">\n          <div\n            id={ZOOMVIEW_CONTAINER}\n            className={this.props.classes.zoomview}\n          ></div>\n          <div\n            id={OVERVIEW_CONTAINER}\n            className={this.props.classes.overview}\n          ></div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withStyles(styles, { withTheme: true })(WaveView);\n","import CircularProgress from \"@material-ui/core/CircularProgress\";\nimport Log from \"components/log/log\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Measure, Section } from \"states/analysis/analysisSlice\";\nimport { updateWaveform } from \"states/middleware/audioMiddleware\";\nimport { hotReloaded, LoadingStatus } from \"states/project/projectSlice\";\nimport { ApplicationState, NormalizedObjects } from \"states/store\";\n\nimport WaveView from \"./waveView\";\n\ninterface PropsFromState {\n  status: LoadingStatus;\n  sections: NormalizedObjects<Section>;\n  measures: NormalizedObjects<Measure>;\n  audioUrl: string;\n}\n\ninterface PropsFromDispatch {\n  hotReloaded: typeof hotReloaded;\n  updateWaveform: typeof updateWaveform;\n}\n\ninterface Props {}\n\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\n\nclass WaveContainer extends Component<AllProps> {\n  constructor(props: AllProps) {\n    super(props);\n\n    if (process.env.NODE_ENV !== \"production\" && props.audioUrl) {\n      Log.info(\"Hot reload with url=\" + props.audioUrl, WaveContainer.name);\n      this.props.hotReloaded();\n    }\n  }\n\n  componentDidUpdate(prevProps: AllProps) {\n    if (\n      prevProps.sections !== this.props.sections ||\n      prevProps.measures !== this.props.measures\n    ) {\n      this.props.updateWaveform({\n        sections: this.props.sections,\n        measures: this.props.measures\n      });\n    }\n  }\n\n  render() {\n    Log.info(\"render\", WaveContainer.name);\n\n    return (\n      <div>\n        {this.props.status !== LoadingStatus.INITIALIZED && (\n          <CircularProgress />\n        )}\n        <WaveView />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ project, analysis }: ApplicationState) => {\n  return {\n    status: project.status,\n    sections: analysis.sections,\n    measures: analysis.measures,\n    audioUrl: project.audioUrl\n  };\n};\n\nconst mapDispatchToProps = {\n  hotReloaded,\n  updateWaveform: updateWaveform\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveContainer);\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z\"\n});\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z\"\n});\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z\"\n});\n\nvar _ref6 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z\"\n});\n\nvar _ref7 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z\"\n});\n\nvar _ref8 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z\"\n});\n\nvar _ref9 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z\"\n});\n\nvar _ref10 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z\"\n});\n\nvar _ref11 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z\"\n});\n\nvar _ref12 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref13 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref14 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref15 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref16 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref17 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref18 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref19 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref20 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref21 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref22 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref23 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref24 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref25 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref26 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z \"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z\"\n  }), /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    d: \"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z\"\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 201.212,\n    cy: 201.242,\n    r: 22.708\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 331.22,\n    cy: 201.242,\n    r: 22.708\n  })), /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z\"\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#C9BCB8\"\n    },\n    d: \"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16, _ref17, _ref18, _ref19, _ref20, _ref21, _ref22, _ref23, _ref24, _ref25, _ref26);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dd187a77.svg\";\nexport { ForwardRef as ReactComponent };","import {\n  createStyles,\n  InputBase,\n  Theme,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Paper from \"@material-ui/core/Paper\";\nimport MenuIcon from \"@material-ui/icons/OpenInBrowser\";\nimport PersistenceApi from \"api/persistenceApi\";\nimport React from \"react\";\n\nexport enum FileType {\n  AUDIO = \"audio/*\",\n  ZIP = \".zip\"\n}\n\nconst toString = (type: FileType) => {\n  switch (type) {\n    case FileType.AUDIO:\n      return \"Audio File\";\n    case FileType.ZIP:\n      return \"Project Zip File\";\n  }\n};\n\ninterface Props extends WithStyles<typeof stylesForFileInput> {\n  id: string;\n  fileType: FileType;\n  callback: (file: File, fileUrl: string) => void;\n}\n\ninterface State {\n  display: string;\n}\n\nconst stylesForFileInput = (theme: Theme) =>\n  createStyles({\n    root: {\n      padding: \"4px 0px\",\n      display: \"flex\",\n      alignItems: \"center\",\n      width: \"100%\"\n    },\n    input: {\n      marginLeft: theme.spacing(1),\n      flex: 1\n    },\n    iconButton: {\n      padding: 10\n    }\n  });\n\nclass FileInput extends React.Component<Props, State> {\n  state: State = {\n    display: \"\"\n  };\n\n  fileInput: React.RefObject<HTMLInputElement>;\n\n  constructor(props: Props) {\n    super(props);\n    this.fileInput = React.createRef();\n  }\n\n  handleChange = (fileList: FileList | null) => {\n    if (fileList === null) return;\n\n    const file = fileList[0];\n    const fileURL = PersistenceApi.getLocalFileUrl(file);\n\n    this.setState({ display: file.name });\n    this.props.callback(file, fileURL);\n  };\n\n  render() {\n    return (\n      <>\n        <Paper component=\"form\" className={this.props.classes.root}>\n          <InputBase\n            className={this.props.classes.input}\n            placeholder={\"Choose \" + toString(this.props.fileType) + \" ...\"}\n            inputProps={{\n              \"aria-label\": \"Choose \" + toString(this.props.fileType)\n            }}\n            value={this.state.display}\n            readOnly={true}\n            onClick={() => this.fileInput.current?.click()}\n          />\n          <IconButton\n            aria-label=\"menu\"\n            onClick={() => this.fileInput.current?.click()}\n            className={this.props.classes.iconButton}\n          >\n            <MenuIcon />{\" \"}\n          </IconButton>\n        </Paper>\n        <input\n          hidden={true}\n          id={this.props.id}\n          type=\"file\"\n          accept={this.props.fileType}\n          ref={this.fileInput}\n          onChange={(e) => this.handleChange(e.target.files)}\n        ></input>\n      </>\n    );\n  }\n}\n\nexport default withStyles(stylesForFileInput, { withTheme: true })(FileInput);\n","import { createStyles, Grid, Theme } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Button from \"@material-ui/core/Button\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { WithStyles, withStyles } from \"@material-ui/core/styles\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport MusicVideoIcon from \"@material-ui/icons/MusicVideo\";\nimport PrintIcon from \"@material-ui/icons/Print\";\nimport RadioIcon from \"@material-ui/icons/Radio\";\nimport Log from \"components/log/log\";\nimport Toggle from \"components/toggle/toggle\";\nimport VersionInfo from \"components/versionInfo/versionInfo\";\nimport DefaultPage from \"pages/default/defaultPage\";\nimport DrumPage from \"pages/drum/drumPage\";\nimport GuitarPage from \"pages/guitar/guitarPage\";\nimport HarmonyPage from \"pages/harmony/harmonyPage\";\nimport PrintPage from \"pages/print/printPage\";\nimport StructurePage from \"pages/structure/structurePage\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { DialogType, openedDialog } from \"states/dialog/dialogsSlice\";\nimport { LoadingStatus, Page, switchedPage } from \"states/project/projectSlice\";\nimport { ApplicationState } from \"states/store\";\n\nimport { ReactComponent as Logo } from \"./logo.svg\";\n\ninterface PropsFromState {\n  currentPage: Page;\n  status: LoadingStatus;\n  title: string;\n}\n\ninterface PropsFromDispatch {\n  switchedPage: typeof switchedPage;\n  openedDialog: typeof openedDialog;\n}\n\ninterface Props extends WithStyles<typeof stylesForApp> {\n  theme: Theme;\n}\n\ntype AllProps = Props & PropsFromState & PropsFromDispatch;\n\nclass App extends React.Component<AllProps> {\n  render() {\n    Log.info(\"render\", App.name);\n    return (\n      <>\n        <div className={this.props.classes.root}>\n          <AppBar color=\"inherit\" className={this.props.classes.appBar}>\n            <Toolbar>\n              <Logo className={this.props.classes.logo}></Logo>\n              <Typography color=\"textPrimary\" variant=\"h4\" noWrap>\n                Transcribe\n              </Typography>\n              <Typography\n                color=\"textPrimary\"\n                variant=\"caption\"\n                noWrap\n                className={this.props.classes.title}\n              >\n                [{this.props.title !== \"\" ? this.props.title : \"no file loaded\"}\n                ]\n              </Typography>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.NEW)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                New\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.OPEN)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                Open\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.SAVE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                Save\n              </Button>\n            </Toolbar>\n          </AppBar>\n          <Drawer\n            className={this.props.classes.drawer}\n            variant=\"permanent\"\n            classes={{\n              paper: this.props.classes.drawerPaper\n            }}\n          >\n            <div className={this.props.classes.toolbar} />\n            <List className={this.props.classes.menuItem}>\n              <ListItem\n                button\n                key=\"Structure\"\n                onClick={() => this.props.switchedPage(Page.STRUCTURE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon>\n                  <HomeIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Structure\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Harmony\"\n                onClick={() => this.props.switchedPage(Page.HARMONY)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon>\n                  <MusicVideoIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Harmony\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Guitar\"\n                onClick={() => this.props.switchedPage(Page.GUITAR)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon>\n                  <RadioIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Guitar\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Drum\"\n                onClick={() => this.props.switchedPage(Page.DRUM)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon>\n                  <AlbumIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Drum\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Print\"\n                onClick={() => this.props.switchedPage(Page.PRINT)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon>\n                  <PrintIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Print\" />\n              </ListItem>\n            </List>\n          </Drawer>\n          <main className={this.props.classes.content}>\n            <div className={this.props.classes.toolbar} />\n            <Toggle show={this.props.currentPage === Page.DEFAULT}>\n              <DefaultPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.STRUCTURE}>\n              <StructurePage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.HARMONY}>\n              <HarmonyPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.GUITAR}>\n              <GuitarPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.DRUM}>\n              <DrumPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.PRINT}>\n              <PrintPage />\n            </Toggle>\n            <Grid\n              container\n              direction=\"column\"\n              justify=\"flex-end\"\n              alignItems=\"flex-end\"\n              className={this.props.classes.footer}\n            >\n              <Grid item>\n                App version:{\" \"}\n                <VersionInfo\n                  version={process.env.REACT_APP_VERSION ?? \"\"}\n                  hash={process.env.REACT_APP_VERSION_HASH ?? \"\"}\n                  description={process.env.REACT_APP_VERSION_DESCRIPTION ?? \"\"}\n                />\n              </Grid>\n            </Grid>\n          </main>\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = ({ project }: ApplicationState) => {\n  return {\n    currentPage: project.currentPage,\n    status: project.status,\n    title: project.title\n  };\n};\n\nconst mapDispatchToProps = {\n  switchedPage,\n  openedDialog\n};\n\nconst drawerWidth = 190;\n\nexport const stylesForApp = (theme: Theme) =>\n  createStyles({\n    root: {\n      display: \"flex\",\n      backgroundColor: theme.palette.background.default\n    },\n    drawer: {\n      width: drawerWidth,\n      flexShrink: 0\n    },\n    drawerPaper: {\n      width: drawerWidth,\n      backgroundColor: \"#202a2f\"\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(3)\n    },\n    title: {\n      flexGrow: 1,\n      marginLeft: \"50px\"\n    },\n    toolbar: {\n      ...theme.mixins.toolbar\n    },\n    menuItem: {\n      color: \"#abb1b7\"\n    },\n    logo: {\n      height: theme.logo.height,\n      marginRight: theme.logo.marginRight\n    },\n    footer: {\n      marginTop: \"20px\"\n    },\n    appBar: {\n      zIndex: theme.zIndex.drawer + 1\n    }\n  });\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(stylesForApp, { withTheme: true })(App));\n","import {\n  DialogActions,\n  DialogContent,\n  DialogContentText\n} from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport React, { Component } from \"react\";\n\nexport interface DialogAction {\n  label: string;\n  onClick: () => void;\n  disabled?: boolean;\n}\n\ninterface ModalDialogProps {\n  title: string;\n  subTitle?: string;\n  onCancel: () => void;\n  actions?: DialogAction[];\n}\n\nclass ModalDialog extends Component<ModalDialogProps> {\n  render() {\n    return (\n      <Dialog\n        onClose={this.props.onCancel}\n        open={true}\n        fullWidth={true}\n        maxWidth={\"sm\"}\n      >\n        <DialogTitle>{this.props.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText>{this.props.subTitle}</DialogContentText>\n          {this.props.children}\n        </DialogContent>\n        <DialogActions>\n          {this.props.actions?.map((value) => (\n            <Button\n              key={value.label}\n              onClick={value.onClick}\n              color=\"primary\"\n              disabled={value.disabled ?? false}\n            >\n              {value.label}\n            </Button>\n          ))}\n        </DialogActions>\n      </Dialog>\n    );\n  }\n}\n\nexport default ModalDialog;\n","import { configureStore, createAction } from \"@reduxjs/toolkit\";\nimport { AnyAction, combineReducers, Reducer } from \"redux\";\n\nimport analysisReducer, { AnalysisState } from \"./analysis/analysisSlice\";\nimport audioReducer, { AudioState } from \"./audio/audioSlice\";\nimport dialogReducer, { DialogState } from \"./dialog/dialogsSlice\";\nimport AudioMiddleware from \"./middleware/audioMiddleware\";\nimport projectReducer, { ProjectState } from \"./project/projectSlice\";\n\n/** The top-level application state object. */\nexport interface ApplicationState {\n  analysis: AnalysisState;\n  audio: AudioState;\n  dialog: DialogState;\n  project: ProjectState;\n}\n\nexport interface PersistedState {\n  analysis: AnalysisState;\n  project: ProjectState;\n}\n\nexport interface NormalizedObjects<T> {\n  byId: { [id: string]: T };\n  allIds: string[];\n}\n\nexport const restoredPersistedState = createAction<PersistedState>(\n  \"restoredPersistedState\"\n);\n\nexport const sliceReducer = combineReducers({\n  analysis: analysisReducer,\n  audio: audioReducer,\n  dialog: dialogReducer,\n  project: projectReducer\n});\n\nexport const createRootReducer: Reducer<ApplicationState, AnyAction> = (\n  state,\n  action\n) => {\n  state = sliceReducer(state, action);\n\n  if (restoredPersistedState.match(action)) {\n    return state;\n  }\n\n  return state;\n};\n\nconst createAppStore = () => {\n  const store = configureStore({\n    reducer: createRootReducer,\n    preloadedState: undefined,\n    middleware: [new AudioMiddleware().createMiddleware]\n  });\n\n  if (process.env.NODE_ENV !== \"production\" && module.hot) {\n    module.hot.accept(\"./store\", () => store.replaceReducer(createRootReducer));\n  }\n  return store;\n};\n\nexport default createAppStore();\n","import {\n  createStyles,\n  FormLabel,\n  Theme,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport TextField from \"@material-ui/core/TextField\";\nimport PersistenceApi from \"api/persistenceApi\";\nimport FileInput, { FileType } from \"components/fileInput/fileInput\";\nimport MeasureSelect from \"components/measureSelect/measureSelect\";\nimport ModalDialog, { DialogAction } from \"components/modalDialog/modalDialog\";\nimport SectionSelect from \"components/sectionSelect/sectionSelect\";\nimport React, { Component, FunctionComponent, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  addedSection,\n  initialAnalysisState,\n  SectionType\n} from \"states/analysis/analysisSlice\";\nimport { closedDialog, DialogType } from \"states/dialog/dialogsSlice\";\nimport { switchAudioFile } from \"states/middleware/audioMiddleware\";\nimport {\n  createdProject,\n  initialProjectState,\n  Page,\n  switchedPage\n} from \"states/project/projectSlice\";\nimport store, { ApplicationState } from \"states/store\";\nimport ArrayUtil from \"util/ArrayUtil\";\n\ninterface PropsFromState {\n  type: DialogType;\n  audioUrl: string;\n  maxMeasure: number;\n}\n\ninterface PropsFromDispatch {\n  switchedPage: typeof switchedPage;\n  closedDialog: typeof closedDialog;\n  createdProject: typeof createdProject;\n  addedSection: typeof addedSection;\n  switchAudioFile: typeof switchAudioFile;\n}\n\ntype AllProps = PropsFromState & PropsFromDispatch;\n\nclass DialogManagement extends Component<AllProps> {\n  render() {\n    switch (this.props.type) {\n      case DialogType.NONE:\n        return null;\n      case DialogType.NEW:\n        return (\n          <NewDialog\n            onCancel={() => this.props.closedDialog()}\n            onSubmit={(title: string, audioUrl: string) => {\n              this.props.createdProject({\n                analysis: initialAnalysisState,\n                project: { ...initialProjectState, audioUrl, title }\n              });\n              this.props.switchedPage(Page.STRUCTURE);\n              this.props.closedDialog();\n            }}\n          ></NewDialog>\n        );\n      case DialogType.OPEN:\n        return (\n          <OpenDialog\n            onCancel={() => this.props.closedDialog()}\n            onSubmit={(zip: File, zipUrl: string) => {\n              PersistenceApi.open(zip).then(({ audioBlob, state }) => {\n                const audioUrl = PersistenceApi.getLocalFileUrl(audioBlob);\n                PersistenceApi.revokeLocalFile(zipUrl);\n\n                this.props.createdProject({\n                  analysis: state.analysis,\n                  project: { ...state.project, audioUrl }\n                });\n                this.props.switchedPage(Page.STRUCTURE);\n                this.props.closedDialog();\n              });\n            }}\n          ></OpenDialog>\n        );\n      case DialogType.SAVE:\n        return (\n          <ModalDialog\n            title=\"Save Transcription\"\n            subTitle=\"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.\"\n            onCancel={() => this.props.closedDialog()}\n            actions={[\n              {\n                label: \"Cancel\",\n                onClick: () => this.props.closedDialog()\n              },\n              {\n                label: \"Save\",\n                onClick: () => {\n                  PersistenceApi.save(\"transcription.zip\", {\n                    audioFileUrl: this.props.audioUrl,\n                    state: store.getState()\n                  });\n                  this.props.closedDialog();\n                }\n              }\n            ]}\n          ></ModalDialog>\n        );\n      case DialogType.ADD_SECTION:\n        return (\n          <AddSectionDialog\n            maxMeasure={this.props.maxMeasure}\n            onCancel={() => this.props.closedDialog()}\n            onSubmit={(sectionType, start, end) => {\n              this.props.addedSection({\n                measures: ArrayUtil.range(start, end),\n                type: sectionType\n              });\n              this.props.closedDialog();\n            }}\n          ></AddSectionDialog>\n        );\n      default:\n        throw Error();\n    }\n  }\n}\n\nconst NewDialog: FunctionComponent<{\n  onSubmit: (title: string, fileUrl: string) => void;\n  onCancel: () => void;\n}> = (props) => {\n  const [fileUrl, setFileUrl] = useState(\"\");\n  const [title, setTitle] = useState(\"\");\n  const actions: () => DialogAction[] = () => {\n    return [\n      {\n        label: \"Cancel\",\n        onClick: () => props.onCancel()\n      },\n      {\n        label: \"Create\",\n        onClick: () => props.onSubmit(title, fileUrl),\n        disabled: fileUrl === \"\" || title === \"\"\n      }\n    ];\n  };\n\n  const handleTitleChange = (event: React.ChangeEvent<HTMLInputElement>) =>\n    setTitle(event.target.value);\n\n  return (\n    <ModalDialog\n      title=\"Create new Transcription\"\n      subTitle=\"Please add a project title and select an audio file from your hard disk below.\"\n      actions={actions()}\n      onCancel={props.onCancel}\n    >\n      <FormControl fullWidth>\n        <TextField\n          id=\"title\"\n          label=\"Project title\"\n          margin=\"normal\"\n          InputProps={{\n            readOnly: false\n          }}\n          variant=\"outlined\"\n          onChange={handleTitleChange}\n        />\n        <FileInput\n          fileType={FileType.AUDIO}\n          id=\"audio_file\"\n          callback={(file, fileUrl) => {\n            setFileUrl(fileUrl);\n          }}\n        ></FileInput>\n      </FormControl>\n    </ModalDialog>\n  );\n};\n\nconst OpenDialog: FunctionComponent<{\n  onSubmit: (file: File, fileUrl: string) => void;\n  onCancel: () => void;\n}> = (props) => {\n  const [fileUrl, setFileUrl] = useState(\"\");\n  const [file, setFile] = useState<File>();\n  const actions: () => DialogAction[] = () => {\n    return [\n      {\n        label: \"Cancel\",\n        onClick: () => props.onCancel()\n      },\n      {\n        label: \"Open\",\n        onClick: () => {\n          if (!file) throw Error(\"file undefined\");\n\n          props.onSubmit(file, fileUrl);\n        },\n        disabled: fileUrl === \"\"\n      }\n    ];\n  };\n\n  return (\n    <ModalDialog\n      title=\"Open Transcription\"\n      subTitle=\"Please select a project zip file from your hard disk below.\"\n      onCancel={props.onCancel}\n      actions={actions()}\n    >\n      <FormControl fullWidth>\n        <FileInput\n          fileType={FileType.ZIP}\n          id=\"zip_file\"\n          callback={(file, fileUrl) => {\n            setFileUrl(fileUrl);\n            setFile(file);\n          }}\n        ></FileInput>\n      </FormControl>\n    </ModalDialog>\n  );\n};\n\nconst addSectionDialogStyles = (theme: Theme) =>\n  createStyles({\n    formControl: {\n      marginBottom: theme.formControl.marginBottom\n    }\n  });\n\ninterface AddSectionDialogProps\n  extends WithStyles<typeof addSectionDialogStyles> {\n  maxMeasure: number;\n  onSubmit: (sectionType: SectionType, start: number, end: number) => void;\n  onCancel: () => void;\n}\n\nconst AddSectionDialog = withStyles(addSectionDialogStyles)(\n  (props: AddSectionDialogProps) => {\n    const [sectionType, setSectionType] = useState(SectionType.INTRO);\n    const [start, setStart] = useState(0);\n    const [end, setEnd] = useState(0);\n    const actions: () => DialogAction[] = () => {\n      return [\n        {\n          label: \"Cancel\",\n          onClick: () => props.onCancel()\n        },\n        {\n          label: \"Add\",\n          onClick: () => props.onSubmit(sectionType, start, end),\n          disabled: sectionType === SectionType.UNDEFINED || start > end\n        }\n      ];\n    };\n\n    return (\n      <ModalDialog\n        title=\"Add new Section\"\n        subTitle=\"Please define section and add it to the song structure.\"\n        actions={actions()}\n        onCancel={props.onCancel}\n      >\n        <FormControl fullWidth className={props.classes.formControl}>\n          <FormLabel component=\"legend\">Section Type</FormLabel>\n          <SectionSelect\n            value={sectionType}\n            onChange={(sectionType) => setSectionType(sectionType)}\n          ></SectionSelect>\n        </FormControl>\n        <FormControl fullWidth className={props.classes.formControl}>\n          <FormLabel component=\"legend\">First Measure</FormLabel>\n          <MeasureSelect\n            value={start}\n            min={0}\n            max={props.maxMeasure}\n            onChange={(value) => setStart(value)}\n          />\n        </FormControl>\n        <FormControl fullWidth className={props.classes.formControl}>\n          <FormLabel component=\"legend\">Last Measure</FormLabel>\n          <MeasureSelect\n            value={end}\n            min={0}\n            max={props.maxMeasure}\n            onChange={(value) => setEnd(value)}\n          />\n        </FormControl>\n      </ModalDialog>\n    );\n  }\n);\n\nconst mapStateToProps = ({ dialog, project, analysis }: ApplicationState) => {\n  return {\n    type: dialog.currentDialog,\n    audioUrl: project.audioUrl,\n    maxMeasure: analysis.measures.allIds.length - 1\n  };\n};\n\nconst mapDispatchToProps = {\n  closedDialog,\n  switchedPage,\n  createdProject,\n  addedSection,\n  switchAudioFile: switchAudioFile\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogManagement);\n","import \"typeface-roboto\";\n\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport React from \"react\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { AUDIO_DOM_ELEMENT } from \"states/middleware/peaksConfig\";\n\nimport App from \"./components/app/app\";\nimport DialogManagement from \"./components/dialogManagement/dialogManagement\";\nimport store from \"./states/store\";\nimport theme from \"./styles/theme\";\n\nconst renderApp = () =>\n  render(\n    <Provider store={store}>\n      <ThemeProvider theme={theme}>\n        <CssBaseline />\n        <MediaElement />\n        <DialogManagement />\n        <App />\n      </ThemeProvider>\n    </Provider>,\n    document.getElementById(\"root\")\n  );\n\n/** Enable logger in dev mode */\nif (process.env.NODE_ENV !== \"production\") {\n  localStorage.setItem(\"debug\", \"transcribe:*\");\n}\n\n/** Enable hot reload while development */\nif (process.env.NODE_ENV !== \"production\" && module.hot) {\n  module.hot.accept(\"./components/app/app\", renderApp);\n}\n\nconst MediaElement = () => {\n  return (\n    <audio id={AUDIO_DOM_ELEMENT} controls hidden>\n      Your browser does not support the audio element.\n    </audio>\n  );\n};\n\nrenderApp();\n"],"sourceRoot":""}