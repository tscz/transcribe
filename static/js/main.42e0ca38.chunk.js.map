{"version":3,"sources":["components/log/log.ts","components/view/view.tsx","pages/default/defaultPage.tsx","pages/drum/drumPage.tsx","pages/guitar/guitarPage.tsx","pages/harmony/harmonyPage.tsx","pages/print/printPage.tsx","components/contentLayout/contentLayout.tsx","components/sliderInput/sliderInput.tsx","util/ArrayUtil.ts","states/project/projectSlice.ts","states/analysis/analysisSlice.ts","states/analysis/analysisUtil.ts","states/dialog/dialogsSlice.ts","states/audio/audioSlice.ts","components/measureSelect/measureSelect.tsx","components/audioManagement/peaksConfig.ts","pages/structure/structurePage.tsx","components/sectionSelect/sectionSelect.tsx","views/structure/structureView.tsx","components/sectionOverview/sectionOverview.tsx","views/structureNavigation/structureNavigationView.tsx","views/wave/waveView.tsx","views/wave/waveContainer.tsx","components/versionInfo/versionInfo.tsx","components/app/logo.svg","components/app/app.tsx","styles/styles.ts","api/persistenceApi.ts","components/fileInput/fileInput.tsx","components/audioManagement/audioPlayer.ts","components/audioManagement/audioManagement.tsx","states/store.ts","components/modalDialog/modalDialog.tsx","components/dialogManagement/dialogManagement.tsx","styles/theme.ts","index.tsx"],"names":["Level","View","Card","style","height","backgroundColor","raised","CardHeader","titleTypographyProps","variant","title","this","props","padding","action","CardContent","body","Component","DefaultPage","React","DrumPage","GuitarPage","HarmonyPage","PrintPage","ContentLayout","Grid","container","spacing","alignItems","item","xs","topLeft","topRight","bottom","LEVEL_TO_COLOR","Map","TRACE","INFO","WARN","ERROR","Log","level","message","source","namespace","createDebug","debug","color","get","generateMessage","SliderInput","FormControl","width","InputLabel","shrink","Box","mt","Slider","value","valueLabelDisplay","min","max","onChange","step","ArrayUtil","range","start","end","Array","fill","map","_","idx","toString","bordersOf","array","parseInt","last","length","LoadingStatus","Page","TimeSignatureType","SectionType","initialProjectState","status","NOT_INITIALIZED","currentPage","DEFAULT","audioUrl","syncFirstMeasureStart","projectSlice","createSlice","name","initialState","reducers","switchedPage","state","payload","createdProject","project","INITIALIZING","hotReloaded","initializedProject","INITIALIZED","enabledSyncFirstMeasureStart","actions","toTimeSignatureType","type","FOUR_FOUR","THREE_FOUR","Error","replaceSections","sections","deleteCount","newSections","section","byId","allIds","ids","forEach","id","generateSectionId","push","splice","measures","distributeMeasures","timeSignatureType","bpm","firstMeasureStart","lengthOfOneMeasure","beatUnit","beatsPerMeasure","toTimeSignature","index","time","editable","labelText","DialogType","initialAnalysisState","audioDuration","audioSampleRate","timeSignature","analysisSlice","extraReducers","builder","addCase","analysis","undefinedSectionId","UNDEFINED","undefinedSection","addedSection","addSection","updatedSection","removeSection","before","after","removedSection","updatedRhythm","lastSection","undefined","newLastSection","removeSectionsAfterLastMeasure","lastMeasure","removalStart","removalStartMeasure","newSection","enclosingSection","allSections","newSectionStart","newSectionEnd","sectionCount","current","currentSectionEnd","position","enclosingSectionOf","mergedSections","embeddedSection","currentSectionStart","mergeSections","sectionId","indexOf","firstMeasure","removalCount","audioSlice","isPlaying","detune","playbackRate","isLooping","loopStart","loopEnd","triggeredPlay","triggeredPause","updatedPlaybackSettings","toggledLoop","updatedLoopSettings","initialDialogState","currentDialog","NONE","dialogsSlice","openedDialog","closedDialog","MeasureSelect","event","newMeasure","target","minWidth","disabled","MenuItem","key","PeaksConfig","create","audioBuffer","mediaelement","document","getElementById","containers","zoomview","overview","mediaElement","webAudio","scale","multiChannel","keyboard","pointMarkerColor","showPlayheadTime","zoomLevels","sectionsToSegment","timePerMeasure","segments","segment","startTime","endTime","SECTIONTYPE_TO_COLOR","measuresToPoints","points","point","INTRO","VERSE","PRECHORUS","CHORUS","SOLO","OUTRO","BRIDGE","PopoverType","SectionSelect","Object","values","sectionType","StructureView","handleAddSection","handleUpdatedSection","info","JSON","stringify","handleRemoveSection","TableContainer","component","Paper","Table","size","TableHead","TableRow","TableCell","TableBody","scope","IconButton","onClick","measuresCount","measure","mapDispatchToProps","connect","SectionOverview","direction","Typography","toLowerCase","marginBottom","arr","res","i","slice","generateMatrix","row","ButtonGroup","orientation","measureId","nextMeasure","Number","bg","Square","Button","StructureNavigationView","WaveView","nextProps","url","WaveContainer","audioLoaded","CircularProgress","StructurePage","anchorEl","activePopover","handlePopoverOpen","setState","currentTarget","handlePopoverClose","icon","e","RHYTHM","PLAYBACKRATE","DETUNE","Popover","open","onClose","anchorOrigin","vertical","horizontal","anchorPosition","top","left","transformOrigin","minHeight","margin","marginTop","PopoverContent","STARTMEASURE","ADD_SECTION","WaveformControlButton","button","marginRight","Tooltip","RhythmPopover","isArray","fullWidth","NativeSelect","DetunePopover","StartMeasurePopover","Input","startAdornment","InputAdornment","ToggleButton","selected","PlaybackRatePopover","audio","loaded","VersionInfo","version","href","hash","description","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","d","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref17","_ref18","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","_ref25","_ref26","_ref","svgRef","x","y","viewBox","enableBackground","xmlSpace","ref","cx","cy","r","ForwardRef","forwardRef","App","className","classes","root","AppBar","appBar","Toolbar","noWrap","NEW","OPEN","SAVE","Drawer","drawer","paper","drawerPaper","toolbar","List","ListItem","STRUCTURE","ListItemIcon","ListItemText","primary","HARMONY","GUITAR","DRUM","PRINT","content","show","justify","process","Toggle","display","children","withStyles","theme","createStyles","zIndex","flexShrink","flexGrow","marginLeft","mixins","withTheme","PersistenceApi","zip","JSZip","loadAsync","archive","file","songFile","async","audioBlob","stateFile","json","parse","window","URL","revokeObjectURL","blob","createObjectURL","save","filename","options","a","fetch","audioFileUrl","response","generateAsync","then","saveAs","FileType","AudioPlayer","peaks","onSongComplete","player","pitchShift","shiftToSemitones","shift","Math","log2","destroy","Tone","context","dispose","setContext","AudioContext","play","Transport","now","getCurrentTime","emit","pause","isSeeking","buffer","toSeconds","getDuration","duration","seek","normalizedTime","seconds","Player","sync","PitchShift","connectSeries","Master","scheduleRepeat","stop","setDetune","pitch","AudioManagement","getPeaks","getPlayer","init","audioCtx","arrayBuffer","decodeAudioData","initPeaks","prevProps","revokeLocalFile","repaintWaveform","secondsPerMeasure","setPlaybackRate","setZoom","removeAll","add","Peaks","err","initPlayer","replacePlayer","on","sampleRate","views","getView","setStartTime","controls","hidden","src","restoredPersistedState","createAction","createRootReducer","sliceReducer","match","combineReducers","analysisReducer","audioReducer","dialog","dialogReducer","projectReducer","createAppStore","configureStore","reducer","preloadedState","AUDIO","ZIP","FileInput","fileInput","handleChange","fileList","fileURL","getLocalFileUrl","callback","createRef","InputBase","input","placeholder","fileType","inputProps","readOnly","click","aria-label","iconButton","accept","files","flex","ModalDialog","Dialog","onCancel","maxWidth","DialogTitle","DialogContent","DialogContentText","subTitle","DialogActions","label","DialogManagement","onSubmit","zipUrl","store","getState","maxMeasure","NewDialog","useState","fileUrl","setFileUrl","setTitle","TextField","InputProps","OpenDialog","setFile","AddSectionDialog","setSectionType","setStart","setEnd","FormLabel","createMuiTheme","palette","blueGrey","render","ThemeProvider","CssBaseline"],"mappings":"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","file":"static/js/main.42e0ca38.chunk.js","sourcesContent":["import debug from \"debug\";\r\n\r\nenum Level {\r\n  TRACE = \"trace\",\r\n  INFO = \"info\",\r\n  WARN = \"warn\",\r\n  ERROR = \"error\"\r\n}\r\n\r\nconst LEVEL_TO_COLOR = new Map<Level, string>([\r\n  [Level.TRACE, \"lightblue\"],\r\n  [Level.INFO, \"blue\"],\r\n  [Level.WARN, \"yellow\"],\r\n  [Level.ERROR, \"red\"]\r\n]) as ReadonlyMap<Level, string>;\r\n\r\nclass Log {\r\n  private static generateMessage(\r\n    level: Level,\r\n    message: string,\r\n    source: string\r\n  ) {\r\n    const namespace = `transcribe:${level}`;\r\n    const createDebug = debug(namespace);\r\n\r\n    createDebug.color = LEVEL_TO_COLOR.get(level)!;\r\n\r\n    if (source) {\r\n      createDebug(source, message);\r\n    } else {\r\n      createDebug(message);\r\n    }\r\n  }\r\n\r\n  static trace(message: string, source: string) {\r\n    return this.generateMessage(Level.TRACE, message, source);\r\n  }\r\n\r\n  static info(message: string, source: string) {\r\n    return this.generateMessage(Level.INFO, message, source);\r\n  }\r\n\r\n  static warn(message: string, source: string) {\r\n    return this.generateMessage(Level.WARN, message, source);\r\n  }\r\n\r\n  static error(message: string, source: string) {\r\n    return this.generateMessage(Level.ERROR, message, source);\r\n  }\r\n}\r\n\r\nexport default Log;\r\n","import { CardHeader } from \"@material-ui/core\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport React, { Component, ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  body: ReactElement;\r\n  title: string;\r\n  action?: ReactElement;\r\n}\r\n\r\nclass View extends Component<Props> {\r\n  render() {\r\n    return (\r\n      <Card\r\n        style={{\r\n          height: \"100%\",\r\n          backgroundColor: \"#ffffff\"\r\n        }}\r\n        raised={false}\r\n      >\r\n        <CardHeader\r\n          titleTypographyProps={{ variant: \"subtitle1\" }}\r\n          title={this.props.title}\r\n          style={{ backgroundColor: \"#f1f4f6\", padding: \"4px\" }}\r\n          action={this.props.action}\r\n        />\r\n        <CardContent>{this.props.body}</CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default View;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DefaultPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Info\"\r\n        body={\r\n          <>\r\n            <p>No Transcription started!!</p>\r\n            <p>Please create a new Transcription or open an existing one.</p>\r\n          </>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DefaultPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DrumPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Drums View\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the drum part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DrumPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass GuitarPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Guitar\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the guitar part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GuitarPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass HarmonyPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Harmony\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the harmony. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HarmonyPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass PrintPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Print\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to print the leadsheet. Please come\r\n            back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PrintPage;\r\n","import Grid from \"@material-ui/core/Grid\";\r\nimport React, { ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  topLeft: ReactElement;\r\n  topRight: ReactElement;\r\n  bottom?: ReactElement;\r\n}\r\n\r\nclass ContentLayout extends React.Component<Props> {\r\n  render() {\r\n    return (\r\n      <Grid container spacing={2} alignItems=\"stretch\">\r\n        <Grid item xs={9}>\r\n          {this.props.topLeft}\r\n        </Grid>\r\n        <Grid item xs={3}>\r\n          {this.props.topRight}\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          {this.props.bottom}\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ContentLayout;\r\n","import { Box, FormControl, InputLabel, Slider } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nconst SliderInput = (props: {\r\n  title: string;\r\n  min: number;\r\n  max: number;\r\n  step: number;\r\n  value: number;\r\n  onChange: (event: any, value: number | number[]) => void;\r\n}) => {\r\n  return (\r\n    <FormControl style={{ width: \"100%\" }}>\r\n      <InputLabel shrink>{props.title}</InputLabel>\r\n      <Box mt={2}>\r\n        <Slider\r\n          value={props.value}\r\n          valueLabelDisplay=\"auto\"\r\n          min={props.min}\r\n          max={props.max}\r\n          onChange={props.onChange}\r\n          step={props.step}\r\n        />\r\n      </Box>\r\n    </FormControl>\r\n  );\r\n};\r\n\r\nexport default SliderInput;\r\n","class ArrayUtil {\r\n  static range: (start: number, end: number) => string[] = (start, end) => {\r\n    if (start > end) start = end;\r\n\r\n    return Array(end - start + 1)\r\n      .fill(start)\r\n      .map((_, idx) => (start + idx).toString());\r\n  };\r\n\r\n  static bordersOf: (\r\n    array: Array<any>\r\n  ) => { start: number; end: number } = array => {\r\n    return {\r\n      start: parseInt(array[0]),\r\n      end: parseInt(ArrayUtil.last(array))\r\n    };\r\n  };\r\n\r\n  static last: <T>(array: Array<T>) => T = array => {\r\n    return array[array.length - 1];\r\n  };\r\n}\r\n\r\nexport default ArrayUtil;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nimport { PersistedState } from \"../store\";\r\n\r\nexport interface ProjectState {\r\n  readonly status: LoadingStatus;\r\n  readonly currentPage: Page;\r\n  readonly title: string;\r\n  readonly audioUrl: string;\r\n  readonly syncFirstMeasureStart: boolean;\r\n}\r\n\r\nexport enum LoadingStatus {\r\n  NOT_INITIALIZED = \"not_initialized\",\r\n  INITIALIZING = \"initializing\",\r\n  INITIALIZED = \"initialized\"\r\n}\r\n\r\nexport enum Page {\r\n  DEFAULT = \"default\",\r\n  STRUCTURE = \"structure\",\r\n  HARMONY = \"harmony\",\r\n  GUITAR = \"guitar\",\r\n  DRUM = \"drum\",\r\n  PRINT = \"print\"\r\n}\r\n\r\nexport const initialProjectState: ProjectState = {\r\n  status: LoadingStatus.NOT_INITIALIZED,\r\n  currentPage: Page.DEFAULT,\r\n  title: \"\",\r\n  audioUrl: \"\",\r\n  syncFirstMeasureStart: false\r\n};\r\n\r\nconst projectSlice = createSlice({\r\n  name: \"project\",\r\n  initialState: initialProjectState,\r\n  reducers: {\r\n    switchedPage(state, action: PayloadAction<Page>) {\r\n      state.currentPage = action.payload;\r\n    },\r\n    createdProject(state, action: PayloadAction<PersistedState>) {\r\n      return { ...action.payload.project, status: LoadingStatus.INITIALIZING };\r\n    },\r\n    hotReloaded(state) {\r\n      state.status = LoadingStatus.INITIALIZING;\r\n    },\r\n    initializedProject(\r\n      state,\r\n      action: PayloadAction<{ audioDuration: number; audioSampleRate: number }>\r\n    ) {\r\n      state.status = LoadingStatus.INITIALIZED;\r\n    },\r\n    enabledSyncFirstMeasureStart(state, action: PayloadAction<boolean>) {\r\n      state.syncFirstMeasureStart = action.payload;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  switchedPage,\r\n  createdProject,\r\n  initializedProject,\r\n  hotReloaded,\r\n  enabledSyncFirstMeasureStart\r\n} = projectSlice.actions;\r\n\r\nexport default projectSlice.reducer;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { PointAddOptions } from \"peaks.js\";\r\n\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\nimport { createdProject, initializedProject } from \"../project/projectSlice\";\r\nimport { NormalizedObjects } from \"../store\";\r\nimport {\r\n  distributeMeasures,\r\n  enclosingSectionOf,\r\n  generateSectionId,\r\n  mergeSections,\r\n  replaceSections,\r\n  sectionInvalid,\r\n  undefinedSection\r\n} from \"./analysisUtil\";\r\n\r\nexport interface AnalysisState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly audioDuration: number;\r\n  readonly audioSampleRate: number;\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly measures: NormalizedObjects<Measure>;\r\n}\r\n\r\nexport interface Section {\r\n  type: SectionType;\r\n  measures: string[];\r\n}\r\n\r\nexport interface Measure extends PointAddOptions {}\r\n\r\nexport interface TimeSignature {\r\n  beatsPerMeasure: number;\r\n  beatUnit: number;\r\n}\r\n\r\nexport enum TimeSignatureType {\r\n  FOUR_FOUR = \"FOUR_FOUR\",\r\n  THREE_FOUR = \"THREE_FOUR\"\r\n}\r\n\r\nexport enum SectionType {\r\n  INTRO = \"INTRO\",\r\n  VERSE = \"VERSE\",\r\n  PRECHORUS = \"PRECHORUS\",\r\n  CHORUS = \"CHORUS\",\r\n  BRIDGE = \"BRIDGE\",\r\n  SOLO = \"SOLO\",\r\n  OUTRO = \"OUTRO\",\r\n  UNDEFINED = \"UNDEFINED\"\r\n}\r\n\r\nexport const initialAnalysisState: AnalysisState = {\r\n  sections: { allIds: [], byId: {} },\r\n  bpm: 120,\r\n  firstMeasureStart: 0,\r\n  audioDuration: 180,\r\n  audioSampleRate: 44400,\r\n  measures: { allIds: [], byId: {} },\r\n  timeSignature: TimeSignatureType.FOUR_FOUR\r\n};\r\n\r\nconst analysisSlice = createSlice({\r\n  name: \"analysis\",\r\n  initialState: initialAnalysisState,\r\n  extraReducers: builder =>\r\n    builder\r\n      .addCase(createdProject, (state, action) => {\r\n        return action.payload.analysis;\r\n      })\r\n      .addCase(initializedProject, (state, action) => {\r\n        state.audioDuration = action.payload.audioDuration;\r\n        state.audioSampleRate = action.payload.audioSampleRate;\r\n\r\n        state.measures = distributeMeasures(\r\n          state.timeSignature,\r\n          state.bpm,\r\n          state.firstMeasureStart,\r\n          state.audioDuration\r\n        );\r\n\r\n        if (state.sections.allIds.length === 0)\r\n          state.sections = undefinedSection(state.measures.allIds.length - 1);\r\n      }),\r\n  reducers: {\r\n    addedSection(state, action: PayloadAction<Section>) {\r\n      return addSection(state, action.payload);\r\n    },\r\n    updatedSection(\r\n      state,\r\n      action: PayloadAction<{ before: string; after: Section }>\r\n    ) {\r\n      removeSection(state, action.payload.before);\r\n      return addSection(state, action.payload.after);\r\n    },\r\n    removedSection(state, action: PayloadAction<string>) {\r\n      removeSection(state, action.payload);\r\n\r\n      return state;\r\n    },\r\n    updatedRhythm(\r\n      state,\r\n      action: PayloadAction<{\r\n        firstMeasureStart?: number;\r\n        bpm?: number;\r\n        timeSignatureType?: TimeSignatureType;\r\n      }>\r\n    ) {\r\n      state.bpm = action.payload.bpm ?? state.bpm;\r\n      state.firstMeasureStart =\r\n        action.payload.firstMeasureStart ?? state.firstMeasureStart;\r\n      state.timeSignature =\r\n        action.payload.timeSignatureType ?? state.timeSignature;\r\n\r\n      state.measures = distributeMeasures(\r\n        state.timeSignature,\r\n        state.bpm,\r\n        state.firstMeasureStart,\r\n        state.audioDuration\r\n      );\r\n\r\n      const lastSection =\r\n        state.sections.byId[\r\n          state.sections.allIds[state.sections.allIds.length - 1]\r\n        ];\r\n\r\n      if (lastSection === undefined) return state;\r\n\r\n      if (\r\n        parseInt(ArrayUtil.last(state.measures.allIds)) >\r\n        parseInt(lastSection.measures[lastSection.measures.length - 1])\r\n      ) {\r\n        const newLastSection: Section = {\r\n          type: lastSection.type,\r\n          measures: ArrayUtil.range(\r\n            parseInt(lastSection.measures[0]),\r\n            parseInt(ArrayUtil.last(state.measures.allIds))\r\n          )\r\n        };\r\n        const id = generateSectionId(newLastSection);\r\n        delete state.sections.byId[\r\n          state.sections.allIds[state.sections.allIds.length - 1]\r\n        ];\r\n        state.sections.allIds[state.sections.allIds.length - 1] = id;\r\n        state.sections.byId[id] = newLastSection;\r\n      }\r\n\r\n      removeSectionsAfterLastMeasure(state);\r\n\r\n      return state;\r\n    }\r\n  }\r\n});\r\n\r\nconst removeSectionsAfterLastMeasure: (\r\n  state: AnalysisState\r\n) => void = state => {\r\n  const lastMeasure = state.measures.allIds.length - 1;\r\n  let removalStart = -1;\r\n  let removalStartMeasure = -1;\r\n\r\n  for (let index = 0; index <= state.sections.allIds.length - 1; index++) {\r\n    const section = state.sections.byId[state.sections.allIds[index]];\r\n    const sectionEnd = parseInt(ArrayUtil.last(section.measures));\r\n\r\n    if (sectionEnd > lastMeasure) {\r\n      removalStart = index;\r\n      removalStartMeasure = parseInt(section.measures[0]);\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (removalStart === -1) return; // No sections after last measure\r\n\r\n  replaceSections(\r\n    state.sections,\r\n    removalStart,\r\n    state.sections.allIds.length - removalStart,\r\n    [\r\n      {\r\n        measures: ArrayUtil.range(removalStartMeasure, lastMeasure),\r\n        type: SectionType.UNDEFINED\r\n      }\r\n    ]\r\n  );\r\n};\r\n\r\nconst addSection: (\r\n  state: AnalysisState,\r\n  newSection: Section\r\n) => AnalysisState = (state, newSection) => {\r\n  if (sectionInvalid(newSection)) return state;\r\n\r\n  let enclosingSection = enclosingSectionOf(newSection, state.sections);\r\n  if (\r\n    enclosingSection === undefined ||\r\n    enclosingSection.section.type !== SectionType.UNDEFINED\r\n  )\r\n    return state;\r\n\r\n  let mergedSections = mergeSections(enclosingSection.section, newSection);\r\n\r\n  replaceSections(state.sections, enclosingSection.position, 1, mergedSections);\r\n\r\n  return state;\r\n};\r\n\r\nconst removeSection: (state: AnalysisState, sectionId: string) => void = (\r\n  state,\r\n  sectionId\r\n) => {\r\n  let position = state.sections.allIds.indexOf(sectionId);\r\n  let section = state.sections.byId[sectionId];\r\n\r\n  let before = state.sections.allIds[position - 1];\r\n  let after = state.sections.allIds[position + 1];\r\n\r\n  let { start: firstMeasure, end: lastMeasure } = ArrayUtil.bordersOf(\r\n    section.measures\r\n  );\r\n  let removalStart = position;\r\n  let removalCount = 1;\r\n\r\n  if (\r\n    before !== undefined &&\r\n    state.sections.byId[before].type === SectionType.UNDEFINED\r\n  ) {\r\n    removalStart--;\r\n    removalCount++;\r\n    firstMeasure = parseInt(state.sections.byId[before].measures[0]);\r\n  }\r\n\r\n  if (\r\n    after !== undefined &&\r\n    state.sections.byId[after].type === SectionType.UNDEFINED\r\n  ) {\r\n    removalCount++;\r\n    lastMeasure = parseInt(ArrayUtil.last(state.sections.byId[after].measures));\r\n  }\r\n\r\n  replaceSections(state.sections, removalStart, removalCount, [\r\n    {\r\n      measures: ArrayUtil.range(firstMeasure, lastMeasure),\r\n      type: SectionType.UNDEFINED\r\n    }\r\n  ]);\r\n};\r\n\r\nexport const {\r\n  addedSection,\r\n  removedSection,\r\n  updatedRhythm,\r\n  updatedSection\r\n} = analysisSlice.actions;\r\n\r\nexport default analysisSlice.reducer;\r\n","import ArrayUtil from \"../../util/ArrayUtil\";\r\nimport { NormalizedObjects } from \"../store\";\r\nimport {\r\n  Measure,\r\n  Section,\r\n  SectionType,\r\n  TimeSignatureType\r\n} from \"./analysisSlice\";\r\n\r\nexport const toTimeSignature = (type: TimeSignatureType) => {\r\n  switch (type) {\r\n    case TimeSignatureType.FOUR_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 4 };\r\n    case TimeSignatureType.THREE_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 3 };\r\n  }\r\n};\r\n\r\nexport const toTimeSignatureType = (type: string) => {\r\n  switch (type) {\r\n    case TimeSignatureType.FOUR_FOUR.toString():\r\n      return TimeSignatureType.FOUR_FOUR;\r\n    case TimeSignatureType.THREE_FOUR.toString():\r\n      return TimeSignatureType.THREE_FOUR;\r\n    default:\r\n      throw Error(\"Unknown time signature type: \" + type);\r\n  }\r\n};\r\n\r\nexport const undefinedSection = (length: number) => {\r\n  let undefinedSectionId = \"UNDEFINED_0_\" + length;\r\n  let sections: NormalizedObjects<Section>;\r\n\r\n  sections = {\r\n    allIds: [undefinedSectionId],\r\n    byId: {}\r\n  };\r\n\r\n  sections.byId[undefinedSectionId] = {\r\n    measures: ArrayUtil.range(0, length),\r\n    type: SectionType.UNDEFINED\r\n  };\r\n\r\n  return sections;\r\n};\r\n\r\nexport const sectionInvalid = (section: Section) => {\r\n  return (\r\n    parseInt(section.measures[0]) >\r\n    parseInt(section.measures[section.measures.length - 1])\r\n  );\r\n};\r\n\r\nexport const enclosingSectionOf = (\r\n  section: Section,\r\n  allSections: NormalizedObjects<Section>\r\n) => {\r\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\r\n    section.measures\r\n  );\r\n\r\n  const sectionCount = allSections.allIds.length;\r\n\r\n  for (let current = 0; current <= sectionCount - 1; current++) {\r\n    let section = allSections.byId[allSections.allIds[current]];\r\n    let { end: currentSectionEnd } = ArrayUtil.bordersOf(section.measures);\r\n\r\n    //Go to next section if not included\r\n    if (newSectionStart >= currentSectionEnd) continue;\r\n\r\n    //Exit if new section overlaps current section's border\r\n    if (newSectionEnd > currentSectionEnd) return undefined;\r\n\r\n    return { position: current, section: section };\r\n  }\r\n};\r\n\r\nexport const mergeSections: (\r\n  enclosingSection: Section,\r\n  embeddedSection: Section\r\n) => Section[] = (enclosingSection, embeddedSection) => {\r\n  let newSections: Section[] = [];\r\n\r\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\r\n    embeddedSection.measures\r\n  );\r\n\r\n  const {\r\n    start: currentSectionStart,\r\n    end: currentSectionEnd\r\n  } = ArrayUtil.bordersOf(enclosingSection.measures);\r\n\r\n  //Add a new undefined block before the new section\r\n  if (newSectionStart > currentSectionStart) {\r\n    let section: Section = {\r\n      measures: ArrayUtil.range(currentSectionStart, newSectionStart - 1),\r\n      type: SectionType.UNDEFINED\r\n    };\r\n    newSections.push(section);\r\n  }\r\n\r\n  //add new section\r\n  newSections.push(embeddedSection);\r\n\r\n  //Add a new undefined block after the new section\r\n  if (newSectionEnd < currentSectionEnd) {\r\n    let section: Section = {\r\n      measures: ArrayUtil.range(newSectionEnd + 1, currentSectionEnd),\r\n      type: SectionType.UNDEFINED\r\n    };\r\n    newSections.push(section);\r\n  }\r\n\r\n  return newSections;\r\n};\r\n\r\nexport const replaceSections = (\r\n  sections: NormalizedObjects<Section>,\r\n  start: number,\r\n  deleteCount: number,\r\n  newSections: Section[]\r\n) => {\r\n  for (let section = start; section < deleteCount; section++) {\r\n    delete sections.byId[sections.allIds[section]];\r\n  }\r\n\r\n  let ids: string[] = [];\r\n\r\n  newSections.forEach(section => {\r\n    const id = generateSectionId(section);\r\n    ids.push(id);\r\n    sections.byId[id] = section;\r\n  });\r\n\r\n  sections.allIds.splice(start, deleteCount, ...ids);\r\n};\r\n\r\nexport const generateSectionId = (section: Section) =>\r\n  section.type +\r\n  \"_\" +\r\n  section.measures[0] +\r\n  \"_\" +\r\n  section.measures[section.measures.length - 1];\r\n\r\nexport const distributeMeasures = (\r\n  timeSignatureType: TimeSignatureType,\r\n  bpm: number,\r\n  firstMeasureStart: number,\r\n  length: number\r\n) => {\r\n  const timeSignature = toTimeSignature(timeSignatureType);\r\n  const lengthOfOneMeasure = (60 * timeSignature.beatsPerMeasure) / bpm;\r\n  const measures: NormalizedObjects<Measure> = { allIds: [], byId: {} };\r\n\r\n  let index = 0;\r\n  for (\r\n    let start = firstMeasureStart;\r\n    start < length;\r\n    start += lengthOfOneMeasure\r\n  ) {\r\n    measures.allIds.push(\"\" + index);\r\n    measures.byId[index] = {\r\n      time: start,\r\n      color: \"\",\r\n      editable: false,\r\n      id: \"\" + index,\r\n      labelText: \"\" + index\r\n    };\r\n    index++;\r\n  }\r\n\r\n  return measures;\r\n};\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface DialogState {\r\n  readonly currentDialog: DialogType;\r\n}\r\n\r\nexport enum DialogType {\r\n  NONE = \"none\",\r\n  NEW = \"new\",\r\n  OPEN = \"open\",\r\n  SAVE = \"save\",\r\n  ADD_SECTION = \"add_section\"\r\n}\r\n\r\nconst initialDialogState: DialogState = {\r\n  currentDialog: DialogType.NONE\r\n};\r\n\r\nconst dialogsSlice = createSlice({\r\n  name: \"dialogs\",\r\n  initialState: initialDialogState,\r\n  reducers: {\r\n    openedDialog(state, action: PayloadAction<DialogType>) {\r\n      state.currentDialog = action.payload;\r\n    },\r\n    closedDialog(state) {\r\n      state.currentDialog = DialogType.NONE;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { openedDialog, closedDialog } = dialogsSlice.actions;\r\n\r\nexport default dialogsSlice.reducer;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface AudioState {\r\n  readonly isPlaying: boolean;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n  readonly isLooping: boolean;\r\n  readonly loopStart: number;\r\n  readonly loopEnd: number;\r\n}\r\n\r\nexport interface PlaybackSettings {\r\n  readonly detune?: number;\r\n  readonly playbackRate?: number;\r\n}\r\n\r\nexport const initialAudioState: AudioState = {\r\n  isPlaying: false,\r\n  detune: 0,\r\n  playbackRate: 1,\r\n  isLooping: false,\r\n  loopStart: 0,\r\n  loopEnd: 0\r\n};\r\n\r\nconst audioSlice = createSlice({\r\n  name: \"audio\",\r\n  initialState: initialAudioState,\r\n  reducers: {\r\n    triggeredPlay(state) {\r\n      state.isPlaying = true;\r\n    },\r\n    triggeredPause(state) {\r\n      state.isPlaying = false;\r\n    },\r\n    updatedPlaybackSettings(\r\n      state,\r\n      action: PayloadAction<{ playbackRate?: number; detune?: number }>\r\n    ) {\r\n      if (action.payload.detune !== undefined)\r\n        state.detune = action.payload.detune;\r\n      if (action.payload.playbackRate !== undefined)\r\n        state.playbackRate = action.payload.playbackRate;\r\n    },\r\n    toggledLoop(state) {\r\n      state.isLooping = !state.isLooping;\r\n    },\r\n    updatedLoopSettings(\r\n      state,\r\n      action: PayloadAction<{ start?: number; end?: number }>\r\n    ) {\r\n      if (action.payload.start !== undefined)\r\n        state.loopStart = action.payload.start;\r\n      if (action.payload.end !== undefined) state.loopEnd = action.payload.end;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  triggeredPause,\r\n  triggeredPlay,\r\n  updatedPlaybackSettings,\r\n  toggledLoop,\r\n  updatedLoopSettings\r\n} = audioSlice.actions;\r\n\r\nexport default audioSlice.reducer;\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nconst MeasureSelect: FunctionComponent<{\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  onChange: (value: number) => void;\r\n  disabled?: boolean;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newMeasure = event.target.value as number;\r\n    props.onChange(newMeasure);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        minWidth: \"40px\"\r\n      }}\r\n      disabled={props.disabled}\r\n    >\r\n      {new Array<number>(props.max - props.min + 1)\r\n        .fill(0)\r\n        .map((_, idx: number) => {\r\n          return (\r\n            <MenuItem key={props.min + idx} value={props.min + idx}>\r\n              {props.min + idx}\r\n            </MenuItem>\r\n          );\r\n        })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default MeasureSelect;\r\n","import { PointAddOptions, SegmentAddOptions } from \"peaks.js\";\r\n\r\nimport {\r\n  Measure,\r\n  Section,\r\n  SectionType\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { NormalizedObjects } from \"../../states/store\";\r\n\r\nexport const AUDIO_DOM_ELEMENT = \"audio_dom_element\";\r\nexport const ZOOMVIEW_CONTAINER = \"zoomview-container\";\r\nexport const OVERVIEW_CONTAINER = \"overview-container\";\r\n\r\nclass PeaksConfig {\r\n  static create = (audioBuffer: AudioBuffer) => {\r\n    let mediaelement = document!.getElementById(\r\n      AUDIO_DOM_ELEMENT\r\n    )! as HTMLAudioElement;\r\n\r\n    return {\r\n      containers: {\r\n        zoomview: document!.getElementById(ZOOMVIEW_CONTAINER)!,\r\n        overview: document!.getElementById(OVERVIEW_CONTAINER)!\r\n      },\r\n      mediaElement: mediaelement,\r\n      webAudio: {\r\n        audioBuffer: audioBuffer,\r\n        scale: 128,\r\n        multiChannel: false\r\n      },\r\n      keyboard: true,\r\n      pointMarkerColor: \"#006eb0\",\r\n      showPlayheadTime: true,\r\n      zoomLevels: [42] //TODO: Define good initial default\r\n    };\r\n  };\r\n\r\n  static sectionsToSegment = (\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>,\r\n    timePerMeasure: number\r\n  ) => {\r\n    let segments: SegmentAddOptions[] = [];\r\n    sections.allIds.forEach(id => {\r\n      const section = sections.byId[id];\r\n\r\n      const start = measures.byId[section.measures[0]].time;\r\n      const end =\r\n        measures.byId[section.measures[section.measures.length - 1]].time +\r\n        timePerMeasure;\r\n\r\n      let segment: SegmentAddOptions = {\r\n        id,\r\n        labelText: section.type,\r\n        startTime: start,\r\n        endTime: end,\r\n        color: PeaksConfig.SECTIONTYPE_TO_COLOR.get(section.type),\r\n        editable: false\r\n      };\r\n\r\n      segments.push(segment);\r\n    });\r\n\r\n    return segments;\r\n  };\r\n\r\n  static measuresToPoints = (measures: NormalizedObjects<Measure>) => {\r\n    let points: PointAddOptions[] = [];\r\n    measures.allIds.forEach(id => {\r\n      const measure = measures.byId[id];\r\n\r\n      let point: PointAddOptions = measure;\r\n\r\n      points.push(point);\r\n    });\r\n\r\n    return points;\r\n  };\r\n\r\n  static SECTIONTYPE_TO_COLOR = new Map<SectionType, string>([\r\n    [SectionType.INTRO, \"#FFCA28\"],\r\n    [SectionType.VERSE, \"#FFA726\"],\r\n    [SectionType.PRECHORUS, \"#FF7043\"],\r\n    [SectionType.CHORUS, \"#9CCC65\"],\r\n    [SectionType.SOLO, \"#26C6DA\"],\r\n    [SectionType.OUTRO, \"#5C6BC0\"],\r\n    [SectionType.BRIDGE, \"#EC407A\"],\r\n    [SectionType.VERSE, \"#78909C\"],\r\n    [SectionType.UNDEFINED, \"#f2f2f2\"]\r\n  ]) as ReadonlyMap<SectionType, string>;\r\n}\r\n\r\nexport default PeaksConfig;\r\n","import {\r\n  FormControl,\r\n  IconButton,\r\n  Input,\r\n  InputAdornment,\r\n  InputLabel,\r\n  NativeSelect,\r\n  Popover,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport BorderLeftIcon from \"@material-ui/icons/BorderLeft\";\r\nimport LoopIcon from \"@material-ui/icons/Loop\";\r\nimport MusicNoteIcon from \"@material-ui/icons/MusicNote\";\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport SpeedIcon from \"@material-ui/icons/Speed\";\r\nimport SyncAltIcon from \"@material-ui/icons/SyncAlt\";\r\nimport TimerIcon from \"@material-ui/icons/Timer\";\r\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\r\nimport React, { ReactElement } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport ContentLayout from \"../../components/contentLayout/contentLayout\";\r\nimport Log from \"../../components/log/log\";\r\nimport SliderInput from \"../../components/sliderInput/sliderInput\";\r\nimport View from \"../../components/view/view\";\r\nimport {\r\n  TimeSignatureType,\r\n  updatedRhythm\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { toTimeSignatureType } from \"../../states/analysis/analysisUtil\";\r\nimport {\r\n  triggeredPause,\r\n  triggeredPlay,\r\n  updatedPlaybackSettings\r\n} from \"../../states/audio/audioSlice\";\r\nimport { DialogType, openedDialog } from \"../../states/dialog/dialogsSlice\";\r\nimport {\r\n  enabledSyncFirstMeasureStart,\r\n  LoadingStatus\r\n} from \"../../states/project/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport StructureView from \"../../views/structure/structureView\";\r\nimport StructureNavigationView from \"../../views/structureNavigation/structureNavigationView\";\r\nimport WaveContainer from \"../../views/wave/waveContainer\";\r\n\r\ninterface PropsFromState {\r\n  readonly loaded: boolean;\r\n  readonly isPlaying: boolean;\r\n  readonly syncFirstMeasureStart: boolean;\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  triggeredPlay: typeof triggeredPlay;\r\n  triggeredPause: typeof triggeredPause;\r\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\r\n  updatedRhythm: typeof updatedRhythm;\r\n  updatedPlaybackSettings: typeof updatedPlaybackSettings;\r\n  openedDialog: typeof openedDialog;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\ninterface State {\r\n  anchorEl: HTMLButtonElement | null;\r\n  activePopover: PopoverType;\r\n}\r\n\r\nenum PopoverType {\r\n  RHYTHM,\r\n  PLAYBACKRATE,\r\n  DETUNE,\r\n  STARTMEASURE,\r\n  NONE\r\n}\r\n\r\nclass StructurePage extends React.Component<AllProps, State> {\r\n  state: State = {\r\n    anchorEl: null,\r\n    activePopover: PopoverType.NONE\r\n  };\r\n\r\n  handlePopoverOpen = (\r\n    event: React.MouseEvent<HTMLButtonElement>,\r\n    type: PopoverType\r\n  ) => {\r\n    this.setState({ anchorEl: event.currentTarget, activePopover: type });\r\n  };\r\n\r\n  handlePopoverClose = () => {\r\n    this.setState({ anchorEl: null, activePopover: PopoverType.NONE });\r\n  };\r\n\r\n  render() {\r\n    Log.info(\"render\", StructurePage.name);\r\n    return (\r\n      <ContentLayout\r\n        topLeft={\r\n          <View\r\n            title=\"Song Overview\"\r\n            body={<WaveContainer />}\r\n            action={\r\n              <>\r\n                {this.props.isPlaying ? (\r\n                  <WaveformControlButton\r\n                    title=\"Pause\"\r\n                    icon={<PauseIcon />}\r\n                    onClick={() => this.props.triggeredPause()}\r\n                  />\r\n                ) : (\r\n                  <WaveformControlButton\r\n                    title=\"Play\"\r\n                    icon={<PlayArrowIcon />}\r\n                    onClick={() => this.props.triggeredPlay()}\r\n                  />\r\n                )}\r\n\r\n                <WaveformControlButton\r\n                  title=\"Loop\"\r\n                  icon={<LoopIcon />}\r\n                  disabled={true}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Rhythm & Metronome\"\r\n                  icon={<TimerIcon />}\r\n                  onClick={e => this.handlePopoverOpen(e, PopoverType.RHYTHM)}\r\n                  disabled={false}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Playback Rate\"\r\n                  icon={<SpeedIcon />}\r\n                  onClick={e =>\r\n                    this.handlePopoverOpen(e, PopoverType.PLAYBACKRATE)\r\n                  }\r\n                  disabled={false}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Detune\"\r\n                  icon={<MusicNoteIcon />}\r\n                  onClick={e => this.handlePopoverOpen(e, PopoverType.DETUNE)}\r\n                  disabled={false}\r\n                />\r\n                <Popover\r\n                  style={{ height: \"400px\" }}\r\n                  open={this.state.activePopover !== PopoverType.NONE}\r\n                  anchorEl={this.state.anchorEl}\r\n                  onClose={() => this.handlePopoverClose()}\r\n                  anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"left\"\r\n                  }}\r\n                  anchorPosition={{ top: 50, left: 0 }}\r\n                  transformOrigin={{\r\n                    vertical: \"top\",\r\n                    horizontal: \"center\"\r\n                  }}\r\n                >\r\n                  {this.state.activePopover !== PopoverType.NONE && (\r\n                    <div\r\n                      style={{\r\n                        width: \"200px\",\r\n                        minHeight: \"50px\",\r\n                        margin: \"10px\",\r\n                        marginTop: \"20px\"\r\n                      }}\r\n                    >\r\n                      {PopoverContent(this.state.activePopover, this.props)}\r\n                    </div>\r\n                  )}\r\n                </Popover>\r\n              </>\r\n            }\r\n          ></View>\r\n        }\r\n        topRight={\r\n          <View title=\"Song Measures\" body={<StructureNavigationView />}></View>\r\n        }\r\n        bottom={\r\n          <View\r\n            title=\"Song Structure\"\r\n            action={\r\n              <>\r\n                <WaveformControlButton\r\n                  title=\"Start Measure 0\"\r\n                  icon={<BorderLeftIcon />}\r\n                  onClick={e =>\r\n                    this.handlePopoverOpen(e, PopoverType.STARTMEASURE)\r\n                  }\r\n                  disabled={false}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Add section\"\r\n                  icon={<AddIcon />}\r\n                  onClick={() =>\r\n                    this.props.openedDialog(DialogType.ADD_SECTION)\r\n                  }\r\n                />\r\n              </>\r\n            }\r\n            body={<StructureView />}\r\n          ></View>\r\n        }\r\n      ></ContentLayout>\r\n    );\r\n  }\r\n}\r\n\r\nconst WaveformControlButton = (props: {\r\n  title: string;\r\n  icon: ReactElement;\r\n  disabled?: boolean;\r\n  onClick?: (e?: any) => void;\r\n}) => {\r\n  const button = (\r\n    <IconButton\r\n      onClick={props.onClick}\r\n      size=\"small\"\r\n      style={{ marginTop: \"8px\", marginRight: \"5px\" }}\r\n      disabled={props.disabled}\r\n    >\r\n      {props.icon}\r\n    </IconButton>\r\n  );\r\n\r\n  if (props.disabled) return button;\r\n\r\n  return <Tooltip title={props.title}>{button}</Tooltip>;\r\n};\r\n\r\nconst PopoverContent = (type: PopoverType, props: AllProps) => {\r\n  switch (type) {\r\n    case PopoverType.DETUNE:\r\n      return <DetunePopover {...props} />;\r\n    case PopoverType.PLAYBACKRATE:\r\n      return <PlaybackRatePopover {...props} />;\r\n    case PopoverType.RHYTHM:\r\n      return <RhythmPopover {...props} />;\r\n    case PopoverType.STARTMEASURE:\r\n      return <StartMeasurePopover {...props} />;\r\n    default:\r\n      throw Error(\"Popup type undefined: \" + type);\r\n  }\r\n};\r\n\r\nconst RhythmPopover = (props: AllProps) => (\r\n  <>\r\n    <SliderInput\r\n      title=\"Bpm\"\r\n      value={props.bpm}\r\n      min={40}\r\n      max={220}\r\n      step={1}\r\n      onChange={(e, bpm) => {\r\n        if (!Array.isArray(bpm)) {\r\n          props.updatedRhythm({ bpm: bpm });\r\n        }\r\n      }}\r\n    ></SliderInput>\r\n    <FormControl fullWidth={true}>\r\n      <InputLabel>Time Signature</InputLabel>\r\n      <NativeSelect\r\n        value={props.timeSignature}\r\n        onChange={e =>\r\n          props.updatedRhythm({\r\n            timeSignatureType: toTimeSignatureType(e.target.value)\r\n          })\r\n        }\r\n      >\r\n        <option value={TimeSignatureType.FOUR_FOUR}>4/4</option>\r\n        <option value={TimeSignatureType.THREE_FOUR}>3/4</option>\r\n      </NativeSelect>\r\n    </FormControl>\r\n  </>\r\n);\r\nconst DetunePopover = (props: AllProps) => (\r\n  <SliderInput\r\n    title=\"Detune\"\r\n    value={props.detune}\r\n    min={-12}\r\n    max={12}\r\n    step={0.5}\r\n    onChange={(e, detune) => {\r\n      if (!Array.isArray(detune) && detune !== props.detune) {\r\n        props.updatedPlaybackSettings({ detune: detune });\r\n      }\r\n    }}\r\n  ></SliderInput>\r\n);\r\nconst StartMeasurePopover = (props: {\r\n  firstMeasureStart: number;\r\n  syncFirstMeasureStart: boolean;\r\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\r\n}) => (\r\n  <FormControl fullWidth={true}>\r\n    <InputLabel>Start Measure 1</InputLabel>\r\n    <Input\r\n      type=\"text\"\r\n      id=\"startMeasure1\"\r\n      value={props.firstMeasureStart}\r\n      startAdornment={\r\n        <InputAdornment position=\"start\">\r\n          <Tooltip\r\n            title=\"Toggle sync with mouse click.\r\n          If enabled, clicking into the waveform will update the start of measure 0 to the selected position.\"\r\n          >\r\n            <ToggleButton\r\n              style={{ width: \"15px\", height: \"25px\" }}\r\n              value=\"check\"\r\n              selected={props.syncFirstMeasureStart}\r\n              onChange={() => {\r\n                props.enabledSyncFirstMeasureStart(\r\n                  !props.syncFirstMeasureStart\r\n                );\r\n              }}\r\n            >\r\n              <SyncAltIcon />\r\n            </ToggleButton>\r\n          </Tooltip>\r\n        </InputAdornment>\r\n      }\r\n    />\r\n  </FormControl>\r\n);\r\nconst PlaybackRatePopover = (props: AllProps) => (\r\n  <SliderInput\r\n    title=\"Playback rate\"\r\n    value={props.playbackRate}\r\n    min={0.4}\r\n    max={1.2}\r\n    step={0.05}\r\n    onChange={(e, playbackRate) => {\r\n      if (!Array.isArray(playbackRate) && playbackRate !== props.playbackRate) {\r\n        props.updatedPlaybackSettings({ playbackRate: playbackRate });\r\n      }\r\n    }}\r\n  ></SliderInput>\r\n);\r\n\r\nconst mapStateToProps = ({ project, audio, analysis }: ApplicationState) => {\r\n  return {\r\n    loaded: project.status === LoadingStatus.INITIALIZED,\r\n    isPlaying: audio.isPlaying,\r\n    firstMeasureStart: analysis.firstMeasureStart,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    bpm: analysis.bpm,\r\n    timeSignature: analysis.timeSignature,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  triggeredPlay,\r\n  triggeredPause,\r\n  enabledSyncFirstMeasureStart,\r\n  updatedRhythm,\r\n  updatedPlaybackSettings,\r\n  openedDialog\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructurePage);\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nimport { SectionType } from \"../../states/analysis/analysisSlice\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\nconst SectionSelect: FunctionComponent<{\r\n  value: SectionType;\r\n  onChange: (sectionType: SectionType) => void;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newSection = event.target.value as SectionType;\r\n    props.onChange(newSection);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(props.value),\r\n        minWidth: \"140px\"\r\n      }}\r\n    >\r\n      {Object.values(SectionType).map(sectionType => {\r\n        return sectionType === SectionType.UNDEFINED ? (\r\n          undefined\r\n        ) : (\r\n          <MenuItem\r\n            key={sectionType}\r\n            value={sectionType}\r\n            style={{\r\n              backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(sectionType)\r\n            }}\r\n          >\r\n            {sectionType}\r\n          </MenuItem>\r\n        );\r\n      })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default SectionSelect;\r\n","import {\r\n  IconButton,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow\r\n} from \"@material-ui/core\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport MeasureSelect from \"../../components/measureSelect/measureSelect\";\r\nimport SectionSelect from \"../../components/sectionSelect/sectionSelect\";\r\nimport {\r\n  addedSection,\r\n  removedSection,\r\n  Section,\r\n  SectionType,\r\n  updatedSection\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\n\r\ninterface PropsFromState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly measuresCount: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  addedSection: typeof addedSection;\r\n  updatedSection: typeof updatedSection;\r\n  removedSection: typeof removedSection;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureView extends Component<AllProps> {\r\n  handleAddSection = (section: Section) => {\r\n    this.props.addedSection(section);\r\n  };\r\n\r\n  handleUpdatedSection = (id: string, before: Section, after: Section) => {\r\n    Log.info(\r\n      \"Change section \" +\r\n        id +\r\n        \" from \" +\r\n        JSON.stringify(before) +\r\n        \" to \" +\r\n        JSON.stringify(after),\r\n      StructureView.name\r\n    );\r\n\r\n    if (\r\n      parseInt(after.measures[0]) >\r\n      parseInt(after.measures[after.measures.length - 1])\r\n    )\r\n      return;\r\n\r\n    this.props.updatedSection({ before: id, after });\r\n  };\r\n\r\n  handleRemoveSection = (id: string) => {\r\n    this.props.removedSection(id);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <TableContainer component={Paper}>\r\n        <Table size=\"small\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell style={{ width: \"10%\" }}></TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Section</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>First Measure</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Last Measure</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {this.props.sections.allIds.map((id: string) => {\r\n              let section = this.props.sections.byId[id];\r\n              return (\r\n                <TableRow key={id}>\r\n                  <TableCell component=\"th\" scope=\"row\">\r\n                    {section.type !== SectionType.UNDEFINED && (\r\n                      <IconButton\r\n                        onClick={() => this.handleRemoveSection(id)}\r\n                        size=\"small\"\r\n                      >\r\n                        <RemoveIcon></RemoveIcon>\r\n                      </IconButton>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {section.type === SectionType.UNDEFINED ? (\r\n                      \"UNDEFINED\"\r\n                    ) : (\r\n                      <SectionSelect\r\n                        value={section.type}\r\n                        onChange={sectionType =>\r\n                          this.handleUpdatedSection(id, section, {\r\n                            ...section,\r\n                            type: sectionType\r\n                          })\r\n                        }\r\n                      ></SectionSelect>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      disabled={section.type === SectionType.UNDEFINED}\r\n                      value={parseInt(section.measures[0])}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            measure,\r\n                            parseInt(\r\n                              section.measures[section.measures.length - 1]\r\n                            )\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      disabled={section.type === SectionType.UNDEFINED}\r\n                      value={parseInt(\r\n                        section.measures[section.measures.length - 1]\r\n                      )}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            parseInt(section.measures[0]),\r\n                            measure\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                </TableRow>\r\n              );\r\n            })}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measuresCount: analysis.measures.allIds.length\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  addedSection,\r\n  updatedSection,\r\n  removedSection\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructureView);\r\n","import { Button, ButtonGroup, Grid, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { Measure, Section } from \"../../states/analysis/analysisSlice\";\r\nimport { updatedLoopSettings } from \"../../states/audio/audioSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  updatedLoopSettings: typeof updatedLoopSettings;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass SectionOverview extends React.Component<AllProps> {\r\n  render() {\r\n    let { sections, measures } = this.props;\r\n\r\n    let generateMatrix = (arr: string[], size: number) => {\r\n      var res = [];\r\n      for (var i = 0; i < arr.length; i = i + size)\r\n        res.push(arr.slice(i, i + size));\r\n      return res;\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <Grid container direction=\"column\">\r\n          {sections.allIds.map(sectionId => (\r\n            <Grid item key={sectionId}>\r\n              <Grid container direction=\"column\">\r\n                <Grid item key={sectionId + \"_caption\"}>\r\n                  <Typography variant=\"caption\">\r\n                    {sections.byId[sectionId].type.toLowerCase()}\r\n                  </Typography>\r\n                </Grid>\r\n                <Grid item key={sectionId + \"_body\"}>\r\n                  <Grid\r\n                    container\r\n                    direction=\"column\"\r\n                    style={{ marginBottom: \"5px\" }}\r\n                  >\r\n                    {generateMatrix(sections.byId[sectionId].measures, 8).map(\r\n                      row => (\r\n                        <ButtonGroup\r\n                          key={sectionId + \"_buttonGroup_\" + row[0]}\r\n                          orientation=\"horizontal\"\r\n                          size=\"small\"\r\n                          style={{\r\n                            height: \"15px\",\r\n                            width: \"10px\",\r\n                            padding: \"0px\"\r\n                          }}\r\n                        >\r\n                          {row.map(measureId => {\r\n                            let measure: Measure = measures.byId[measureId];\r\n                            let nextMeasure: Measure =\r\n                              measures.byId[Number(measureId) + 1];\r\n                            return (\r\n                              <Square\r\n                                key={measure.id}\r\n                                value={measure.id!}\r\n                                bg={\r\n                                  PeaksConfig.SECTIONTYPE_TO_COLOR.get(\r\n                                    sections.byId[sectionId].type\r\n                                  )!\r\n                                }\r\n                                onClick={() =>\r\n                                  this.props.updatedLoopSettings({\r\n                                    start: measure.time,\r\n                                    end: nextMeasure.time\r\n                                  })\r\n                                }\r\n                              ></Square>\r\n                            );\r\n                          })}\r\n                        </ButtonGroup>\r\n                      )\r\n                    )}\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nclass Square extends React.Component<{\r\n  value: string;\r\n  bg: string;\r\n  onClick: () => void;\r\n}> {\r\n  render() {\r\n    return (\r\n      <Button\r\n        {...this.props}\r\n        style={{\r\n          backgroundColor: this.props.bg\r\n        }}\r\n        onClick={() => this.props.onClick()}\r\n      >\r\n        {this.props.value}\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measures: analysis.measures\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = { updatedLoopSettings };\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SectionOverview);\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport SectionOverview from \"../../components/sectionOverview/sectionOverview\";\r\nimport { ApplicationState } from \"../../states/store\";\r\n\r\ninterface PropsFromState {}\r\n\r\ninterface PropsFromDispatch {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureNavigationView extends Component<AllProps> {\r\n  render() {\r\n    return <SectionOverview></SectionOverview>;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {};\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(StructureNavigationView);\r\n","import React, { Component } from \"react\";\r\n\r\nimport {\r\n  OVERVIEW_CONTAINER,\r\n  ZOOMVIEW_CONTAINER\r\n} from \"../../components/audioManagement/peaksConfig\";\r\nimport Log from \"../../components/log/log\";\r\n\r\ninterface Props {\r\n  url: string;\r\n}\r\n\r\nexport default class WaveView extends Component<Props> {\r\n  shouldComponentUpdate(nextProps: Props) {\r\n    return nextProps.url !== this.props.url;\r\n  }\r\n\r\n  render() {\r\n    Log.info(\"render with url=\" + this.props.url, WaveView.name);\r\n    return (\r\n      <div>\r\n        <div id=\"waveform-container\">\r\n          <div id={ZOOMVIEW_CONTAINER}></div>\r\n          <div id={OVERVIEW_CONTAINER}></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport { hotReloaded, LoadingStatus } from \"../../states/project/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport WaveView from \"./waveView\";\r\n\r\ninterface PropsFromState {\r\n  audioLoaded: LoadingStatus;\r\n  audioUrl: string;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  hotReloaded: typeof hotReloaded;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass WaveContainer extends Component<AllProps> {\r\n  constructor(props: AllProps) {\r\n    super(props);\r\n\r\n    if (process.env.NODE_ENV !== \"production\" && props.audioUrl) {\r\n      Log.info(\"Hot reload with url=\" + props.audioUrl, WaveContainer.name);\r\n      this.props.hotReloaded();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    Log.info(\r\n      \"render with props=\" + JSON.stringify(this.props),\r\n      WaveContainer.name\r\n    );\r\n\r\n    return (\r\n      <div>\r\n        {this.props.audioLoaded !== LoadingStatus.INITIALIZED && (\r\n          <CircularProgress />\r\n        )}\r\n        <WaveView url={this.props.audioUrl} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ project }: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    audioLoaded: project.status\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  hotReloaded\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveContainer);\r\n","import React from \"react\";\r\n\r\nclass VersionInfo extends React.Component<{\r\n  version: string;\r\n  hash: string;\r\n  description: string;\r\n}> {\r\n  render() {\r\n    return (\r\n      <>\r\n        {this.props.version} (\r\n        <a\r\n          href={\"https://github.com/tscz/transcribe/commit/\" + this.props.hash}\r\n        >\r\n          {this.props.hash} - {this.props.description}\r\n        </a>\r\n        )\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default VersionInfo;\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z\"\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z\"\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z\"\n});\n\nvar _ref6 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z\"\n});\n\nvar _ref7 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z\"\n});\n\nvar _ref8 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z\"\n});\n\nvar _ref9 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z\"\n});\n\nvar _ref10 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z\"\n});\n\nvar _ref11 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z\"\n});\n\nvar _ref12 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref13 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref14 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref15 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref16 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref17 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref18 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref19 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref20 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref21 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref22 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref23 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref24 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref25 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref26 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z \"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z\"\n  }), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    d: \"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z\"\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 201.212,\n    cy: 201.242,\n    r: 22.708\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 331.22,\n    cy: 201.242,\n    r: 22.708\n  })), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z\"\n  })), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#C9BCB8\"\n    },\n    d: \"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16, _ref17, _ref18, _ref19, _ref20, _ref21, _ref22, _ref23, _ref24, _ref25, _ref26);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dd187a77.svg\";\nexport { ForwardRef as ReactComponent };","import { Grid } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Button from \"@material-ui/core/Button\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { Theme, WithStyles, withStyles } from \"@material-ui/core/styles\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport MusicVideoIcon from \"@material-ui/icons/MusicVideo\";\nimport PrintIcon from \"@material-ui/icons/Print\";\nimport RadioIcon from \"@material-ui/icons/Radio\";\nimport React from \"react\";\nimport { FunctionComponent } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport DefaultPage from \"../../pages/default/defaultPage\";\nimport DrumPage from \"../../pages/drum/drumPage\";\nimport GuitarPage from \"../../pages/guitar/guitarPage\";\nimport HarmonyPage from \"../../pages/harmony/harmonyPage\";\nimport PrintPage from \"../../pages/print/printPage\";\nimport StructurePage from \"../../pages/structure/structurePage\";\nimport { DialogType, openedDialog } from \"../../states/dialog/dialogsSlice\";\nimport { LoadingStatus } from \"../../states/project/projectSlice\";\nimport { Page, switchedPage } from \"../../states/project/projectSlice\";\nimport { ApplicationState } from \"../../states/store\";\nimport { stylesForApp } from \"../../styles/styles\";\nimport Log from \"../log/log\";\nimport VersionInfo from \"../versionInfo/versionInfo\";\nimport { ReactComponent as Logo } from \"./logo.svg\";\n\ninterface PropsFromState {\n  currentPage: Page;\n  status: LoadingStatus;\n  title: string;\n}\n\ninterface PropsFromDispatch {\n  switchedPage: typeof switchedPage;\n  openedDialog: typeof openedDialog;\n}\n\ninterface Props extends WithStyles<typeof stylesForApp> {\n  theme: Theme;\n}\n\ntype AllProps = Props & PropsFromState & PropsFromDispatch;\n\nclass App extends React.Component<AllProps> {\n  render() {\n    Log.info(\"render\", App.name);\n    return (\n      <>\n        <div className={this.props.classes.root}>\n          <AppBar position=\"fixed\" className={this.props.classes.appBar}>\n            <Toolbar>\n              <Logo height=\"40px\" style={{ marginRight: \"5px\" }}></Logo>\n              <Typography color=\"textPrimary\" variant=\"h4\" noWrap>\n                Transcribe\n              </Typography>\n              <Typography\n                color=\"textPrimary\"\n                variant=\"caption\"\n                noWrap\n                className={this.props.classes.title}\n              >\n                [{this.props.title !== \"\" ? this.props.title : \"no file loaded\"}\n                ]\n              </Typography>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.NEW)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                New\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.OPEN)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                Open\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.SAVE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                Save\n              </Button>\n            </Toolbar>\n          </AppBar>\n          <Drawer\n            className={this.props.classes.drawer}\n            variant=\"permanent\"\n            classes={{\n              paper: this.props.classes.drawerPaper\n            }}\n          >\n            <div className={this.props.classes.toolbar} />\n            <List style={{ color: \"#abb1b7\" }}>\n              <ListItem\n                button\n                key=\"Structure\"\n                onClick={() => this.props.switchedPage(Page.STRUCTURE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <HomeIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Structure\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Harmony\"\n                onClick={() => this.props.switchedPage(Page.HARMONY)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <MusicVideoIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Harmony\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Guitar\"\n                onClick={() => this.props.switchedPage(Page.GUITAR)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <RadioIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Guitar\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Drum\"\n                onClick={() => this.props.switchedPage(Page.DRUM)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <AlbumIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Drum\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Print\"\n                onClick={() => this.props.switchedPage(Page.PRINT)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <PrintIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Print\" />\n              </ListItem>\n            </List>\n          </Drawer>\n          <main className={this.props.classes.content}>\n            <div className={this.props.classes.toolbar} />\n            <Toggle show={this.props.currentPage === Page.DEFAULT}>\n              <DefaultPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.STRUCTURE}>\n              <StructurePage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.HARMONY}>\n              <HarmonyPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.GUITAR}>\n              <GuitarPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.DRUM}>\n              <DrumPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.PRINT}>\n              <PrintPage />\n            </Toggle>\n            <Grid\n              container\n              direction=\"column\"\n              justify=\"flex-end\"\n              alignItems=\"flex-end\"\n              style={{ marginTop: \"20px\" }}\n            >\n              <Grid item>\n                App version:{\" \"}\n                <VersionInfo\n                  version={process.env.REACT_APP_VERSION ?? \"\"}\n                  hash={process.env.REACT_APP_VERSION_HASH ?? \"\"}\n                  description={process.env.REACT_APP_VERSION_DESCRIPTION ?? \"\"}\n                />\n              </Grid>\n            </Grid>\n          </main>\n        </div>\n      </>\n    );\n  }\n}\n\nconst Toggle: FunctionComponent<{ show: boolean }> = props => {\n  if (props.show) {\n    return <div style={{ display: \"inline\" }}>{props.children}</div>;\n  } else {\n    return <div style={{ display: \"none\" }}>{props.children}</div>;\n  }\n};\n\nconst mapStateToProps = ({ project }: ApplicationState) => {\n  return {\n    currentPage: project.currentPage,\n    status: project.status,\n    title: project.title\n  };\n};\n\nconst mapDispatchToProps = {\n  switchedPage,\n  openedDialog\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(stylesForApp, { withTheme: true })(App));\n","import { createStyles, Theme } from \"@material-ui/core/styles\";\r\n\r\nconst drawerWidth = 190;\r\n\r\nexport const stylesForApp = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: \"flex\",\r\n      backgroundColor: \"#d5d8da\"\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      backgroundColor: \"#FFFFFF\"\r\n    },\r\n    drawer: {\r\n      width: drawerWidth,\r\n      flexShrink: 0\r\n    },\r\n    drawerPaper: {\r\n      width: drawerWidth,\r\n      backgroundColor: \"#202a2f\"\r\n    },\r\n    content: {\r\n      flexGrow: 1,\r\n      padding: theme.spacing(3)\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n      marginLeft: \"50px\"\r\n    },\r\n    toolbar: { ...theme.mixins.toolbar }\r\n  });\r\n","import { saveAs } from \"file-saver\";\r\nimport JSZip from \"jszip\";\r\n\r\nimport { PersistedState } from \"../states/store\";\r\n\r\ninterface SaveOptions {\r\n  audioFileUrl: string;\r\n  state: PersistedState;\r\n}\r\n\r\nclass PersistenceApi {\r\n  private constructor() {}\r\n\r\n  private static songFile = \"song.blob\";\r\n  private static stateFile = \"state.json\";\r\n\r\n  static save = async (filename: string, options: SaveOptions) => {\r\n    let zip = new JSZip();\r\n    zip.file(PersistenceApi.stateFile, JSON.stringify(options.state));\r\n\r\n    let response = await fetch(options.audioFileUrl);\r\n    let audioBlob: Blob = await response.blob();\r\n    zip.file(PersistenceApi.songFile, audioBlob);\r\n\r\n    await zip.generateAsync({ type: \"blob\" }).then(file => {\r\n      saveAs(file, filename);\r\n    });\r\n  };\r\n\r\n  static async open(\r\n    zip: File\r\n  ): Promise<{ audioBlob: Blob; state: PersistedState }> {\r\n    let archive = await JSZip.loadAsync(zip);\r\n    let audioBlob = await archive.file(PersistenceApi.songFile).async(\"blob\");\r\n\r\n    let json = await archive.file(PersistenceApi.stateFile).async(\"text\");\r\n    let state: PersistedState = JSON.parse(json);\r\n\r\n    return { audioBlob, state };\r\n  }\r\n\r\n  static revokeLocalFile(url: string) {\r\n    window.URL.revokeObjectURL(url);\r\n  }\r\n\r\n  static getLocalFileUrl(blob: Blob) {\r\n    return window.URL.createObjectURL(blob);\r\n  }\r\n}\r\n\r\nexport default PersistenceApi;\r\n","import {\r\n  createStyles,\r\n  InputBase,\r\n  Theme,\r\n  WithStyles,\r\n  withStyles\r\n} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport MenuIcon from \"@material-ui/icons/OpenInBrowser\";\r\nimport React from \"react\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\n\r\nexport enum FileType {\r\n  AUDIO = \"audio/*\",\r\n  ZIP = \".zip\"\r\n}\r\n\r\nconst toString = (type: FileType) => {\r\n  switch (type) {\r\n    case FileType.AUDIO:\r\n      return \"Audio File\";\r\n    case FileType.ZIP:\r\n      return \"Project Zip File\";\r\n  }\r\n};\r\n\r\ninterface Props extends WithStyles<typeof stylesForFileInput> {\r\n  id: string;\r\n  fileType: FileType;\r\n  callback: (file: File, fileUrl: string) => void;\r\n}\r\n\r\ninterface State {\r\n  display: string;\r\n}\r\n\r\nconst stylesForFileInput = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      padding: \"4px 0px\",\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      width: \"100%\"\r\n    },\r\n    input: {\r\n      marginLeft: theme.spacing(1),\r\n      flex: 1\r\n    },\r\n    iconButton: {\r\n      padding: 10\r\n    }\r\n  });\r\n\r\nclass FileInput extends React.Component<Props, State> {\r\n  state: State = {\r\n    display: \"\"\r\n  };\r\n\r\n  fileInput: React.RefObject<HTMLInputElement>;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.fileInput = React.createRef();\r\n  }\r\n\r\n  handleChange = (fileList: FileList | null) => {\r\n    if (fileList === null) return;\r\n\r\n    var file = fileList[0];\r\n    var fileURL = PersistenceApi.getLocalFileUrl(file);\r\n\r\n    this.setState({ display: file.name });\r\n    this.props.callback(file, fileURL);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Paper component=\"form\" className={this.props.classes.root}>\r\n          <InputBase\r\n            className={this.props.classes.input}\r\n            placeholder={\"Choose \" + toString(this.props.fileType) + \" ...\"}\r\n            inputProps={{\r\n              \"aria-label\": \"Choose \" + toString(this.props.fileType)\r\n            }}\r\n            value={this.state.display}\r\n            readOnly={true}\r\n            onClick={() => this.fileInput.current?.click()}\r\n          />\r\n          <IconButton\r\n            aria-label=\"menu\"\r\n            onClick={() => this.fileInput.current?.click()}\r\n            className={this.props.classes.iconButton}\r\n          >\r\n            <MenuIcon />{\" \"}\r\n          </IconButton>\r\n        </Paper>\r\n        <input\r\n          hidden={true}\r\n          id={this.props.id}\r\n          type=\"file\"\r\n          accept={this.props.fileType}\r\n          ref={this.fileInput}\r\n          onChange={e => this.handleChange(e.target.files)}\r\n        ></input>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(stylesForFileInput, { withTheme: true })(FileInput);\r\n","import { PeaksInstance } from \"peaks.js\";\r\nimport Tone from \"tone\";\r\n\r\ninterface Player {\r\n  destroy: () => void;\r\n  play: () => void;\r\n  pause: () => void;\r\n  isPlaying: () => boolean;\r\n  isSeeking: () => boolean;\r\n  getCurrentTime: () => number;\r\n  getDuration: () => number;\r\n  seek: (time: number) => void;\r\n  setPlaybackRate: (playbackRate: number) => void;\r\n  setDetune: (pitch: number) => void;\r\n}\r\n\r\ninterface EmitAware {\r\n  emit: (id: string, value: any) => void;\r\n}\r\n\r\nexport interface PeaksInstanceEmitAware extends PeaksInstance, EmitAware {}\r\n\r\n/**\r\n * Tone.js Player replacement for the <audio>-element based Peaks.js player\r\n */\r\nclass AudioPlayer implements Player {\r\n  peaks: PeaksInstanceEmitAware;\r\n  player: Tone.Player;\r\n  pitchShift: Tone.PitchShift;\r\n  detune: number;\r\n\r\n  constructor(\r\n    peaks: PeaksInstance,\r\n    audioBuffer: AudioBuffer,\r\n    onSongComplete: () => void\r\n  ) {\r\n    this.peaks = peaks as PeaksInstanceEmitAware;\r\n\r\n    this.player = new Tone.Player(audioBuffer);\r\n    this.player.sync();\r\n    this.player.start();\r\n\r\n    this.pitchShift = new Tone.PitchShift();\r\n    this.detune = 0;\r\n\r\n    Tone.connectSeries(this.player, this.pitchShift, Tone.Master);\r\n\r\n    Tone.Transport.scheduleRepeat(time => {\r\n      this.peaks.emit(\"player_time_update\", this.getCurrentTime());\r\n      if (this.getCurrentTime() >= this.getDuration()) {\r\n        Tone.Transport.stop();\r\n        onSongComplete();\r\n      }\r\n    }, 0.03);\r\n\r\n    this.peaks.emit(\"player_canplay\", this);\r\n  }\r\n\r\n  shiftToSemitones = (shift: number) => 12 * Math.log2(1 / shift);\r\n\r\n  setPlaybackRate(playbackRate: number) {\r\n    this.player.playbackRate = playbackRate;\r\n\r\n    // Detune to keep consistent pitch, even if the playback speed changed\r\n    this.setDetune(this.detune);\r\n\r\n    // Adjust playback to new playbackrate\r\n    if (this.isPlaying()) {\r\n      this.seek(this.getCurrentTime());\r\n    }\r\n  }\r\n\r\n  setDetune(detune: number) {\r\n    this.detune = detune;\r\n\r\n    this.pitchShift.pitch =\r\n      this.shiftToSemitones(this.player.playbackRate) + detune;\r\n  }\r\n\r\n  destroy = () => {\r\n    Tone.context.dispose();\r\n    ((Tone as unknown) as Tone & {\r\n      setContext: (ctx: AudioContext) => void;\r\n    }).setContext(new AudioContext());\r\n  };\r\n\r\n  play = () => {\r\n    Tone.Transport.start(\r\n      Tone.now(),\r\n      this.getCurrentTime() / this.player.playbackRate\r\n    );\r\n    this.peaks.emit(\r\n      \"player_play\",\r\n      this.getCurrentTime() / this.player.playbackRate\r\n    );\r\n  };\r\n\r\n  pause = () => {\r\n    Tone.Transport.pause();\r\n    this.peaks.emit(\"player_pause\", this.getCurrentTime());\r\n  };\r\n\r\n  isPlaying = () => {\r\n    return Tone.Transport.state === \"started\";\r\n  };\r\n\r\n  isSeeking = () => {\r\n    return false;\r\n  };\r\n\r\n  getCurrentTime = () => {\r\n    return (\r\n      this.player.buffer.toSeconds(Tone.Transport.position) *\r\n      this.player.playbackRate\r\n    );\r\n  };\r\n\r\n  getDuration = () => {\r\n    return this.player.buffer.duration;\r\n  };\r\n\r\n  seek = (time: number) => {\r\n    const normalizedTime = time / this.player.playbackRate;\r\n\r\n    Tone.Transport.seconds = normalizedTime;\r\n\r\n    this.peaks.emit(\"player_time_update\", time);\r\n    this.peaks.emit(\"player_seek\", time);\r\n  };\r\n}\r\n\r\nexport default AudioPlayer;\r\n","import Peaks, { PeaksInstance } from \"peaks.js\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Tone from \"tone\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport {\r\n  Measure,\r\n  Section,\r\n  updatedRhythm\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { triggeredPause } from \"../../states/audio/audioSlice\";\r\nimport {\r\n  initializedProject,\r\n  LoadingStatus\r\n} from \"../../states/project/projectSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport Log from \"../log/log\";\r\nimport AudioPlayer from \"./audioPlayer\";\r\nimport PeaksConfig, { AUDIO_DOM_ELEMENT } from \"./peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  audioUrl: string;\r\n  status: LoadingStatus;\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n  syncFirstMeasureStart: boolean;\r\n  isPlaying: boolean;\r\n  detune: number;\r\n  playbackRate: number;\r\n  secondsPerMeasure: number;\r\n  audioSampleRate: number;\r\n  isLooping: boolean;\r\n  loopStart: number;\r\n  loopEnd: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  initializedProject: typeof initializedProject;\r\n  updatedRhythm: typeof updatedRhythm;\r\n  triggeredPause: typeof triggeredPause;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass AudioManagement extends React.Component<AllProps> {\r\n  peaks: Peaks.PeaksInstance | undefined;\r\n  player: AudioPlayer | undefined;\r\n\r\n  private getPeaks = () => this.peaks;\r\n  private getPlayer = () => this.player;\r\n\r\n  componentDidUpdate(prevProps: AllProps) {\r\n    Log.info(\r\n      \"componentDidUpdate with status \" +\r\n        prevProps.status +\r\n        \" -> \" +\r\n        this.props.status,\r\n      AudioManagement.name\r\n    );\r\n\r\n    // Early return if there is no audio file initialized yet.\r\n    if (this.props.status === LoadingStatus.NOT_INITIALIZED) return;\r\n\r\n    // Early return if an initialization is still in progress\r\n    if (\r\n      prevProps.status === this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    )\r\n      return;\r\n\r\n    // Initialize audio management if status changed to init\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    ) {\r\n      Log.info(\"initialize audio engine\", AudioManagement.name);\r\n      if (prevProps.audioUrl !== this.props.audioUrl) {\r\n        Log.info(\r\n          \"switch from \" + prevProps.audioUrl + \" to \" + this.props.audioUrl,\r\n          AudioManagement.name\r\n        );\r\n        PersistenceApi.revokeLocalFile(prevProps.audioUrl);\r\n      }\r\n      this.init();\r\n      return;\r\n    }\r\n\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZED\r\n    ) {\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.secondsPerMeasure\r\n      );\r\n    }\r\n\r\n    if (\r\n      prevProps.sections !== this.props.sections ||\r\n      prevProps.measures !== this.props.measures\r\n    ) {\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.secondsPerMeasure\r\n      );\r\n    }\r\n\r\n    if (prevProps.playbackRate !== this.props.playbackRate) {\r\n      this.getPlayer()?.setPlaybackRate(this.props.playbackRate);\r\n    }\r\n\r\n    if (prevProps.detune !== this.props.detune) {\r\n      this.getPlayer()?.setDetune(this.props.detune);\r\n    }\r\n\r\n    if (prevProps.isPlaying !== this.props.isPlaying) {\r\n      if (this.props.isPlaying) {\r\n        this.getPlayer()?.play();\r\n      } else {\r\n        this.getPlayer()?.pause();\r\n      }\r\n    }\r\n\r\n    if (\r\n      prevProps.loopStart !== this.props.loopStart ||\r\n      prevProps.loopEnd !== this.props.loopEnd\r\n    ) {\r\n      this.setZoom(this.props.loopStart, this.props.loopEnd);\r\n    }\r\n  }\r\n\r\n  private repaintWaveform(\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>,\r\n    timePerMeasure: number\r\n  ) {\r\n    this.getPeaks()?.segments.removeAll();\r\n    this.getPeaks()?.segments.add(\r\n      PeaksConfig.sectionsToSegment(sections, measures, timePerMeasure)\r\n    );\r\n    this.getPeaks()?.points.removeAll();\r\n    this.getPeaks()?.points.add(PeaksConfig.measuresToPoints(measures));\r\n  }\r\n\r\n  private init = () => {\r\n    const audioCtx: AudioContext = (Tone.context as unknown) as AudioContext;\r\n\r\n    this.getPeaks()?.destroy();\r\n\r\n    let audio = this;\r\n\r\n    // Load audioFile into audio buffer\r\n    fetch(this.props.audioUrl)\r\n      .then(function(response) {\r\n        return response.arrayBuffer();\r\n      })\r\n      .then(function(buffer) {\r\n        return audioCtx.decodeAudioData(buffer);\r\n      })\r\n      .then(function(audioBuffer) {\r\n        audio.initPeaks(audioBuffer);\r\n      });\r\n  };\r\n\r\n  private initPeaks(audioBuffer: AudioBuffer) {\r\n    Log.info(\"init peaks\", AudioManagement.name);\r\n\r\n    Peaks.init(PeaksConfig.create(audioBuffer), (err, peaks) => {\r\n      if (err) throw err;\r\n      if (peaks === undefined)\r\n        throw new Error(\"Peaks instance is not correctly initialized.\");\r\n\r\n      initPlayer(peaks, audioBuffer);\r\n      replacePlayer(peaks, audioBuffer);\r\n\r\n      peaks.on(\"player_seek\", (time: number) => {\r\n        if (this.props.syncFirstMeasureStart)\r\n          this.props.updatedRhythm({ firstMeasureStart: time });\r\n      });\r\n\r\n      this.peaks = peaks;\r\n\r\n      this.props.initializedProject({\r\n        audioDuration: audioBuffer.duration,\r\n        audioSampleRate: audioBuffer.sampleRate\r\n      });\r\n    });\r\n\r\n    let initPlayer = (peaks: Peaks.PeaksInstance, audioBuffer: AudioBuffer) => {\r\n      this.player = new AudioPlayer(peaks, audioBuffer, () =>\r\n        this.props.triggeredPause()\r\n      );\r\n    };\r\n\r\n    let replacePlayer = (\r\n      peaks: Peaks.PeaksInstance,\r\n      audioBuffer: AudioBuffer\r\n    ) => {\r\n      (peaks.player as any).destroy();\r\n      peaks.player = (this.player as unknown) as PeaksInstance[\"player\"];\r\n    };\r\n  }\r\n\r\n  private setZoom(start: number, end: number) {\r\n    const zoomview = this.getPeaks()?.views.getView(\"zoomview\")!;\r\n    const duration = end - start;\r\n    zoomview.setZoom({ seconds: duration });\r\n    (zoomview as any).setStartTime(start);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <audio id={AUDIO_DOM_ELEMENT} controls hidden>\r\n        {this.props.audioUrl ? (\r\n          <source src={this.props.audioUrl} type=\"audio/mpeg\" />\r\n        ) : null}\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ project, analysis, audio }: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    sections: analysis.sections,\r\n    measures: analysis.measures,\r\n    status: project.status,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    isPlaying: audio.isPlaying,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate,\r\n    secondsPerMeasure:\r\n      analysis.measures.byId[\"1\"]?.time - analysis.measures.byId[\"0\"]?.time,\r\n    audioSampleRate: analysis.audioSampleRate,\r\n    isLooping: audio.isLooping,\r\n    loopStart: audio.loopStart,\r\n    loopEnd: audio.loopEnd\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  initializedProject,\r\n  updatedRhythm,\r\n  triggeredPause\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AudioManagement);\r\n","import { configureStore, createAction } from \"@reduxjs/toolkit\";\r\nimport { AnyAction, combineReducers, Reducer } from \"redux\";\r\n\r\nimport analysisReducer, { AnalysisState } from \"./analysis/analysisSlice\";\r\nimport audioReducer, { AudioState } from \"./audio/audioSlice\";\r\nimport dialogReducer, { DialogState } from \"./dialog/dialogsSlice\";\r\nimport projectReducer, { ProjectState } from \"./project/projectSlice\";\r\n\r\n/** The top-level application state object. */\r\nexport interface ApplicationState {\r\n  analysis: AnalysisState;\r\n  audio: AudioState;\r\n  dialog: DialogState;\r\n  project: ProjectState;\r\n}\r\n\r\nexport interface PersistedState {\r\n  analysis: AnalysisState;\r\n  project: ProjectState;\r\n}\r\n\r\nexport interface NormalizedObjects<T> {\r\n  byId: { [id: string]: T };\r\n  allIds: string[];\r\n}\r\n\r\nexport const restoredPersistedState = createAction<PersistedState>(\r\n  \"restoredPersistedState\"\r\n);\r\n\r\nexport const createRootReducer: Reducer<ApplicationState, AnyAction> = (\r\n  state,\r\n  action\r\n) => {\r\n  state = sliceReducer(state, action);\r\n\r\n  if (restoredPersistedState.match(action)) {\r\n    return state;\r\n  }\r\n\r\n  return state;\r\n};\r\n\r\nexport const sliceReducer = combineReducers({\r\n  analysis: analysisReducer,\r\n  audio: audioReducer,\r\n  dialog: dialogReducer,\r\n  project: projectReducer\r\n});\r\n\r\nconst createAppStore = () => {\r\n  const store = configureStore({\r\n    reducer: createRootReducer,\r\n    preloadedState: undefined\r\n  });\r\n\r\n  if (process.env.NODE_ENV !== \"production\" && module.hot) {\r\n    module.hot.accept(\"./store\", () => store.replaceReducer(createRootReducer));\r\n  }\r\n  return store;\r\n};\r\n\r\nexport default createAppStore();\r\n","import {\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText\r\n} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport interface DialogAction {\r\n  label: string;\r\n  onClick: () => void;\r\n  disabled?: boolean;\r\n}\r\n\r\ninterface ModalDialogProps {\r\n  title: string;\r\n  subTitle?: string;\r\n  onCancel: () => void;\r\n  actions?: DialogAction[];\r\n}\r\n\r\nclass ModalDialog extends Component<ModalDialogProps> {\r\n  render() {\r\n    return (\r\n      <Dialog\r\n        onClose={this.props.onCancel}\r\n        open={true}\r\n        fullWidth={true}\r\n        maxWidth={\"sm\"}\r\n      >\r\n        <DialogTitle>{this.props.title}</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>{this.props.subTitle}</DialogContentText>\r\n          {this.props.children}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          {this.props.actions?.map((value, index) => (\r\n            <Button\r\n              key={value.label}\r\n              onClick={value.onClick}\r\n              color=\"primary\"\r\n              disabled={value.disabled ?? false}\r\n            >\r\n              {value.label}\r\n            </Button>\r\n          ))}\r\n        </DialogActions>\r\n      </Dialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ModalDialog;\r\n","import { FormLabel } from \"@material-ui/core\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport React, { Component, FunctionComponent, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport {\r\n  addedSection,\r\n  initialAnalysisState,\r\n  SectionType\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { closedDialog, DialogType } from \"../../states/dialog/dialogsSlice\";\r\nimport {\r\n  createdProject,\r\n  initialProjectState,\r\n  Page,\r\n  switchedPage\r\n} from \"../../states/project/projectSlice\";\r\nimport store, { ApplicationState } from \"../../states/store\";\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\nimport FileInput, { FileType } from \"../fileInput/fileInput\";\r\nimport MeasureSelect from \"../measureSelect/measureSelect\";\r\nimport ModalDialog, { DialogAction } from \"../modalDialog/modalDialog\";\r\nimport SectionSelect from \"../sectionSelect/sectionSelect\";\r\n\r\ninterface PropsFromState {\r\n  type: DialogType;\r\n  audioUrl: string;\r\n  maxMeasure: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  switchedPage: typeof switchedPage;\r\n  closedDialog: typeof closedDialog;\r\n  createdProject: typeof createdProject;\r\n  addedSection: typeof addedSection;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass DialogManagement extends Component<AllProps> {\r\n  render() {\r\n    switch (this.props.type) {\r\n      case DialogType.NONE:\r\n        return null;\r\n      case DialogType.NEW:\r\n        return (\r\n          <NewDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(title: string, audioUrl: string) => {\r\n              this.props.createdProject({\r\n                analysis: initialAnalysisState,\r\n                project: { ...initialProjectState, audioUrl, title }\r\n              });\r\n              this.props.switchedPage(Page.STRUCTURE);\r\n              this.props.closedDialog();\r\n            }}\r\n          ></NewDialog>\r\n        );\r\n      case DialogType.OPEN:\r\n        return (\r\n          <OpenDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(zip: File, zipUrl: string) => {\r\n              PersistenceApi.open(zip).then(({ audioBlob, state }) => {\r\n                let audioUrl = PersistenceApi.getLocalFileUrl(audioBlob);\r\n                PersistenceApi.revokeLocalFile(zipUrl);\r\n\r\n                this.props.createdProject({\r\n                  analysis: state.analysis,\r\n                  project: { ...state.project, audioUrl }\r\n                });\r\n                this.props.switchedPage(Page.STRUCTURE);\r\n                this.props.closedDialog();\r\n              });\r\n            }}\r\n          ></OpenDialog>\r\n        );\r\n      case DialogType.SAVE:\r\n        return (\r\n          <ModalDialog\r\n            title=\"Save Transcription\"\r\n            subTitle=\"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.\"\r\n            onCancel={() => this.props.closedDialog()}\r\n            actions={[\r\n              {\r\n                label: \"Cancel\",\r\n                onClick: () => this.props.closedDialog()\r\n              },\r\n              {\r\n                label: \"Save\",\r\n                onClick: () => {\r\n                  PersistenceApi.save(\"transcription.zip\", {\r\n                    audioFileUrl: this.props.audioUrl,\r\n                    state: store.getState()\r\n                  });\r\n                  this.props.closedDialog();\r\n                }\r\n              }\r\n            ]}\r\n          ></ModalDialog>\r\n        );\r\n      case DialogType.ADD_SECTION:\r\n        return (\r\n          <AddSectionDialog\r\n            maxMeasure={this.props.maxMeasure}\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(sectionType, start, end) => {\r\n              this.props.addedSection({\r\n                measures: ArrayUtil.range(start, end),\r\n                type: sectionType\r\n              });\r\n              this.props.closedDialog();\r\n            }}\r\n          ></AddSectionDialog>\r\n        );\r\n      default:\r\n        throw Error();\r\n    }\r\n  }\r\n}\r\n\r\nconst NewDialog: FunctionComponent<{\r\n  onSubmit: (title: string, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [title, setTitle] = useState(\"\");\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Create\",\r\n        onClick: () => props.onSubmit(title, fileUrl),\r\n        disabled: fileUrl === \"\" || title === \"\"\r\n      }\r\n    ];\r\n  };\r\n\r\n  const handleTitleChange = (event: any) => setTitle(event.target.value);\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Create new Transcription\"\r\n      subTitle=\"Please add a project title and select an audio file from your hard disk below.\"\r\n      actions={actions()}\r\n      onCancel={props.onCancel}\r\n    >\r\n      <FormControl fullWidth>\r\n        <TextField\r\n          id=\"title\"\r\n          label=\"Project title\"\r\n          margin=\"normal\"\r\n          InputProps={{\r\n            readOnly: false\r\n          }}\r\n          variant=\"outlined\"\r\n          onChange={handleTitleChange}\r\n        />\r\n        <FileInput\r\n          fileType={FileType.AUDIO}\r\n          id=\"audio_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst OpenDialog: FunctionComponent<{\r\n  onSubmit: (file: File, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [file, setFile] = useState<File>();\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Open\",\r\n        onClick: () => props.onSubmit(file!, fileUrl),\r\n        disabled: fileUrl === \"\"\r\n      }\r\n    ];\r\n  };\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Open Transcription\"\r\n      subTitle=\"Please select a project zip file from your hard disk below.\"\r\n      onCancel={props.onCancel}\r\n      actions={actions()}\r\n    >\r\n      <FormControl fullWidth>\r\n        <FileInput\r\n          fileType={FileType.ZIP}\r\n          id=\"zip_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n            setFile(file);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst AddSectionDialog: FunctionComponent<{\r\n  maxMeasure: number;\r\n  onSubmit: (sectionType: SectionType, start: number, end: number) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [sectionType, setSectionType] = useState(SectionType.INTRO);\r\n  const [start, setStart] = useState(0);\r\n  const [end, setEnd] = useState(0);\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Add\",\r\n        onClick: () => props.onSubmit(sectionType, start, end),\r\n        disabled: sectionType === SectionType.UNDEFINED || start > end\r\n      }\r\n    ];\r\n  };\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Add new Section\"\r\n      subTitle=\"Please define section and add it to the song structure.\"\r\n      actions={actions()}\r\n      onCancel={props.onCancel}\r\n    >\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">Section Type</FormLabel>\r\n        <SectionSelect\r\n          value={sectionType}\r\n          onChange={sectionType => setSectionType(sectionType)}\r\n        ></SectionSelect>\r\n      </FormControl>\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">First Measure</FormLabel>\r\n        <MeasureSelect\r\n          value={start}\r\n          min={0}\r\n          max={props.maxMeasure}\r\n          onChange={value => setStart(value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">Last Measure</FormLabel>\r\n        <MeasureSelect\r\n          value={end}\r\n          min={0}\r\n          max={props.maxMeasure}\r\n          onChange={value => setEnd(value)}\r\n        />\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ dialog, project, analysis }: ApplicationState) => {\r\n  return {\r\n    type: dialog.currentDialog,\r\n    audioUrl: project.audioUrl,\r\n    maxMeasure: analysis.measures.allIds.length - 1\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  closedDialog,\r\n  switchedPage,\r\n  createdProject,\r\n  addedSection\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogManagement);\r\n","import blueGrey from \"@material-ui/core/colors/blueGrey\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"light\",\n    primary: blueGrey\n  }\n});\n\nexport default theme;\n","import CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport React from \"react\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport App from \"./components/app/app\";\nimport AudioManagement from \"./components/audioManagement/audioManagement\";\nimport DialogManagement from \"./components/dialogManagement/dialogManagement\";\nimport store from \"./states/store\";\nimport theme from \"./styles/theme\";\n\nif (process.env.NODE_ENV !== \"production\") {\n  localStorage.setItem(\"debug\", \"transcribe:*\");\n}\n\nconst renderApp = () =>\n  render(\n    <Provider store={store}>\n      <ThemeProvider theme={theme}>\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n        <CssBaseline />\n        <AudioManagement />\n        <DialogManagement />\n        <App />\n      </ThemeProvider>\n    </Provider>,\n    document.getElementById(\"root\")\n  );\n\nif (process.env.NODE_ENV !== \"production\" && module.hot) {\n  module.hot.accept(\"./components/app/app\", renderApp);\n}\n\nrenderApp();\n"],"sourceRoot":""}