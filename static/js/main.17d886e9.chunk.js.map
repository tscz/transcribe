{"version":3,"sources":["components/log/log.ts","components/view/view.tsx","pages/default/defaultPage.tsx","pages/drum/drumPage.tsx","pages/guitar/guitarPage.tsx","pages/harmony/harmonyPage.tsx","pages/print/printPage.tsx","components/contentLayout/contentLayout.tsx","states/project/projectSlice.ts","states/audio/audioSlice.ts","states/wave/waveSlice.ts","components/measureSelect/measureSelect.tsx","util/ArrayUtil.ts","states/analysis/analysisSlice.ts","states/analysis/analysisUtil.ts","components/audioManagement/peaksConfig.ts","states/dialog/dialogsSlice.ts","components/sectionSelect/sectionSelect.tsx","views/structure/structureView.tsx","components/sectionOverview/sectionOverview.tsx","views/structureNavigation/structureNavigationView.tsx","views/wave/waveView.tsx","views/wave/waveContainer.tsx","views/waveControl/waveControlView.tsx","pages/structure/structurePage.tsx","components/versionInfo/versionInfo.tsx","components/app/logo.svg","components/app/app.tsx","styles/styles.ts","api/persistenceApi.ts","components/fileInput/fileInput.tsx","components/audioManagement/audioPlayer.ts","components/audioManagement/audioManagement.tsx","states/store.ts","components/modalDialog/modalDialog.tsx","components/dialogManagement/dialogManagement.tsx","styles/theme.ts","index.tsx"],"names":["Level","View","Card","style","height","backgroundColor","raised","CardHeader","titleTypographyProps","variant","title","this","props","padding","action","CardContent","body","Component","DefaultPage","React","DrumPage","GuitarPage","HarmonyPage","PrintPage","ContentLayout","Grid","container","spacing","alignItems","item","xs","topLeft","topRight","bottom","LoadingStatus","Page","LEVEL_TO_COLOR","Map","TRACE","INFO","WARN","ERROR","Log","level","message","source","namespace","createDebug","debug","color","get","generateMessage","audioSlice","createSlice","name","initialState","isPlaying","detune","playbackRate","reducers","triggeredPlay","state","triggeredPause","updatedPlaybackSettings","undefined","payload","actions","initialProjectState","status","NOT_INITIALIZED","currentPage","DEFAULT","audioUrl","syncFirstMeasureStart","projectSlice","switchedPage","createdProject","project","INITIALIZING","hotReloaded","initializedProject","INITIALIZED","enabledSyncFirstMeasureStart","waveSlice","zoom","zoomedOut","zoomedIn","MeasureSelect","value","onChange","event","newMeasure","target","minWidth","disabled","Array","max","min","fill","map","_","idx","MenuItem","key","ArrayUtil","range","start","end","toString","bordersOf","array","parseInt","last","length","TimeSignatureType","SectionType","replaceSections","sections","deleteCount","newSections","section","byId","allIds","ids","forEach","id","generateSectionId","push","splice","type","measures","distributeMeasures","timeSignatureType","bpm","firstMeasureStart","lengthOfOneMeasure","FOUR_FOUR","beatUnit","beatsPerMeasure","THREE_FOUR","toTimeSignature","index","time","editable","labelText","initialAnalysisState","audioDuration","audioSampleRate","timeSignature","analysisSlice","extraReducers","builder","addCase","analysis","undefinedSectionId","UNDEFINED","undefinedSection","addedSection","addSection","updatedSection","removeSection","before","after","removedSection","updatedRhythm","lastSection","newLastSection","removeSectionsAfterLastMeasure","lastMeasure","removalStart","removalStartMeasure","newSection","enclosingSection","allSections","newSectionStart","newSectionEnd","sectionCount","current","currentSectionEnd","position","enclosingSectionOf","mergedSections","embeddedSection","currentSectionStart","mergeSections","sectionId","indexOf","firstMeasure","removalCount","PeaksConfig","create","audioBuffer","mediaelement","document","getElementById","containers","zoomview","overview","mediaElement","webAudio","scale","multiChannel","keyboard","pointMarkerColor","showPlayheadTime","zoomLevels","sectionsToSegment","timePerMeasure","segments","segment","startTime","endTime","SECTIONTYPE_TO_COLOR","measuresToPoints","points","point","computeZoomLevels","secondsPerMeasure","zoomviewWidth","measuresCount","baseZoom","Math","floor","levels","INTRO","VERSE","PRECHORUS","CHORUS","SOLO","OUTRO","BRIDGE","DialogType","SectionSelect","Object","values","sectionType","initialDialogState","currentDialog","NONE","dialogsSlice","openedDialog","closedDialog","StructureView","handleAddSection","handleUpdatedSection","info","JSON","stringify","handleRemoveSection","TableContainer","component","Paper","Table","size","TableHead","TableRow","TableCell","width","TableBody","scope","IconButton","onClick","measure","ADD_SECTION","mapDispatchToProps","connect","SectionOverview","direction","Typography","toLowerCase","marginBottom","arr","res","i","slice","generateMatrix","row","ButtonGroup","orientation","measureId","bg","Square","Button","StructureNavigationView","WaveView","nextProps","url","WaveContainer","audioLoaded","CircularProgress","WaveControlView","handleTimeSignatureChange","e","handleBpmChange","isArray","handleDetuneChange","handlePlaybackRateChange","FormControl","fullWidth","InputLabel","Input","startAdornment","InputAdornment","Tooltip","ToggleButton","selected","step","NativeSelect","SliderInput","shrink","Box","mt","Slider","valueLabelDisplay","audio","wave","StructurePage","anchorEl","handleClick","setState","currentTarget","handleClose","icon","Popover","open","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","WaveformControlButton","marginTop","marginRight","loaded","VersionInfo","version","href","hash","description","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","d","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref17","_ref18","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","_ref25","_ref26","_ref","svgRef","x","y","viewBox","enableBackground","xmlSpace","ref","cx","cy","r","ForwardRef","forwardRef","App","className","classes","root","AppBar","appBar","Toolbar","noWrap","NEW","OPEN","SAVE","Drawer","drawer","paper","drawerPaper","toolbar","List","ListItem","button","STRUCTURE","ListItemIcon","ListItemText","primary","HARMONY","GUITAR","DRUM","PRINT","content","show","justify","process","Toggle","display","children","withStyles","theme","createStyles","zIndex","flexShrink","flexGrow","mixins","marginLeft","withTheme","PersistenceApi","zip","JSZip","loadAsync","archive","file","songFile","async","audioBlob","stateFile","json","parse","window","URL","revokeObjectURL","blob","createObjectURL","save","filename","options","a","fetch","audioFileUrl","response","generateAsync","then","saveAs","FileType","AudioPlayer","peaks","onSongComplete","player","pitchShift","shiftToSemitones","shift","log2","destroy","Tone","context","dispose","setContext","AudioContext","play","Transport","now","getCurrentTime","emit","pause","isSeeking","buffer","toSeconds","getDuration","duration","seek","normalizedTime","stop","Player","sync","PitchShift","connectSeries","Master","scheduleRepeat","pitch","AudioManagement","getPeaks","getPlayer","init","audioCtx","arrayBuffer","decodeAudioData","initPeaks","prevProps","revokeLocalFile","recomputeZoomlevels","repaintWaveform","zoomLevel","setPlaybackRate","setDetune","newZoomLevels","clientWidth","setZoomLevels","removeAll","add","setZoom","Peaks","err","Error","initPlayer","replacePlayer","on","sampleRate","controls","hidden","src","restoredPersistedState","createAction","createRootReducer","sliceReducer","match","combineReducers","analysisReducer","audioReducer","dialog","dialogReducer","projectReducer","waveReducer","createAppStore","configureStore","reducer","preloadedState","AUDIO","ZIP","FileInput","fileInput","handleChange","fileList","fileURL","getLocalFileUrl","callback","createRef","InputBase","input","placeholder","fileType","inputProps","readOnly","click","aria-label","iconButton","accept","files","flex","ModalDialog","Dialog","onCancel","maxWidth","DialogTitle","DialogContent","DialogContentText","subTitle","DialogActions","label","DialogManagement","onSubmit","zipUrl","store","getState","maxMeasure","NewDialog","useState","fileUrl","setFileUrl","setTitle","TextField","margin","InputProps","OpenDialog","setFile","AddSectionDialog","setSectionType","setStart","setEnd","FormLabel","createMuiTheme","palette","blueGrey","render","ThemeProvider","CssBaseline"],"mappings":"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","file":"static/js/main.17d886e9.chunk.js","sourcesContent":["import debug from \"debug\";\r\n\r\nenum Level {\r\n  TRACE = \"trace\",\r\n  INFO = \"info\",\r\n  WARN = \"warn\",\r\n  ERROR = \"error\"\r\n}\r\n\r\nconst LEVEL_TO_COLOR = new Map<Level, string>([\r\n  [Level.TRACE, \"lightblue\"],\r\n  [Level.INFO, \"blue\"],\r\n  [Level.WARN, \"yellow\"],\r\n  [Level.ERROR, \"red\"]\r\n]) as ReadonlyMap<Level, string>;\r\n\r\nclass Log {\r\n  private static generateMessage(\r\n    level: Level,\r\n    message: string,\r\n    source: string\r\n  ) {\r\n    const namespace = `transcribe:${level}`;\r\n    const createDebug = debug(namespace);\r\n\r\n    createDebug.color = LEVEL_TO_COLOR.get(level)!;\r\n\r\n    if (source) {\r\n      createDebug(source, message);\r\n    } else {\r\n      createDebug(message);\r\n    }\r\n  }\r\n\r\n  static trace(message: string, source: string) {\r\n    return this.generateMessage(Level.TRACE, message, source);\r\n  }\r\n\r\n  static info(message: string, source: string) {\r\n    return this.generateMessage(Level.INFO, message, source);\r\n  }\r\n\r\n  static warn(message: string, source: string) {\r\n    return this.generateMessage(Level.WARN, message, source);\r\n  }\r\n\r\n  static error(message: string, source: string) {\r\n    return this.generateMessage(Level.ERROR, message, source);\r\n  }\r\n}\r\n\r\nexport default Log;\r\n","import { CardHeader } from \"@material-ui/core\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport React, { Component, ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  body: ReactElement;\r\n  title: string;\r\n  action?: ReactElement;\r\n}\r\n\r\nclass View extends Component<Props> {\r\n  render() {\r\n    return (\r\n      <Card\r\n        style={{\r\n          height: \"100%\",\r\n          backgroundColor: \"#ffffff\"\r\n        }}\r\n        raised={false}\r\n      >\r\n        <CardHeader\r\n          titleTypographyProps={{ variant: \"subtitle1\" }}\r\n          title={this.props.title}\r\n          style={{ backgroundColor: \"#f1f4f6\", padding: \"4px\" }}\r\n          action={this.props.action}\r\n        />\r\n        <CardContent>{this.props.body}</CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default View;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DefaultPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Info\"\r\n        body={\r\n          <>\r\n            <p>No Transcription started!!</p>\r\n            <p>Please create a new Transcription or open an existing one.</p>\r\n          </>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DefaultPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DrumPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Drums View\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the drum part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DrumPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass GuitarPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Guitar\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the guitar part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GuitarPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass HarmonyPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Harmony\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the harmony. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HarmonyPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass PrintPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Print\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to print the leadsheet. Please come\r\n            back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PrintPage;\r\n","import Grid from \"@material-ui/core/Grid\";\r\nimport React, { ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  topLeft: ReactElement;\r\n  topRight: ReactElement;\r\n  bottom?: ReactElement;\r\n}\r\n\r\nclass ContentLayout extends React.Component<Props> {\r\n  render() {\r\n    return (\r\n      <Grid container spacing={2} alignItems=\"stretch\">\r\n        <Grid item xs={9}>\r\n          {this.props.topLeft}\r\n        </Grid>\r\n        <Grid item xs={3}>\r\n          {this.props.topRight}\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          {this.props.bottom}\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ContentLayout;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nimport { PersistedState } from \"../store\";\r\n\r\nexport interface ProjectState {\r\n  readonly status: LoadingStatus;\r\n  readonly currentPage: Page;\r\n  readonly title: string;\r\n  readonly audioUrl: string;\r\n  readonly syncFirstMeasureStart: boolean;\r\n}\r\n\r\nexport enum LoadingStatus {\r\n  NOT_INITIALIZED = \"not_initialized\",\r\n  INITIALIZING = \"initializing\",\r\n  INITIALIZED = \"initialized\"\r\n}\r\n\r\nexport enum Page {\r\n  DEFAULT = \"default\",\r\n  STRUCTURE = \"structure\",\r\n  HARMONY = \"harmony\",\r\n  GUITAR = \"guitar\",\r\n  DRUM = \"drum\",\r\n  PRINT = \"print\"\r\n}\r\n\r\nexport const initialProjectState: ProjectState = {\r\n  status: LoadingStatus.NOT_INITIALIZED,\r\n  currentPage: Page.DEFAULT,\r\n  title: \"\",\r\n  audioUrl: \"\",\r\n  syncFirstMeasureStart: false\r\n};\r\n\r\nconst projectSlice = createSlice({\r\n  name: \"project\",\r\n  initialState: initialProjectState,\r\n  reducers: {\r\n    switchedPage(state, action: PayloadAction<Page>) {\r\n      state.currentPage = action.payload;\r\n    },\r\n    createdProject(state, action: PayloadAction<PersistedState>) {\r\n      return { ...action.payload.project, status: LoadingStatus.INITIALIZING };\r\n    },\r\n    hotReloaded(state) {\r\n      state.status = LoadingStatus.INITIALIZING;\r\n    },\r\n    initializedProject(\r\n      state,\r\n      action: PayloadAction<{ audioDuration: number; audioSampleRate: number }>\r\n    ) {\r\n      state.status = LoadingStatus.INITIALIZED;\r\n    },\r\n    enabledSyncFirstMeasureStart(state, action: PayloadAction<boolean>) {\r\n      state.syncFirstMeasureStart = action.payload;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  switchedPage,\r\n  createdProject,\r\n  initializedProject,\r\n  hotReloaded,\r\n  enabledSyncFirstMeasureStart\r\n} = projectSlice.actions;\r\n\r\nexport default projectSlice.reducer;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface AudioState {\r\n  readonly isPlaying: boolean;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n}\r\n\r\nexport interface PlaybackSettings {\r\n  readonly detune?: number;\r\n  readonly playbackRate?: number;\r\n}\r\n\r\nexport const initialAudioState: AudioState = {\r\n  isPlaying: false,\r\n  detune: 0,\r\n  playbackRate: 1\r\n};\r\n\r\nconst audioSlice = createSlice({\r\n  name: \"audio\",\r\n  initialState: initialAudioState,\r\n  reducers: {\r\n    triggeredPlay(state) {\r\n      state.isPlaying = true;\r\n    },\r\n    triggeredPause(state) {\r\n      state.isPlaying = false;\r\n    },\r\n    updatedPlaybackSettings(\r\n      state,\r\n      action: PayloadAction<{ playbackRate?: number; detune?: number }>\r\n    ) {\r\n      if (action.payload.detune !== undefined)\r\n        state.detune = action.payload.detune;\r\n      if (action.payload.playbackRate !== undefined)\r\n        state.playbackRate = action.payload.playbackRate;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  triggeredPause,\r\n  triggeredPlay,\r\n  updatedPlaybackSettings\r\n} = audioSlice.actions;\r\n\r\nexport default audioSlice.reducer;\r\n","import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport interface WaveState {\r\n  readonly zoom: number;\r\n}\r\n\r\nexport const initialWaveState: WaveState = {\r\n  zoom: 0\r\n};\r\n\r\nconst waveSlice = createSlice({\r\n  name: \"wave\",\r\n  initialState: initialWaveState,\r\n  reducers: {\r\n    zoomedOut(state) {\r\n      state.zoom =\r\n        state.zoom === 42 //TODO: use max zoomlevel here, which is dynamic\r\n          ? state.zoom\r\n          : state.zoom + 1;\r\n    },\r\n    zoomedIn(state) {\r\n      state.zoom = state.zoom === 0 ? state.zoom : state.zoom - 1;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { zoomedIn, zoomedOut } = waveSlice.actions;\r\n\r\nexport default waveSlice.reducer;\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nconst MeasureSelect: FunctionComponent<{\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  onChange: (value: number) => void;\r\n  disabled?: boolean;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newMeasure = event.target.value as number;\r\n    props.onChange(newMeasure);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        minWidth: \"40px\"\r\n      }}\r\n      disabled={props.disabled}\r\n    >\r\n      {new Array<number>(props.max - props.min + 1)\r\n        .fill(0)\r\n        .map((_, idx: number) => {\r\n          return (\r\n            <MenuItem key={props.min + idx} value={props.min + idx}>\r\n              {props.min + idx}\r\n            </MenuItem>\r\n          );\r\n        })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default MeasureSelect;\r\n","class ArrayUtil {\r\n  static range: (start: number, end: number) => string[] = (start, end) => {\r\n    if (start > end) start = end;\r\n\r\n    return Array(end - start + 1)\r\n      .fill(start)\r\n      .map((_, idx) => (start + idx).toString());\r\n  };\r\n\r\n  static bordersOf: (\r\n    array: Array<any>\r\n  ) => { start: number; end: number } = array => {\r\n    return {\r\n      start: parseInt(array[0]),\r\n      end: parseInt(ArrayUtil.last(array))\r\n    };\r\n  };\r\n\r\n  static last: <T>(array: Array<T>) => T = array => {\r\n    return array[array.length - 1];\r\n  };\r\n}\r\n\r\nexport default ArrayUtil;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { PointAddOptions } from \"peaks.js\";\r\n\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\nimport { createdProject, initializedProject } from \"../project/projectSlice\";\r\nimport { NormalizedObjects } from \"../store\";\r\nimport {\r\n  distributeMeasures,\r\n  enclosingSectionOf,\r\n  generateSectionId,\r\n  mergeSections,\r\n  replaceSections,\r\n  sectionInvalid,\r\n  undefinedSection\r\n} from \"./analysisUtil\";\r\n\r\nexport interface AnalysisState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly audioDuration: number;\r\n  readonly audioSampleRate: number;\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly measures: NormalizedObjects<Measure>;\r\n}\r\n\r\nexport interface Section {\r\n  type: SectionType;\r\n  measures: string[];\r\n}\r\n\r\nexport interface Measure extends PointAddOptions {}\r\n\r\nexport interface TimeSignature {\r\n  beatsPerMeasure: number;\r\n  beatUnit: number;\r\n}\r\n\r\nexport enum TimeSignatureType {\r\n  FOUR_FOUR = \"FOUR_FOUR\",\r\n  THREE_FOUR = \"THREE_FOUR\"\r\n}\r\n\r\nexport enum SectionType {\r\n  INTRO = \"INTRO\",\r\n  VERSE = \"VERSE\",\r\n  PRECHORUS = \"PRECHORUS\",\r\n  CHORUS = \"CHORUS\",\r\n  BRIDGE = \"BRIDGE\",\r\n  SOLO = \"SOLO\",\r\n  OUTRO = \"OUTRO\",\r\n  UNDEFINED = \"UNDEFINED\"\r\n}\r\n\r\nexport const initialAnalysisState: AnalysisState = {\r\n  sections: { allIds: [], byId: {} },\r\n  bpm: 120,\r\n  firstMeasureStart: 0,\r\n  audioDuration: 180,\r\n  audioSampleRate: 44400,\r\n  measures: { allIds: [], byId: {} },\r\n  timeSignature: TimeSignatureType.FOUR_FOUR\r\n};\r\n\r\nconst analysisSlice = createSlice({\r\n  name: \"analysis\",\r\n  initialState: initialAnalysisState,\r\n  extraReducers: builder =>\r\n    builder\r\n      .addCase(createdProject, (state, action) => {\r\n        return action.payload.analysis;\r\n      })\r\n      .addCase(initializedProject, (state, action) => {\r\n        state.audioDuration = action.payload.audioDuration;\r\n        state.audioSampleRate = action.payload.audioSampleRate;\r\n\r\n        state.measures = distributeMeasures(\r\n          state.timeSignature,\r\n          state.bpm,\r\n          state.firstMeasureStart,\r\n          state.audioDuration\r\n        );\r\n\r\n        state.sections = undefinedSection(state.measures.allIds.length - 1);\r\n      }),\r\n  reducers: {\r\n    addedSection(state, action: PayloadAction<Section>) {\r\n      return addSection(state, action.payload);\r\n    },\r\n    updatedSection(\r\n      state,\r\n      action: PayloadAction<{ before: string; after: Section }>\r\n    ) {\r\n      removeSection(state, action.payload.before);\r\n      return addSection(state, action.payload.after);\r\n    },\r\n    removedSection(state, action: PayloadAction<string>) {\r\n      removeSection(state, action.payload);\r\n\r\n      return state;\r\n    },\r\n    updatedRhythm(\r\n      state,\r\n      action: PayloadAction<{\r\n        firstMeasureStart?: number;\r\n        bpm?: number;\r\n        timeSignatureType?: TimeSignatureType;\r\n      }>\r\n    ) {\r\n      state.bpm = action.payload.bpm ?? state.bpm;\r\n      state.firstMeasureStart =\r\n        action.payload.firstMeasureStart ?? state.firstMeasureStart;\r\n      state.timeSignature =\r\n        action.payload.timeSignatureType ?? state.timeSignature;\r\n\r\n      state.measures = distributeMeasures(\r\n        state.timeSignature,\r\n        state.bpm,\r\n        state.firstMeasureStart,\r\n        state.audioDuration\r\n      );\r\n\r\n      const lastSection =\r\n        state.sections.byId[\r\n          state.sections.allIds[state.sections.allIds.length - 1]\r\n        ];\r\n\r\n      if (lastSection === undefined) return state;\r\n\r\n      if (\r\n        parseInt(ArrayUtil.last(state.measures.allIds)) >\r\n        parseInt(lastSection.measures[lastSection.measures.length - 1])\r\n      ) {\r\n        const newLastSection: Section = {\r\n          type: lastSection.type,\r\n          measures: ArrayUtil.range(\r\n            parseInt(lastSection.measures[0]),\r\n            parseInt(ArrayUtil.last(state.measures.allIds))\r\n          )\r\n        };\r\n        const id = generateSectionId(newLastSection);\r\n        delete state.sections.byId[\r\n          state.sections.allIds[state.sections.allIds.length - 1]\r\n        ];\r\n        state.sections.allIds[state.sections.allIds.length - 1] = id;\r\n        state.sections.byId[id] = newLastSection;\r\n      }\r\n\r\n      removeSectionsAfterLastMeasure(state);\r\n\r\n      return state;\r\n    }\r\n  }\r\n});\r\n\r\nconst removeSectionsAfterLastMeasure: (\r\n  state: AnalysisState\r\n) => void = state => {\r\n  const lastMeasure = state.measures.allIds.length - 1;\r\n  let removalStart = -1;\r\n  let removalStartMeasure = -1;\r\n\r\n  for (let index = 0; index <= state.sections.allIds.length - 1; index++) {\r\n    const section = state.sections.byId[state.sections.allIds[index]];\r\n    const sectionEnd = parseInt(ArrayUtil.last(section.measures));\r\n\r\n    if (sectionEnd > lastMeasure) {\r\n      removalStart = index;\r\n      removalStartMeasure = parseInt(section.measures[0]);\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (removalStart === -1) return; // No sections after last measure\r\n\r\n  replaceSections(\r\n    state.sections,\r\n    removalStart,\r\n    state.sections.allIds.length - removalStart,\r\n    [\r\n      {\r\n        measures: ArrayUtil.range(removalStartMeasure, lastMeasure),\r\n        type: SectionType.UNDEFINED\r\n      }\r\n    ]\r\n  );\r\n};\r\n\r\nconst addSection: (\r\n  state: AnalysisState,\r\n  newSection: Section\r\n) => AnalysisState = (state, newSection) => {\r\n  if (sectionInvalid(newSection)) return state;\r\n\r\n  let enclosingSection = enclosingSectionOf(newSection, state.sections);\r\n  if (\r\n    enclosingSection === undefined ||\r\n    enclosingSection.section.type !== SectionType.UNDEFINED\r\n  )\r\n    return state;\r\n\r\n  let mergedSections = mergeSections(enclosingSection.section, newSection);\r\n\r\n  replaceSections(state.sections, enclosingSection.position, 1, mergedSections);\r\n\r\n  return state;\r\n};\r\n\r\nconst removeSection: (state: AnalysisState, sectionId: string) => void = (\r\n  state,\r\n  sectionId\r\n) => {\r\n  let position = state.sections.allIds.indexOf(sectionId);\r\n  let section = state.sections.byId[sectionId];\r\n\r\n  let before = state.sections.allIds[position - 1];\r\n  let after = state.sections.allIds[position + 1];\r\n\r\n  let { start: firstMeasure, end: lastMeasure } = ArrayUtil.bordersOf(\r\n    section.measures\r\n  );\r\n  let removalStart = position;\r\n  let removalCount = 1;\r\n\r\n  if (\r\n    before !== undefined &&\r\n    state.sections.byId[before].type === SectionType.UNDEFINED\r\n  ) {\r\n    removalStart--;\r\n    removalCount++;\r\n    firstMeasure = parseInt(state.sections.byId[before].measures[0]);\r\n  }\r\n\r\n  if (\r\n    after !== undefined &&\r\n    state.sections.byId[after].type === SectionType.UNDEFINED\r\n  ) {\r\n    removalCount++;\r\n    lastMeasure = parseInt(ArrayUtil.last(state.sections.byId[after].measures));\r\n  }\r\n\r\n  replaceSections(state.sections, removalStart, removalCount, [\r\n    {\r\n      measures: ArrayUtil.range(firstMeasure, lastMeasure),\r\n      type: SectionType.UNDEFINED\r\n    }\r\n  ]);\r\n};\r\n\r\nexport const {\r\n  addedSection,\r\n  removedSection,\r\n  updatedRhythm,\r\n  updatedSection\r\n} = analysisSlice.actions;\r\n\r\nexport default analysisSlice.reducer;\r\n","import ArrayUtil from \"../../util/ArrayUtil\";\r\nimport { NormalizedObjects } from \"../store\";\r\nimport {\r\n  Measure,\r\n  Section,\r\n  SectionType,\r\n  TimeSignatureType\r\n} from \"./analysisSlice\";\r\n\r\nexport const toTimeSignature = (type: TimeSignatureType) => {\r\n  switch (type) {\r\n    case TimeSignatureType.FOUR_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 4 };\r\n    case TimeSignatureType.THREE_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 3 };\r\n  }\r\n};\r\n\r\nexport const undefinedSection = (length: number) => {\r\n  let undefinedSectionId = \"UNDEFINED_0_\" + length;\r\n  let sections: NormalizedObjects<Section>;\r\n\r\n  sections = {\r\n    allIds: [undefinedSectionId],\r\n    byId: {}\r\n  };\r\n\r\n  sections.byId[undefinedSectionId] = {\r\n    measures: ArrayUtil.range(0, length),\r\n    type: SectionType.UNDEFINED\r\n  };\r\n\r\n  return sections;\r\n};\r\n\r\nexport const sectionInvalid = (section: Section) => {\r\n  return (\r\n    parseInt(section.measures[0]) >\r\n    parseInt(section.measures[section.measures.length - 1])\r\n  );\r\n};\r\n\r\nexport const enclosingSectionOf = (\r\n  section: Section,\r\n  allSections: NormalizedObjects<Section>\r\n) => {\r\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\r\n    section.measures\r\n  );\r\n\r\n  const sectionCount = allSections.allIds.length;\r\n\r\n  for (let current = 0; current <= sectionCount - 1; current++) {\r\n    let section = allSections.byId[allSections.allIds[current]];\r\n    let { end: currentSectionEnd } = ArrayUtil.bordersOf(section.measures);\r\n\r\n    //Go to next section if not included\r\n    if (newSectionStart >= currentSectionEnd) continue;\r\n\r\n    //Exit if new section overlaps current section's border\r\n    if (newSectionEnd > currentSectionEnd) return undefined;\r\n\r\n    return { position: current, section: section };\r\n  }\r\n};\r\n\r\nexport const mergeSections: (\r\n  enclosingSection: Section,\r\n  embeddedSection: Section\r\n) => Section[] = (enclosingSection, embeddedSection) => {\r\n  let newSections: Section[] = [];\r\n\r\n  const { start: newSectionStart, end: newSectionEnd } = ArrayUtil.bordersOf(\r\n    embeddedSection.measures\r\n  );\r\n\r\n  const {\r\n    start: currentSectionStart,\r\n    end: currentSectionEnd\r\n  } = ArrayUtil.bordersOf(enclosingSection.measures);\r\n\r\n  //Add a new undefined block before the new section\r\n  if (newSectionStart > currentSectionStart) {\r\n    let section: Section = {\r\n      measures: ArrayUtil.range(currentSectionStart, newSectionStart - 1),\r\n      type: SectionType.UNDEFINED\r\n    };\r\n    newSections.push(section);\r\n  }\r\n\r\n  //add new section\r\n  newSections.push(embeddedSection);\r\n\r\n  //Add a new undefined block after the new section\r\n  if (newSectionEnd < currentSectionEnd) {\r\n    let section: Section = {\r\n      measures: ArrayUtil.range(newSectionEnd + 1, currentSectionEnd),\r\n      type: SectionType.UNDEFINED\r\n    };\r\n    newSections.push(section);\r\n  }\r\n\r\n  return newSections;\r\n};\r\n\r\nexport const replaceSections = (\r\n  sections: NormalizedObjects<Section>,\r\n  start: number,\r\n  deleteCount: number,\r\n  newSections: Section[]\r\n) => {\r\n  for (let section = start; section < deleteCount; section++) {\r\n    delete sections.byId[sections.allIds[section]];\r\n  }\r\n\r\n  let ids: string[] = [];\r\n\r\n  newSections.forEach(section => {\r\n    const id = generateSectionId(section);\r\n    ids.push(id);\r\n    sections.byId[id] = section;\r\n  });\r\n\r\n  sections.allIds.splice(start, deleteCount, ...ids);\r\n};\r\n\r\nexport const generateSectionId = (section: Section) =>\r\n  section.type +\r\n  \"_\" +\r\n  section.measures[0] +\r\n  \"_\" +\r\n  section.measures[section.measures.length - 1];\r\n\r\nexport const distributeMeasures = (\r\n  timeSignatureType: TimeSignatureType,\r\n  bpm: number,\r\n  firstMeasureStart: number,\r\n  length: number\r\n) => {\r\n  const timeSignature = toTimeSignature(timeSignatureType);\r\n  const lengthOfOneMeasure = (60 * timeSignature.beatsPerMeasure) / bpm;\r\n  const measures: NormalizedObjects<Measure> = { allIds: [], byId: {} };\r\n\r\n  let index = 0;\r\n  for (\r\n    let start = firstMeasureStart;\r\n    start < length;\r\n    start += lengthOfOneMeasure\r\n  ) {\r\n    measures.allIds.push(\"\" + index);\r\n    measures.byId[index] = {\r\n      time: start,\r\n      color: \"\",\r\n      editable: false,\r\n      id: \"\" + index,\r\n      labelText: \"\" + index\r\n    };\r\n    index++;\r\n  }\r\n\r\n  return measures;\r\n};\r\n","import { PointAddOptions, SegmentAddOptions } from \"peaks.js\";\r\n\r\nimport {\r\n  Measure,\r\n  Section,\r\n  SectionType\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { NormalizedObjects } from \"../../states/store\";\r\n\r\nexport const AUDIO_DOM_ELEMENT = \"audio_dom_element\";\r\nexport const ZOOMVIEW_CONTAINER = \"zoomview-container\";\r\nexport const OVERVIEW_CONTAINER = \"overview-container\";\r\n\r\nclass PeaksConfig {\r\n  static create = (audioBuffer: AudioBuffer) => {\r\n    let mediaelement = document!.getElementById(\r\n      AUDIO_DOM_ELEMENT\r\n    )! as HTMLAudioElement;\r\n\r\n    return {\r\n      containers: {\r\n        zoomview: document!.getElementById(ZOOMVIEW_CONTAINER)!,\r\n        overview: document!.getElementById(OVERVIEW_CONTAINER)!\r\n      },\r\n      mediaElement: mediaelement,\r\n      webAudio: {\r\n        audioBuffer: audioBuffer,\r\n        scale: 128,\r\n        multiChannel: false\r\n      },\r\n      keyboard: true,\r\n      pointMarkerColor: \"#006eb0\",\r\n      showPlayheadTime: true,\r\n      zoomLevels: [42] //TODO: Define good initial default\r\n    };\r\n  };\r\n\r\n  static sectionsToSegment = (\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>,\r\n    timePerMeasure: number\r\n  ) => {\r\n    let segments: SegmentAddOptions[] = [];\r\n    sections.allIds.forEach(id => {\r\n      const section = sections.byId[id];\r\n\r\n      const start = measures.byId[section.measures[0]].time;\r\n      const end = start + timePerMeasure;\r\n\r\n      let segment: SegmentAddOptions = {\r\n        id,\r\n        labelText: section.type,\r\n        startTime: start,\r\n        endTime: end,\r\n        color: PeaksConfig.SECTIONTYPE_TO_COLOR.get(section.type),\r\n        editable: false\r\n      };\r\n\r\n      segments.push(segment);\r\n    });\r\n\r\n    return segments;\r\n  };\r\n\r\n  static measuresToPoints = (measures: NormalizedObjects<Measure>) => {\r\n    let points: PointAddOptions[] = [];\r\n    measures.allIds.forEach(id => {\r\n      const measure = measures.byId[id];\r\n\r\n      let point: PointAddOptions = measure;\r\n\r\n      points.push(point);\r\n    });\r\n\r\n    return points;\r\n  };\r\n\r\n  static computeZoomLevels = (\r\n    secondsPerMeasure: number,\r\n    audioSampleRate: number,\r\n    zoomviewWidth: number,\r\n    measuresCount: number\r\n  ) => {\r\n    const baseZoom = Math.floor(\r\n      (secondsPerMeasure * audioSampleRate) / zoomviewWidth\r\n    );\r\n\r\n    let levels = new Array<number>(measuresCount);\r\n\r\n    for (let index = 0; index < levels.length; index++) {\r\n      levels[index] = baseZoom * (index + 1);\r\n    }\r\n\r\n    return levels;\r\n  };\r\n\r\n  static SECTIONTYPE_TO_COLOR = new Map<SectionType, string>([\r\n    [SectionType.INTRO, \"#FFCA28\"],\r\n    [SectionType.VERSE, \"#FFA726\"],\r\n    [SectionType.PRECHORUS, \"#FF7043\"],\r\n    [SectionType.CHORUS, \"#9CCC65\"],\r\n    [SectionType.SOLO, \"#26C6DA\"],\r\n    [SectionType.OUTRO, \"#5C6BC0\"],\r\n    [SectionType.BRIDGE, \"#EC407A\"],\r\n    [SectionType.VERSE, \"#78909C\"],\r\n    [SectionType.UNDEFINED, \"#ffffff\"]\r\n  ]) as ReadonlyMap<SectionType, string>;\r\n}\r\n\r\nexport default PeaksConfig;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface DialogState {\r\n  readonly currentDialog: DialogType;\r\n}\r\n\r\nexport enum DialogType {\r\n  NONE = \"none\",\r\n  NEW = \"new\",\r\n  OPEN = \"open\",\r\n  SAVE = \"save\",\r\n  ADD_SECTION = \"add_section\"\r\n}\r\n\r\nconst initialDialogState: DialogState = {\r\n  currentDialog: DialogType.NONE\r\n};\r\n\r\nconst dialogsSlice = createSlice({\r\n  name: \"dialogs\",\r\n  initialState: initialDialogState,\r\n  reducers: {\r\n    openedDialog(state, action: PayloadAction<DialogType>) {\r\n      state.currentDialog = action.payload;\r\n    },\r\n    closedDialog(state) {\r\n      state.currentDialog = DialogType.NONE;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { openedDialog, closedDialog } = dialogsSlice.actions;\r\n\r\nexport default dialogsSlice.reducer;\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nimport { SectionType } from \"../../states/analysis/analysisSlice\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\nconst SectionSelect: FunctionComponent<{\r\n  value: SectionType;\r\n  onChange: (sectionType: SectionType) => void;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newSection = event.target.value as SectionType;\r\n    props.onChange(newSection);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(props.value),\r\n        minWidth: \"140px\"\r\n      }}\r\n    >\r\n      {Object.values(SectionType).map(sectionType => {\r\n        return sectionType === SectionType.UNDEFINED ? (\r\n          undefined\r\n        ) : (\r\n          <MenuItem\r\n            key={sectionType}\r\n            value={sectionType}\r\n            style={{\r\n              backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(sectionType)\r\n            }}\r\n          >\r\n            {sectionType}\r\n          </MenuItem>\r\n        );\r\n      })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default SectionSelect;\r\n","import {\r\n  IconButton,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow\r\n} from \"@material-ui/core\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport MeasureSelect from \"../../components/measureSelect/measureSelect\";\r\nimport SectionSelect from \"../../components/sectionSelect/sectionSelect\";\r\nimport {\r\n  addedSection,\r\n  removedSection,\r\n  Section,\r\n  SectionType,\r\n  updatedSection\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { DialogType, openedDialog } from \"../../states/dialog/dialogsSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\n\r\ninterface PropsFromState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly measuresCount: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  addedSection: typeof addedSection;\r\n  updatedSection: typeof updatedSection;\r\n  removedSection: typeof removedSection;\r\n  openedDialog: typeof openedDialog;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureView extends Component<AllProps> {\r\n  handleAddSection = (section: Section) => {\r\n    this.props.addedSection(section);\r\n  };\r\n\r\n  handleUpdatedSection = (id: string, before: Section, after: Section) => {\r\n    Log.info(\r\n      \"Change section \" +\r\n        id +\r\n        \" from \" +\r\n        JSON.stringify(before) +\r\n        \" to \" +\r\n        JSON.stringify(after),\r\n      StructureView.name\r\n    );\r\n\r\n    if (\r\n      parseInt(after.measures[0]) >\r\n      parseInt(after.measures[after.measures.length - 1])\r\n    )\r\n      return;\r\n\r\n    this.props.updatedSection({ before: id, after });\r\n  };\r\n\r\n  handleRemoveSection = (id: string) => {\r\n    this.props.removedSection(id);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <TableContainer component={Paper}>\r\n        <Table size=\"small\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell style={{ width: \"10%\" }}></TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Section</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>First Measure</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Last Measure</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {this.props.sections.allIds.map((id: string) => {\r\n              let section = this.props.sections.byId[id];\r\n              return (\r\n                <TableRow key={id}>\r\n                  <TableCell component=\"th\" scope=\"row\">\r\n                    {section.type !== SectionType.UNDEFINED && (\r\n                      <IconButton\r\n                        onClick={() => this.handleRemoveSection(id)}\r\n                        size=\"small\"\r\n                      >\r\n                        <RemoveIcon></RemoveIcon>\r\n                      </IconButton>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {section.type === SectionType.UNDEFINED ? (\r\n                      \"UNDEFINED\"\r\n                    ) : (\r\n                      <SectionSelect\r\n                        value={section.type}\r\n                        onChange={sectionType =>\r\n                          this.handleUpdatedSection(id, section, {\r\n                            ...section,\r\n                            type: sectionType\r\n                          })\r\n                        }\r\n                      ></SectionSelect>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      disabled={section.type === SectionType.UNDEFINED}\r\n                      value={parseInt(section.measures[0])}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            measure,\r\n                            parseInt(\r\n                              section.measures[section.measures.length - 1]\r\n                            )\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      disabled={section.type === SectionType.UNDEFINED}\r\n                      value={parseInt(\r\n                        section.measures[section.measures.length - 1]\r\n                      )}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            parseInt(section.measures[0]),\r\n                            measure\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                </TableRow>\r\n              );\r\n            })}\r\n            <TableRow key=\"last\">\r\n              <TableCell component=\"th\" scope=\"row\">\r\n                <IconButton\r\n                  onClick={() =>\r\n                    this.props.openedDialog(DialogType.ADD_SECTION)\r\n                  }\r\n                  size=\"small\"\r\n                >\r\n                  <AddIcon></AddIcon>\r\n                </IconButton>\r\n              </TableCell>\r\n              <TableCell />\r\n              <TableCell />\r\n              <TableCell />\r\n            </TableRow>\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measuresCount: analysis.measures.allIds.length\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  addedSection,\r\n  updatedSection,\r\n  removedSection,\r\n  openedDialog\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructureView);\r\n","import { Button, ButtonGroup, Grid, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { Measure, Section } from \"../../states/analysis/analysisSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n}\r\n\r\ninterface PropsFromDispatch {}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass SectionOverview extends React.Component<AllProps> {\r\n  render() {\r\n    let { sections, measures } = this.props;\r\n\r\n    let generateMatrix = (arr: string[], size: number) => {\r\n      var res = [];\r\n      for (var i = 0; i < arr.length; i = i + size)\r\n        res.push(arr.slice(i, i + size));\r\n      return res;\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <Grid container direction=\"column\">\r\n          {sections.allIds.map(sectionId => (\r\n            <Grid item key={sectionId}>\r\n              <Grid container direction=\"column\">\r\n                <Grid item key={sectionId + \"_caption\"}>\r\n                  <Typography variant=\"caption\">\r\n                    {sections.byId[sectionId].type.toLowerCase()}\r\n                  </Typography>\r\n                </Grid>\r\n                <Grid item key={sectionId + \"_body\"}>\r\n                  <Grid\r\n                    container\r\n                    direction=\"column\"\r\n                    style={{ marginBottom: \"5px\" }}\r\n                  >\r\n                    {generateMatrix(sections.byId[sectionId].measures, 8).map(\r\n                      row => (\r\n                        <ButtonGroup\r\n                          key={sectionId + \"_buttonGroup_\" + row[0]}\r\n                          orientation=\"horizontal\"\r\n                          size=\"small\"\r\n                        >\r\n                          {row.map(measureId => {\r\n                            let measure: Measure = measures.byId[measureId];\r\n\r\n                            return (\r\n                              <Square\r\n                                key={measure.id}\r\n                                value={measure.id!}\r\n                                bg={\r\n                                  PeaksConfig.SECTIONTYPE_TO_COLOR.get(\r\n                                    sections.byId[sectionId].type\r\n                                  )!\r\n                                }\r\n                              ></Square>\r\n                            );\r\n                          })}\r\n                        </ButtonGroup>\r\n                      )\r\n                    )}\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nclass Square extends React.Component<{\r\n  value: string;\r\n  bg: string;\r\n}> {\r\n  render() {\r\n    return (\r\n      <Button\r\n        {...this.props}\r\n        style={{\r\n          backgroundColor: this.props.bg\r\n        }}\r\n      >\r\n        {this.props.value}\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measures: analysis.measures\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SectionOverview);\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport SectionOverview from \"../../components/sectionOverview/sectionOverview\";\r\nimport { ApplicationState } from \"../../states/store\";\r\n\r\ninterface PropsFromState {}\r\n\r\ninterface PropsFromDispatch {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureNavigationView extends Component<AllProps> {\r\n  render() {\r\n    return <SectionOverview></SectionOverview>;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {};\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(StructureNavigationView);\r\n","import React, { Component } from \"react\";\r\n\r\nimport {\r\n  OVERVIEW_CONTAINER,\r\n  ZOOMVIEW_CONTAINER\r\n} from \"../../components/audioManagement/peaksConfig\";\r\nimport Log from \"../../components/log/log\";\r\n\r\ninterface Props {\r\n  url: string;\r\n}\r\n\r\nexport default class WaveView extends Component<Props> {\r\n  shouldComponentUpdate(nextProps: Props) {\r\n    return nextProps.url !== this.props.url;\r\n  }\r\n\r\n  render() {\r\n    Log.info(\"render with url=\" + this.props.url, WaveView.name);\r\n    return (\r\n      <div>\r\n        <div id=\"waveform-container\">\r\n          <div id={ZOOMVIEW_CONTAINER}></div>\r\n          <div id={OVERVIEW_CONTAINER}></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport { hotReloaded, LoadingStatus } from \"../../states/project/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport WaveView from \"./waveView\";\r\n\r\ninterface PropsFromState {\r\n  audioLoaded: LoadingStatus;\r\n  audioUrl: string;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  hotReloaded: typeof hotReloaded;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass WaveContainer extends Component<AllProps> {\r\n  constructor(props: AllProps) {\r\n    super(props);\r\n\r\n    if (process.env.NODE_ENV !== \"production\" && props.audioUrl) {\r\n      Log.info(\"Hot reload with url=\" + props.audioUrl, WaveContainer.name);\r\n      this.props.hotReloaded();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    Log.info(\r\n      \"render with props=\" + JSON.stringify(this.props),\r\n      WaveContainer.name\r\n    );\r\n\r\n    return (\r\n      <div>\r\n        {this.props.audioLoaded !== LoadingStatus.INITIALIZED && (\r\n          <CircularProgress />\r\n        )}\r\n        <WaveView url={this.props.audioUrl} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ project }: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    audioLoaded: project.status\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  hotReloaded\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveContainer);\r\n","import {\r\n  Box,\r\n  FormControl,\r\n  Input,\r\n  InputLabel,\r\n  NativeSelect,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport SyncAltIcon from \"@material-ui/icons/SyncAlt\";\r\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport {\r\n  TimeSignatureType,\r\n  updatedRhythm\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { updatedPlaybackSettings } from \"../../states/audio/audioSlice\";\r\nimport { enabledSyncFirstMeasureStart } from \"../../states/project/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\n\r\ninterface PropsFromState {\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly syncFirstMeasureStart: boolean;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n  readonly zoom: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  updatedRhythm: typeof updatedRhythm;\r\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\r\n  updatedPlaybackSettings: typeof updatedPlaybackSettings;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass WaveControlView extends Component<AllProps> {\r\n  handleTimeSignatureChange = (e: any) => {\r\n    this.props.updatedRhythm({ timeSignatureType: e.target.value });\r\n  };\r\n\r\n  handleBpmChange = (e: any, bpm: number | number[]) => {\r\n    if (!Array.isArray(bpm)) {\r\n      this.props.updatedRhythm({ bpm: bpm });\r\n    }\r\n  };\r\n\r\n  handleDetuneChange = (e: any, detune: number | number[]) => {\r\n    if (!Array.isArray(detune) && detune !== this.props.detune) {\r\n      this.props.updatedPlaybackSettings({ detune: detune });\r\n    }\r\n  };\r\n\r\n  handlePlaybackRateChange = (e: any, playbackRate: number | number[]) => {\r\n    if (\r\n      !Array.isArray(playbackRate) &&\r\n      playbackRate !== this.props.playbackRate\r\n    ) {\r\n      this.props.updatedPlaybackSettings({ playbackRate: playbackRate });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Grid container direction=\"column\" spacing={3}>\r\n          <Grid item>\r\n            <FormControl fullWidth={true}>\r\n              <InputLabel>Start Measure 1</InputLabel>\r\n              <Input\r\n                type=\"text\"\r\n                id=\"startMeasure1\"\r\n                value={this.props.firstMeasureStart}\r\n                startAdornment={\r\n                  <InputAdornment position=\"start\">\r\n                    <Tooltip title=\"Sync with play head\">\r\n                      <ToggleButton\r\n                        style={{ width: \"15px\", height: \"25px\" }}\r\n                        value=\"check\"\r\n                        selected={this.props.syncFirstMeasureStart}\r\n                        onChange={() => {\r\n                          this.props.enabledSyncFirstMeasureStart(\r\n                            !this.props.syncFirstMeasureStart\r\n                          );\r\n                        }}\r\n                      >\r\n                        <SyncAltIcon />\r\n                      </ToggleButton>\r\n                    </Tooltip>\r\n                  </InputAdornment>\r\n                }\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Bpm\"\r\n              value={this.props.bpm}\r\n              min={40}\r\n              max={220}\r\n              step={1}\r\n              onChange={this.handleBpmChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl fullWidth={true}>\r\n              <InputLabel>Time Signature</InputLabel>\r\n              <NativeSelect\r\n                value={this.props.timeSignature}\r\n                onChange={this.handleTimeSignatureChange}\r\n              >\r\n                <option value={TimeSignatureType.FOUR_FOUR}>4/4</option>\r\n                <option value={TimeSignatureType.THREE_FOUR}>3/4</option>\r\n              </NativeSelect>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Detune\"\r\n              value={this.props.detune}\r\n              min={-12}\r\n              max={12}\r\n              step={0.5}\r\n              onChange={this.handleDetuneChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Playback rate\"\r\n              value={this.props.playbackRate}\r\n              min={0.4}\r\n              max={1.2}\r\n              step={0.05}\r\n              onChange={this.handlePlaybackRateChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst SliderInput = (props: {\r\n  title: string;\r\n  min: number;\r\n  max: number;\r\n  step: number;\r\n  value: number;\r\n  onChange: (event: any, value: number | number[]) => void;\r\n}) => {\r\n  return (\r\n    <FormControl style={{ width: \"100%\" }}>\r\n      <InputLabel shrink>{props.title}</InputLabel>\r\n      <Box mt={2}>\r\n        <Slider\r\n          value={props.value}\r\n          valueLabelDisplay=\"auto\"\r\n          min={props.min}\r\n          max={props.max}\r\n          onChange={props.onChange}\r\n          step={props.step}\r\n        />\r\n      </Box>\r\n    </FormControl>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({\r\n  project,\r\n  analysis,\r\n  audio,\r\n  wave\r\n}: ApplicationState) => {\r\n  return {\r\n    firstMeasureStart: analysis.firstMeasureStart,\r\n    bpm: analysis.bpm,\r\n    timeSignature: analysis.timeSignature,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate,\r\n    zoom: wave.zoom,\r\n    status: project.status\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  updatedRhythm,\r\n  enabledSyncFirstMeasureStart,\r\n  updatedPlaybackSettings\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveControlView);\r\n","import { IconButton, Popover, Tooltip } from \"@material-ui/core\";\r\nimport LoopIcon from \"@material-ui/icons/Loop\";\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport TimerIcon from \"@material-ui/icons/Timer\";\r\nimport ZoomInIcon from \"@material-ui/icons/ZoomIn\";\r\nimport ZoomOutIcon from \"@material-ui/icons/ZoomOut\";\r\nimport React, { ReactElement } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport ContentLayout from \"../../components/contentLayout/contentLayout\";\r\nimport Log from \"../../components/log/log\";\r\nimport View from \"../../components/view/view\";\r\nimport { triggeredPause, triggeredPlay } from \"../../states/audio/audioSlice\";\r\nimport { LoadingStatus } from \"../../states/project/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport { zoomedIn, zoomedOut } from \"../../states/wave/waveSlice\";\r\nimport StructureView from \"../../views/structure/structureView\";\r\nimport StructureNavigationView from \"../../views/structureNavigation/structureNavigationView\";\r\nimport WaveContainer from \"../../views/wave/waveContainer\";\r\nimport WaveControlView from \"../../views/waveControl/waveControlView\";\r\n\r\ninterface PropsFromState {\r\n  readonly loaded: boolean;\r\n  readonly isPlaying: boolean;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  zoomedIn: typeof zoomedIn;\r\n  zoomedOut: typeof zoomedOut;\r\n  triggeredPlay: typeof triggeredPlay;\r\n  triggeredPause: typeof triggeredPause;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\ninterface State {\r\n  anchorEl: HTMLButtonElement | null;\r\n}\r\n\r\nclass StructurePage extends React.Component<AllProps, State> {\r\n  state: State = {\r\n    anchorEl: null\r\n  };\r\n\r\n  handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    this.setState({ anchorEl: event.currentTarget });\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({ anchorEl: null });\r\n  };\r\n\r\n  render() {\r\n    Log.info(\"render\", StructurePage.name);\r\n    return (\r\n      <ContentLayout\r\n        topLeft={\r\n          <View\r\n            title=\"Song Overview\"\r\n            body={<WaveContainer />}\r\n            action={\r\n              <>\r\n                {this.props.isPlaying ? (\r\n                  <WaveformControlButton\r\n                    title=\"Pause\"\r\n                    icon={<PauseIcon />}\r\n                    onClick={() => this.props.triggeredPause()}\r\n                  />\r\n                ) : (\r\n                  <WaveformControlButton\r\n                    title=\"Play\"\r\n                    icon={<PlayArrowIcon />}\r\n                    onClick={() => this.props.triggeredPlay()}\r\n                  />\r\n                )}\r\n\r\n                <WaveformControlButton title=\"Loop\" icon={<LoopIcon />} />\r\n                <WaveformControlButton\r\n                  title=\"Metronome\"\r\n                  icon={<TimerIcon />}\r\n                  onClick={e => this.handleClick(e)}\r\n                />\r\n                <Popover\r\n                  style={{ height: \"400px\" }}\r\n                  open={Boolean(this.state.anchorEl)}\r\n                  anchorEl={this.state.anchorEl}\r\n                  onClose={() => this.handleClose()}\r\n                  anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"left\"\r\n                  }}\r\n                  transformOrigin={{\r\n                    vertical: \"top\",\r\n                    horizontal: \"left\"\r\n                  }}\r\n                >\r\n                  <WaveControlView></WaveControlView>\r\n                </Popover>\r\n                <WaveformControlButton\r\n                  title=\"Zoom in\"\r\n                  icon={<ZoomInIcon />}\r\n                  onClick={() => this.props.zoomedIn()}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Zoom out\"\r\n                  icon={<ZoomOutIcon />}\r\n                  onClick={() => this.props.zoomedOut()}\r\n                />\r\n              </>\r\n            }\r\n          ></View>\r\n        }\r\n        topRight={\r\n          <View title=\"Song Measures\" body={<StructureNavigationView />}></View>\r\n        }\r\n        bottom={<View title=\"Song Structure\" body={<StructureView />}></View>}\r\n      ></ContentLayout>\r\n    );\r\n  }\r\n}\r\n\r\nconst WaveformControlButton = (props: {\r\n  title: string;\r\n  icon: ReactElement;\r\n  onClick?: (e?: any) => void;\r\n}) => {\r\n  return (\r\n    <Tooltip title={props.title}>\r\n      <IconButton\r\n        onClick={props.onClick}\r\n        size=\"small\"\r\n        style={{ marginTop: \"8px\", marginRight: \"5px\" }}\r\n      >\r\n        {props.icon}\r\n      </IconButton>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ project, audio }: ApplicationState) => {\r\n  return {\r\n    loaded: project.status === LoadingStatus.INITIALIZED,\r\n    isPlaying: audio.isPlaying\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  zoomedIn,\r\n  zoomedOut,\r\n  triggeredPlay,\r\n  triggeredPause\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructurePage);\r\n","import React from \"react\";\r\n\r\nclass VersionInfo extends React.Component<{\r\n  version: string;\r\n  hash: string;\r\n  description: string;\r\n}> {\r\n  render() {\r\n    return (\r\n      <>\r\n        {this.props.version} (\r\n        <a\r\n          href={\"https://github.com/tscz/transcribe/commit/\" + this.props.hash}\r\n        >\r\n          {this.props.hash} - {this.props.description}\r\n        </a>\r\n        )\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default VersionInfo;\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z\"\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z\"\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z\"\n});\n\nvar _ref6 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z\"\n});\n\nvar _ref7 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z\"\n});\n\nvar _ref8 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z\"\n});\n\nvar _ref9 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z\"\n});\n\nvar _ref10 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z\"\n});\n\nvar _ref11 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z\"\n});\n\nvar _ref12 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref13 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref14 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref15 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref16 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref17 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref18 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref19 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref20 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref21 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref22 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref23 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref24 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref25 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref26 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z \"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z\"\n  }), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    d: \"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z\"\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 201.212,\n    cy: 201.242,\n    r: 22.708\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 331.22,\n    cy: 201.242,\n    r: 22.708\n  })), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z\"\n  })), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#C9BCB8\"\n    },\n    d: \"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16, _ref17, _ref18, _ref19, _ref20, _ref21, _ref22, _ref23, _ref24, _ref25, _ref26);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dd187a77.svg\";\nexport { ForwardRef as ReactComponent };","import { Grid } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Button from \"@material-ui/core/Button\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { Theme, WithStyles, withStyles } from \"@material-ui/core/styles\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport MusicVideoIcon from \"@material-ui/icons/MusicVideo\";\nimport PrintIcon from \"@material-ui/icons/Print\";\nimport RadioIcon from \"@material-ui/icons/Radio\";\nimport React from \"react\";\nimport { FunctionComponent } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport DefaultPage from \"../../pages/default/defaultPage\";\nimport DrumPage from \"../../pages/drum/drumPage\";\nimport GuitarPage from \"../../pages/guitar/guitarPage\";\nimport HarmonyPage from \"../../pages/harmony/harmonyPage\";\nimport PrintPage from \"../../pages/print/printPage\";\nimport StructurePage from \"../../pages/structure/structurePage\";\nimport { DialogType, openedDialog } from \"../../states/dialog/dialogsSlice\";\nimport { LoadingStatus } from \"../../states/project/projectSlice\";\nimport { Page, switchedPage } from \"../../states/project/projectSlice\";\nimport { ApplicationState } from \"../../states/store\";\nimport { stylesForApp } from \"../../styles/styles\";\nimport Log from \"../log/log\";\nimport VersionInfo from \"../versionInfo/versionInfo\";\nimport { ReactComponent as Logo } from \"./logo.svg\";\n\ninterface PropsFromState {\n  currentPage: Page;\n  status: LoadingStatus;\n  title: string;\n}\n\ninterface PropsFromDispatch {\n  switchedPage: typeof switchedPage;\n  openedDialog: typeof openedDialog;\n}\n\ninterface Props extends WithStyles<typeof stylesForApp> {\n  theme: Theme;\n}\n\ntype AllProps = Props & PropsFromState & PropsFromDispatch;\n\nclass App extends React.Component<AllProps> {\n  render() {\n    Log.info(\"render\", App.name);\n    return (\n      <>\n        <div className={this.props.classes.root}>\n          <AppBar position=\"fixed\" className={this.props.classes.appBar}>\n            <Toolbar>\n              <Logo height=\"40px\" style={{ marginRight: \"5px\" }}></Logo>\n              <Typography color=\"textPrimary\" variant=\"h4\" noWrap>\n                Transcribe\n              </Typography>\n              <Typography\n                color=\"textPrimary\"\n                variant=\"caption\"\n                noWrap\n                className={this.props.classes.title}\n              >\n                [{this.props.title !== \"\" ? this.props.title : \"no file loaded\"}\n                ]\n              </Typography>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.NEW)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                New\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.OPEN)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                Open\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.SAVE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                Save\n              </Button>\n            </Toolbar>\n          </AppBar>\n          <Drawer\n            className={this.props.classes.drawer}\n            variant=\"permanent\"\n            classes={{\n              paper: this.props.classes.drawerPaper\n            }}\n          >\n            <div className={this.props.classes.toolbar} />\n            <List style={{ color: \"#abb1b7\" }}>\n              <ListItem\n                button\n                key=\"Structure\"\n                onClick={() => this.props.switchedPage(Page.STRUCTURE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <HomeIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Structure\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Harmony\"\n                onClick={() => this.props.switchedPage(Page.HARMONY)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <MusicVideoIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Harmony\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Guitar\"\n                onClick={() => this.props.switchedPage(Page.GUITAR)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <RadioIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Guitar\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Drum\"\n                onClick={() => this.props.switchedPage(Page.DRUM)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <AlbumIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Drum\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Print\"\n                onClick={() => this.props.switchedPage(Page.PRINT)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <PrintIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Print\" />\n              </ListItem>\n            </List>\n          </Drawer>\n          <main className={this.props.classes.content}>\n            <div className={this.props.classes.toolbar} />\n            <Toggle show={this.props.currentPage === Page.DEFAULT}>\n              <DefaultPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.STRUCTURE}>\n              <StructurePage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.HARMONY}>\n              <HarmonyPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.GUITAR}>\n              <GuitarPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.DRUM}>\n              <DrumPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.PRINT}>\n              <PrintPage />\n            </Toggle>\n            <Grid\n              container\n              direction=\"column\"\n              justify=\"flex-end\"\n              alignItems=\"flex-end\"\n              style={{ marginTop: \"20px\" }}\n            >\n              <Grid item>\n                App version:{\" \"}\n                <VersionInfo\n                  version={process.env.REACT_APP_VERSION ?? \"\"}\n                  hash={process.env.REACT_APP_VERSION_HASH ?? \"\"}\n                  description={process.env.REACT_APP_VERSION_DESCRIPTION ?? \"\"}\n                />\n              </Grid>\n            </Grid>\n          </main>\n        </div>\n      </>\n    );\n  }\n}\n\nconst Toggle: FunctionComponent<{ show: boolean }> = props => {\n  if (props.show) {\n    return <div style={{ display: \"inline\" }}>{props.children}</div>;\n  } else {\n    return <div style={{ display: \"none\" }}>{props.children}</div>;\n  }\n};\n\nconst mapStateToProps = ({ project }: ApplicationState) => {\n  return {\n    currentPage: project.currentPage,\n    status: project.status,\n    title: project.title\n  };\n};\n\nconst mapDispatchToProps = {\n  switchedPage,\n  openedDialog\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(stylesForApp, { withTheme: true })(App));\n","import { createStyles, Theme } from \"@material-ui/core/styles\";\r\n\r\nconst drawerWidth = 190;\r\n\r\nexport const stylesForApp = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: \"flex\",\r\n      backgroundColor: \"#d5d8da\"\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      backgroundColor: \"#FFFFFF\"\r\n    },\r\n    drawer: {\r\n      width: drawerWidth,\r\n      flexShrink: 0\r\n    },\r\n    drawerPaper: {\r\n      width: drawerWidth,\r\n      backgroundColor: \"#202a2f\"\r\n    },\r\n    content: {\r\n      flexGrow: 1,\r\n      padding: theme.spacing(3)\r\n    },\r\n    toolbar: theme.mixins.toolbar,\r\n    title: {\r\n      flexGrow: 1,\r\n      marginLeft: \"50px\"\r\n    }\r\n  });\r\n","import { saveAs } from \"file-saver\";\r\nimport JSZip from \"jszip\";\r\n\r\nimport { PersistedState } from \"../states/store\";\r\n\r\ninterface SaveOptions {\r\n  audioFileUrl: string;\r\n  state: PersistedState;\r\n}\r\n\r\nclass PersistenceApi {\r\n  private constructor() {}\r\n\r\n  private static songFile = \"song.blob\";\r\n  private static stateFile = \"state.json\";\r\n\r\n  static save = async (filename: string, options: SaveOptions) => {\r\n    let zip = new JSZip();\r\n    zip.file(PersistenceApi.stateFile, JSON.stringify(options.state));\r\n\r\n    let response = await fetch(options.audioFileUrl);\r\n    let audioBlob: Blob = await response.blob();\r\n    zip.file(PersistenceApi.songFile, audioBlob);\r\n\r\n    await zip.generateAsync({ type: \"blob\" }).then(file => {\r\n      saveAs(file, filename);\r\n    });\r\n  };\r\n\r\n  static async open(\r\n    zip: File\r\n  ): Promise<{ audioBlob: Blob; state: PersistedState }> {\r\n    let archive = await JSZip.loadAsync(zip);\r\n    let audioBlob = await archive.file(PersistenceApi.songFile).async(\"blob\");\r\n\r\n    let json = await archive.file(PersistenceApi.stateFile).async(\"text\");\r\n    let state: PersistedState = JSON.parse(json);\r\n\r\n    return { audioBlob, state };\r\n  }\r\n\r\n  static revokeLocalFile(url: string) {\r\n    window.URL.revokeObjectURL(url);\r\n  }\r\n\r\n  static getLocalFileUrl(blob: Blob) {\r\n    return window.URL.createObjectURL(blob);\r\n  }\r\n}\r\n\r\nexport default PersistenceApi;\r\n","import {\r\n  createStyles,\r\n  InputBase,\r\n  Theme,\r\n  WithStyles,\r\n  withStyles\r\n} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport MenuIcon from \"@material-ui/icons/OpenInBrowser\";\r\nimport React from \"react\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\n\r\nexport enum FileType {\r\n  AUDIO = \"audio/*\",\r\n  ZIP = \".zip\"\r\n}\r\n\r\nconst toString = (type: FileType) => {\r\n  switch (type) {\r\n    case FileType.AUDIO:\r\n      return \"Audio File\";\r\n    case FileType.ZIP:\r\n      return \"Project Zip File\";\r\n  }\r\n};\r\n\r\ninterface Props extends WithStyles<typeof stylesForFileInput> {\r\n  id: string;\r\n  fileType: FileType;\r\n  callback: (file: File, fileUrl: string) => void;\r\n}\r\n\r\ninterface State {\r\n  display: string;\r\n}\r\n\r\nconst stylesForFileInput = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      padding: \"4px 0px\",\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      width: \"100%\"\r\n    },\r\n    input: {\r\n      marginLeft: theme.spacing(1),\r\n      flex: 1\r\n    },\r\n    iconButton: {\r\n      padding: 10\r\n    }\r\n  });\r\n\r\nclass FileInput extends React.Component<Props, State> {\r\n  state: State = {\r\n    display: \"\"\r\n  };\r\n\r\n  fileInput: React.RefObject<HTMLInputElement>;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.fileInput = React.createRef();\r\n  }\r\n\r\n  handleChange = (fileList: FileList | null) => {\r\n    if (fileList === null) return;\r\n\r\n    var file = fileList[0];\r\n    var fileURL = PersistenceApi.getLocalFileUrl(file);\r\n\r\n    this.setState({ display: file.name });\r\n    this.props.callback(file, fileURL);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Paper component=\"form\" className={this.props.classes.root}>\r\n          <InputBase\r\n            className={this.props.classes.input}\r\n            placeholder={\"Choose \" + toString(this.props.fileType) + \" ...\"}\r\n            inputProps={{\r\n              \"aria-label\": \"Choose \" + toString(this.props.fileType)\r\n            }}\r\n            value={this.state.display}\r\n            readOnly={true}\r\n            onClick={() => this.fileInput.current?.click()}\r\n          />\r\n          <IconButton\r\n            aria-label=\"menu\"\r\n            onClick={() => this.fileInput.current?.click()}\r\n            className={this.props.classes.iconButton}\r\n          >\r\n            <MenuIcon />{\" \"}\r\n          </IconButton>\r\n        </Paper>\r\n        <input\r\n          hidden={true}\r\n          id={this.props.id}\r\n          type=\"file\"\r\n          accept={this.props.fileType}\r\n          ref={this.fileInput}\r\n          onChange={e => this.handleChange(e.target.files)}\r\n        ></input>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(stylesForFileInput, { withTheme: true })(FileInput);\r\n","import { PeaksInstance } from \"peaks.js\";\r\nimport Tone from \"tone\";\r\n\r\ninterface Player {\r\n  destroy: () => void;\r\n  play: () => void;\r\n  pause: () => void;\r\n  isPlaying: () => boolean;\r\n  isSeeking: () => boolean;\r\n  getCurrentTime: () => number;\r\n  getDuration: () => number;\r\n  seek: (time: number) => void;\r\n  setPlaybackRate: (playbackRate: number) => void;\r\n  setDetune: (pitch: number) => void;\r\n}\r\n\r\ninterface EmitAware {\r\n  emit: (id: string, value: any) => void;\r\n}\r\n\r\nexport interface PeaksInstanceEmitAware extends PeaksInstance, EmitAware {}\r\n\r\n/**\r\n * Tone.js Player replacement for the <audio>-element based Peaks.js player\r\n */\r\nclass AudioPlayer implements Player {\r\n  peaks: PeaksInstanceEmitAware;\r\n  player: Tone.Player;\r\n  pitchShift: Tone.PitchShift;\r\n\r\n  constructor(\r\n    peaks: PeaksInstance,\r\n    audioBuffer: AudioBuffer,\r\n    onSongComplete: () => void\r\n  ) {\r\n    this.peaks = peaks as PeaksInstanceEmitAware;\r\n\r\n    this.player = new Tone.Player(audioBuffer);\r\n    this.player.sync();\r\n    this.player.start();\r\n\r\n    this.pitchShift = new Tone.PitchShift();\r\n\r\n    Tone.connectSeries(this.player, this.pitchShift, Tone.Master);\r\n\r\n    Tone.Transport.scheduleRepeat(time => {\r\n      this.peaks.emit(\"player_time_update\", this.getCurrentTime());\r\n      if (this.getCurrentTime() >= this.getDuration()) {\r\n        Tone.Transport.stop();\r\n        onSongComplete();\r\n      }\r\n    }, 0.03);\r\n\r\n    this.peaks.emit(\"player_canplay\", this);\r\n  }\r\n\r\n  shiftToSemitones = (shift: number) => 12 * Math.log2(1 / shift);\r\n\r\n  setPlaybackRate(playbackRate: number) {\r\n    this.player.playbackRate = playbackRate;\r\n\r\n    this.pitchShift.pitch = this.shiftToSemitones(playbackRate);\r\n  }\r\n\r\n  setDetune(detune: number) {\r\n    this.pitchShift.pitch =\r\n      this.shiftToSemitones(this.player.playbackRate) + detune;\r\n  }\r\n\r\n  destroy = () => {\r\n    Tone.context.dispose();\r\n    ((Tone as unknown) as Tone & {\r\n      setContext: (ctx: AudioContext) => void;\r\n    }).setContext(new AudioContext());\r\n  };\r\n\r\n  play = () => {\r\n    Tone.Transport.start(Tone.now(), this.getCurrentTime());\r\n    this.peaks.emit(\"player_play\", this.getCurrentTime());\r\n  };\r\n\r\n  pause = () => {\r\n    Tone.Transport.pause();\r\n    this.peaks.emit(\"player_pause\", this.getCurrentTime());\r\n  };\r\n\r\n  isPlaying = () => {\r\n    return Tone.Transport.state === \"started\";\r\n  };\r\n\r\n  isSeeking = () => {\r\n    return false;\r\n  };\r\n\r\n  getCurrentTime = () => {\r\n    return (\r\n      this.player.buffer.toSeconds(Tone.Transport.position) *\r\n      this.player.playbackRate\r\n    );\r\n  };\r\n\r\n  getDuration = () => {\r\n    return this.player.buffer.duration;\r\n  };\r\n\r\n  seek = (time: number) => {\r\n    const normalizedTime = time * this.player.playbackRate;\r\n\r\n    if (this.isPlaying()) {\r\n      Tone.Transport.stop();\r\n      Tone.Transport.start(Tone.now(), normalizedTime);\r\n    } else {\r\n      Tone.Transport.start(Tone.now(), normalizedTime);\r\n      Tone.Transport.pause();\r\n    }\r\n    this.peaks.emit(\"player_time_update\", normalizedTime);\r\n    this.peaks.emit(\"player_seek\", normalizedTime);\r\n  };\r\n}\r\n\r\nexport default AudioPlayer;\r\n","import Peaks, { PeaksInstance } from \"peaks.js\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Tone from \"tone\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport {\r\n  Measure,\r\n  Section,\r\n  updatedRhythm\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { triggeredPause } from \"../../states/audio/audioSlice\";\r\nimport {\r\n  initializedProject,\r\n  LoadingStatus\r\n} from \"../../states/project/projectSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport Log from \"../log/log\";\r\nimport AudioPlayer from \"./audioPlayer\";\r\nimport PeaksConfig, {\r\n  AUDIO_DOM_ELEMENT,\r\n  ZOOMVIEW_CONTAINER\r\n} from \"./peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  audioUrl: string;\r\n  status: LoadingStatus;\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n  zoomLevel: number;\r\n  syncFirstMeasureStart: boolean;\r\n  isPlaying: boolean;\r\n  detune: number;\r\n  playbackRate: number;\r\n  secondsPerMeasure: number;\r\n  audioSampleRate: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  initializedProject: typeof initializedProject;\r\n  updatedRhythm: typeof updatedRhythm;\r\n  triggeredPause: typeof triggeredPause;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass AudioManagement extends React.Component<AllProps> {\r\n  peaks: Peaks.PeaksInstance | undefined;\r\n  player: AudioPlayer | undefined;\r\n\r\n  private getPeaks = () => this.peaks;\r\n  private getPlayer = () => this.player;\r\n\r\n  componentDidUpdate(prevProps: AllProps) {\r\n    Log.info(\r\n      \"componentDidUpdate with status \" +\r\n        prevProps.status +\r\n        \" -> \" +\r\n        this.props.status,\r\n      AudioManagement.name\r\n    );\r\n\r\n    // Early return if there is no audio file initialized yet.\r\n    if (this.props.status === LoadingStatus.NOT_INITIALIZED) return;\r\n\r\n    // Early return if an initialization is still in progress\r\n    if (\r\n      prevProps.status === this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    )\r\n      return;\r\n\r\n    // Initialize audio management if status changed to init\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    ) {\r\n      Log.info(\"initialize audio engine\", AudioManagement.name);\r\n      if (prevProps.audioUrl !== this.props.audioUrl) {\r\n        Log.info(\r\n          \"switch from \" + prevProps.audioUrl + \" to \" + this.props.audioUrl,\r\n          AudioManagement.name\r\n        );\r\n        PersistenceApi.revokeLocalFile(prevProps.audioUrl);\r\n      }\r\n      this.init();\r\n      return;\r\n    }\r\n\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZED\r\n    ) {\r\n      this.recomputeZoomlevels(\r\n        this.props.secondsPerMeasure,\r\n        this.props.audioSampleRate,\r\n        this.props.measures.allIds.length\r\n      );\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.zoomLevel,\r\n        this.props.secondsPerMeasure\r\n      );\r\n    }\r\n\r\n    if (\r\n      prevProps.secondsPerMeasure !== this.props.secondsPerMeasure ||\r\n      prevProps.audioSampleRate !== this.props.audioSampleRate ||\r\n      prevProps.measures.allIds.length !== this.props.measures.allIds.length\r\n    ) {\r\n      this.recomputeZoomlevels(\r\n        this.props.secondsPerMeasure,\r\n        this.props.audioSampleRate,\r\n        this.props.measures.allIds.length\r\n      );\r\n    }\r\n\r\n    if (\r\n      prevProps.sections !== this.props.sections ||\r\n      prevProps.measures !== this.props.measures ||\r\n      prevProps.zoomLevel !== this.props.zoomLevel\r\n    ) {\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.zoomLevel,\r\n        this.props.secondsPerMeasure\r\n      );\r\n    }\r\n\r\n    if (prevProps.playbackRate !== this.props.playbackRate) {\r\n      this.getPlayer()?.setPlaybackRate(this.props.playbackRate);\r\n    }\r\n\r\n    if (prevProps.detune !== this.props.detune) {\r\n      this.getPlayer()?.setDetune(this.props.detune);\r\n    }\r\n\r\n    if (prevProps.isPlaying !== this.props.isPlaying) {\r\n      if (this.props.isPlaying) {\r\n        this.getPlayer()?.play();\r\n      } else {\r\n        this.getPlayer()?.pause();\r\n      }\r\n    }\r\n  }\r\n\r\n  private recomputeZoomlevels(\r\n    secondsPerMeasure: number,\r\n    audioSampleRate: number,\r\n    measuresCount: number\r\n  ) {\r\n    let newZoomLevels = PeaksConfig.computeZoomLevels(\r\n      secondsPerMeasure,\r\n      audioSampleRate,\r\n      document.getElementById(ZOOMVIEW_CONTAINER)!.clientWidth,\r\n      measuresCount\r\n    );\r\n\r\n    //TODO: Used any because setZoomlevel is not API. See https://github.com/bbc/peaks.js/issues/295.\r\n    (this.getPeaks()?.zoom as any).setZoomLevels(newZoomLevels);\r\n  }\r\n\r\n  private repaintWaveform(\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>,\r\n    zoomLevel: number,\r\n    timePerMeasure: number\r\n  ) {\r\n    this.getPeaks()?.segments.removeAll();\r\n    this.getPeaks()?.segments.add(\r\n      PeaksConfig.sectionsToSegment(sections, measures, timePerMeasure)\r\n    );\r\n    this.getPeaks()?.points.removeAll();\r\n    this.getPeaks()?.points.add(PeaksConfig.measuresToPoints(measures));\r\n    this.getPeaks()?.zoom.setZoom(zoomLevel);\r\n  }\r\n\r\n  private init = () => {\r\n    const audioCtx: AudioContext = (Tone.context as unknown) as AudioContext;\r\n\r\n    this.getPeaks()?.destroy();\r\n\r\n    let audio = this;\r\n\r\n    // Load audioFile into audio buffer\r\n    fetch(this.props.audioUrl)\r\n      .then(function(response) {\r\n        return response.arrayBuffer();\r\n      })\r\n      .then(function(buffer) {\r\n        return audioCtx.decodeAudioData(buffer);\r\n      })\r\n      .then(function(audioBuffer) {\r\n        audio.initPeaks(audioBuffer);\r\n      });\r\n  };\r\n\r\n  private initPeaks(audioBuffer: AudioBuffer) {\r\n    Log.info(\"init peaks\", AudioManagement.name);\r\n\r\n    Peaks.init(PeaksConfig.create(audioBuffer), (err, peaks) => {\r\n      if (err) throw err;\r\n      if (peaks === undefined)\r\n        throw new Error(\"Peaks instance is not correctly initialized.\");\r\n\r\n      initPlayer(peaks, audioBuffer);\r\n      replacePlayer(peaks, audioBuffer);\r\n\r\n      peaks.on(\"player_seek\", (time: number) => {\r\n        if (this.props.syncFirstMeasureStart)\r\n          this.props.updatedRhythm({ firstMeasureStart: time });\r\n      });\r\n\r\n      this.peaks = peaks;\r\n\r\n      this.props.initializedProject({\r\n        audioDuration: audioBuffer.duration,\r\n        audioSampleRate: audioBuffer.sampleRate\r\n      });\r\n    });\r\n\r\n    let initPlayer = (peaks: Peaks.PeaksInstance, audioBuffer: AudioBuffer) => {\r\n      this.player = new AudioPlayer(peaks, audioBuffer, () =>\r\n        this.props.triggeredPause()\r\n      );\r\n    };\r\n\r\n    let replacePlayer = (\r\n      peaks: Peaks.PeaksInstance,\r\n      audioBuffer: AudioBuffer\r\n    ) => {\r\n      (peaks.player as any).destroy();\r\n      peaks.player = (this.player as unknown) as PeaksInstance[\"player\"];\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <audio id={AUDIO_DOM_ELEMENT} controls hidden>\r\n        {this.props.audioUrl ? (\r\n          <source src={this.props.audioUrl} type=\"audio/mpeg\" />\r\n        ) : null}\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({\r\n  project,\r\n  analysis,\r\n  audio,\r\n  wave\r\n}: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    sections: analysis.sections,\r\n    measures: analysis.measures,\r\n    zoomLevel: wave.zoom,\r\n    status: project.status,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    isPlaying: audio.isPlaying,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate,\r\n    secondsPerMeasure:\r\n      analysis.measures.byId[\"1\"]?.time - analysis.measures.byId[\"0\"]?.time,\r\n    audioSampleRate: analysis.audioSampleRate\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  initializedProject,\r\n  updatedRhythm,\r\n  triggeredPause\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AudioManagement);\r\n","import { configureStore, createAction } from \"@reduxjs/toolkit\";\r\nimport { AnyAction, combineReducers, Reducer } from \"redux\";\r\n\r\nimport analysisReducer, { AnalysisState } from \"./analysis/analysisSlice\";\r\nimport audioReducer, { AudioState } from \"./audio/audioSlice\";\r\nimport dialogReducer, { DialogState } from \"./dialog/dialogsSlice\";\r\nimport projectReducer, { ProjectState } from \"./project/projectSlice\";\r\nimport waveReducer, { WaveState } from \"./wave/waveSlice\";\r\n\r\n/** The top-level application state object. */\r\nexport interface ApplicationState {\r\n  analysis: AnalysisState;\r\n  audio: AudioState;\r\n  dialog: DialogState;\r\n  project: ProjectState;\r\n  wave: WaveState;\r\n}\r\n\r\nexport interface PersistedState {\r\n  analysis: AnalysisState;\r\n  project: ProjectState;\r\n}\r\n\r\nexport interface NormalizedObjects<T> {\r\n  byId: { [id: string]: T };\r\n  allIds: string[];\r\n}\r\n\r\nexport const restoredPersistedState = createAction<PersistedState>(\r\n  \"restoredPersistedState\"\r\n);\r\n\r\nexport const createRootReducer: Reducer<ApplicationState, AnyAction> = (\r\n  state,\r\n  action\r\n) => {\r\n  state = sliceReducer(state, action);\r\n\r\n  if (restoredPersistedState.match(action)) {\r\n    return state;\r\n  }\r\n\r\n  return state;\r\n};\r\n\r\nexport const sliceReducer = combineReducers({\r\n  analysis: analysisReducer,\r\n  audio: audioReducer,\r\n  dialog: dialogReducer,\r\n  project: projectReducer,\r\n  wave: waveReducer\r\n});\r\n\r\nconst createAppStore = () => {\r\n  const store = configureStore({\r\n    reducer: createRootReducer,\r\n    preloadedState: undefined\r\n  });\r\n\r\n  if (process.env.NODE_ENV !== \"production\" && module.hot) {\r\n    module.hot.accept(\"./store\", () => store.replaceReducer(createRootReducer));\r\n  }\r\n  return store;\r\n};\r\n\r\nexport default createAppStore();\r\n","import {\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText\r\n} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport interface DialogAction {\r\n  label: string;\r\n  onClick: () => void;\r\n  disabled?: boolean;\r\n}\r\n\r\ninterface ModalDialogProps {\r\n  title: string;\r\n  subTitle?: string;\r\n  onCancel: () => void;\r\n  actions?: DialogAction[];\r\n}\r\n\r\nclass ModalDialog extends Component<ModalDialogProps> {\r\n  render() {\r\n    return (\r\n      <Dialog\r\n        onClose={this.props.onCancel}\r\n        open={true}\r\n        fullWidth={true}\r\n        maxWidth={\"sm\"}\r\n      >\r\n        <DialogTitle>{this.props.title}</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>{this.props.subTitle}</DialogContentText>\r\n          {this.props.children}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          {this.props.actions?.map((value, index) => (\r\n            <Button\r\n              key={value.label}\r\n              onClick={value.onClick}\r\n              color=\"primary\"\r\n              disabled={value.disabled ?? false}\r\n            >\r\n              {value.label}\r\n            </Button>\r\n          ))}\r\n        </DialogActions>\r\n      </Dialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ModalDialog;\r\n","import { FormLabel } from \"@material-ui/core\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport React, { Component, FunctionComponent, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport {\r\n  addedSection,\r\n  initialAnalysisState,\r\n  SectionType\r\n} from \"../../states/analysis/analysisSlice\";\r\nimport { closedDialog, DialogType } from \"../../states/dialog/dialogsSlice\";\r\nimport {\r\n  createdProject,\r\n  initialProjectState,\r\n  Page,\r\n  switchedPage\r\n} from \"../../states/project/projectSlice\";\r\nimport store, { ApplicationState } from \"../../states/store\";\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\nimport FileInput, { FileType } from \"../fileInput/fileInput\";\r\nimport MeasureSelect from \"../measureSelect/measureSelect\";\r\nimport ModalDialog, { DialogAction } from \"../modalDialog/modalDialog\";\r\nimport SectionSelect from \"../sectionSelect/sectionSelect\";\r\n\r\ninterface PropsFromState {\r\n  type: DialogType;\r\n  audioUrl: string;\r\n  maxMeasure: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  switchedPage: typeof switchedPage;\r\n  closedDialog: typeof closedDialog;\r\n  createdProject: typeof createdProject;\r\n  addedSection: typeof addedSection;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass DialogManagement extends Component<AllProps> {\r\n  render() {\r\n    switch (this.props.type) {\r\n      case DialogType.NONE:\r\n        return null;\r\n      case DialogType.NEW:\r\n        return (\r\n          <NewDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(title: string, audioUrl: string) => {\r\n              this.props.createdProject({\r\n                analysis: initialAnalysisState,\r\n                project: { ...initialProjectState, audioUrl, title }\r\n              });\r\n              this.props.switchedPage(Page.STRUCTURE);\r\n              this.props.closedDialog();\r\n            }}\r\n          ></NewDialog>\r\n        );\r\n      case DialogType.OPEN:\r\n        return (\r\n          <OpenDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(zip: File, zipUrl: string) => {\r\n              PersistenceApi.open(zip).then(({ audioBlob, state }) => {\r\n                let audioUrl = PersistenceApi.getLocalFileUrl(audioBlob);\r\n                PersistenceApi.revokeLocalFile(zipUrl);\r\n\r\n                this.props.createdProject({\r\n                  analysis: state.analysis,\r\n                  project: { ...state.project, audioUrl }\r\n                });\r\n                this.props.switchedPage(Page.STRUCTURE);\r\n                this.props.closedDialog();\r\n              });\r\n            }}\r\n          ></OpenDialog>\r\n        );\r\n      case DialogType.SAVE:\r\n        return (\r\n          <ModalDialog\r\n            title=\"Save Transcription\"\r\n            subTitle=\"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.\"\r\n            onCancel={this.props.closedDialog}\r\n            actions={[\r\n              {\r\n                label: \"Cancel\",\r\n                onClick: () => this.props.closedDialog()\r\n              },\r\n              {\r\n                label: \"Save\",\r\n                onClick: () => {\r\n                  PersistenceApi.save(\"transcription.zip\", {\r\n                    audioFileUrl: this.props.audioUrl,\r\n                    state: store.getState()\r\n                  });\r\n                  this.props.closedDialog();\r\n                }\r\n              }\r\n            ]}\r\n          ></ModalDialog>\r\n        );\r\n      case DialogType.ADD_SECTION:\r\n        return (\r\n          <AddSectionDialog\r\n            maxMeasure={this.props.maxMeasure}\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(sectionType, start, end) => {\r\n              this.props.addedSection({\r\n                measures: ArrayUtil.range(start, end),\r\n                type: sectionType\r\n              });\r\n              this.props.closedDialog();\r\n            }}\r\n          ></AddSectionDialog>\r\n        );\r\n      default:\r\n        throw Error();\r\n    }\r\n  }\r\n}\r\n\r\nconst NewDialog: FunctionComponent<{\r\n  onSubmit: (title: string, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [title, setTitle] = useState(\"\");\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Create\",\r\n        onClick: () => props.onSubmit(title, fileUrl),\r\n        disabled: fileUrl === \"\" || title === \"\"\r\n      }\r\n    ];\r\n  };\r\n\r\n  const handleTitleChange = (event: any) => setTitle(event.target.value);\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Create new Transcription\"\r\n      subTitle=\"Please add a project title and select an audio file from your hard disk below.\"\r\n      actions={actions()}\r\n      onCancel={props.onCancel}\r\n    >\r\n      <FormControl fullWidth>\r\n        <TextField\r\n          id=\"title\"\r\n          label=\"Project title\"\r\n          margin=\"normal\"\r\n          InputProps={{\r\n            readOnly: false\r\n          }}\r\n          variant=\"outlined\"\r\n          onChange={handleTitleChange}\r\n        />\r\n        <FileInput\r\n          fileType={FileType.AUDIO}\r\n          id=\"audio_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst OpenDialog: FunctionComponent<{\r\n  onSubmit: (file: File, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [file, setFile] = useState<File>();\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Open\",\r\n        onClick: () => props.onSubmit(file!, fileUrl),\r\n        disabled: fileUrl === \"\"\r\n      }\r\n    ];\r\n  };\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Open Transcription\"\r\n      subTitle=\"Please select a project zip file from your hard disk below.\"\r\n      onCancel={props.onCancel}\r\n      actions={actions()}\r\n    >\r\n      <FormControl fullWidth>\r\n        <FileInput\r\n          fileType={FileType.ZIP}\r\n          id=\"zip_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n            setFile(file);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst AddSectionDialog: FunctionComponent<{\r\n  maxMeasure: number;\r\n  onSubmit: (sectionType: SectionType, start: number, end: number) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [sectionType, setSectionType] = useState(SectionType.INTRO);\r\n  const [start, setStart] = useState(0);\r\n  const [end, setEnd] = useState(0);\r\n  const actions: () => DialogAction[] = () => {\r\n    return [\r\n      {\r\n        label: \"Cancel\",\r\n        onClick: () => props.onCancel()\r\n      },\r\n      {\r\n        label: \"Add\",\r\n        onClick: () => props.onSubmit(sectionType, start, end),\r\n        disabled: sectionType === SectionType.UNDEFINED || start > end\r\n      }\r\n    ];\r\n  };\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Add new Section\"\r\n      subTitle=\"Please define section and add it to the song structure.\"\r\n      actions={actions()}\r\n      onCancel={props.onCancel}\r\n    >\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">Section Type</FormLabel>\r\n        <SectionSelect\r\n          value={sectionType}\r\n          onChange={sectionType => setSectionType(sectionType)}\r\n        ></SectionSelect>\r\n      </FormControl>\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">First Measure</FormLabel>\r\n        <MeasureSelect\r\n          value={start}\r\n          min={0}\r\n          max={props.maxMeasure}\r\n          onChange={value => setStart(value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl fullWidth style={{ marginBottom: \"20px\" }}>\r\n        <FormLabel component=\"legend\">Last Measure</FormLabel>\r\n        <MeasureSelect\r\n          value={end}\r\n          min={0}\r\n          max={props.maxMeasure}\r\n          onChange={value => setEnd(value)}\r\n        />\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ dialog, project, analysis }: ApplicationState) => {\r\n  return {\r\n    type: dialog.currentDialog,\r\n    audioUrl: project.audioUrl,\r\n    maxMeasure: analysis.measures.allIds.length - 1\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  closedDialog,\r\n  switchedPage,\r\n  createdProject,\r\n  addedSection\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogManagement);\r\n","import blueGrey from \"@material-ui/core/colors/blueGrey\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"light\",\n    primary: blueGrey\n  }\n});\n\nexport default theme;\n","import CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport React from \"react\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport App from \"./components/app/app\";\nimport AudioManagement from \"./components/audioManagement/audioManagement\";\nimport DialogManagement from \"./components/dialogManagement/dialogManagement\";\nimport store from \"./states/store\";\nimport theme from \"./styles/theme\";\n\nif (process.env.NODE_ENV !== \"production\") {\n  localStorage.setItem(\"debug\", \"transcribe:*\");\n}\n\nconst renderApp = () =>\n  render(\n    <Provider store={store}>\n      <ThemeProvider theme={theme}>\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n        <CssBaseline />\n        <AudioManagement />\n        <DialogManagement />\n        <App />\n      </ThemeProvider>\n    </Provider>,\n    document.getElementById(\"root\")\n  );\n\nif (process.env.NODE_ENV !== \"production\" && module.hot) {\n  module.hot.accept(\"./components/app/app\", renderApp);\n}\n\nrenderApp();\n"],"sourceRoot":""}