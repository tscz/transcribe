(this.webpackJsonptranscribe=this.webpackJsonptranscribe||[]).push([[0],{208:function(e,t,a){e.exports=a(294)},260:function(e,t){},262:function(e,t){},294:function(e,t,a){"use strict";a.r(t);var n,r=a(368),i=a(340),l=a(0),s=a.n(l),o=a(16),c=a(20),u=a(7),p=a(8),d=a(9),m=a(10),h=a(11),f=a(338),b=a(357),y=a(302),E=a(369),g=a(300),v=a(301),O=a(359),I=a(360),j=a(4),C=a(358),S=a(40),k=a(186),R=a.n(k),P=a(183),T=a.n(P),D=a(184),N=a.n(D),w=a(187),U=a.n(w),F=a(185),M=a.n(F),A=a(336),z=a(334),x=a(337),L=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(z.a,{style:{height:"100%",backgroundColor:"#ffffff"},raised:!1},s.a.createElement(A.a,{titleTypographyProps:{variant:"subtitle1"},title:this.props.title,style:{backgroundColor:"#f1f4f6",padding:"4px"},action:this.props.action}),s.a.createElement(x.a,null,this.props.body))}}]),t}(l.Component),_=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(L,{title:"Info",body:s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"No Transcription started!!"),s.a.createElement("p",null,"Please create a new Transcription or open an existing one."))})}}]),t}(s.a.Component),Z=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(L,{title:"Drums View",body:s.a.createElement("p",null,"In this section you'll be able to transcribe the drum part. Please come back later.")})}}]),t}(s.a.Component),B=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(L,{title:"Guitar",body:s.a.createElement("p",null,"In this section you'll be able to transcribe the guitar part. Please come back later.")})}}]),t}(s.a.Component),H=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(L,{title:"Harmony",body:s.a.createElement("p",null,"In this section you'll be able to transcribe the harmony. Please come back later.")})}}]),t}(s.a.Component),W=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(L,{title:"Print",body:s.a.createElement("p",null,"In this section you'll be able to print the leadsheet. Please come back later.")})}}]),t}(s.a.Component),V=a(130),G=a(370),Y=a(349),J=a(179),q=a.n(J),K=a(177),Q=a.n(K),X=a(178),$=a.n(X),ee=a(180),te=a.n(ee),ae=a(181),ne=a.n(ae),re=a(182),ie=a.n(re),le=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,{container:!0,spacing:2,alignItems:"stretch"},s.a.createElement(f.a,{item:!0,xs:9},this.props.topLeft),s.a.createElement(f.a,{item:!0,xs:3},this.props.topRight),s.a.createElement(f.a,{item:!0,xs:12},this.props.bottom))}}]),t}(s.a.Component),se=a(168),oe=a.n(se);!function(e){e.TRACE="trace",e.INFO="info",e.WARN="warn",e.ERROR="error"}(n||(n={}));var ce,ue,pe=new Map([[n.TRACE,"lightblue"],[n.INFO,"blue"],[n.WARN,"yellow"],[n.ERROR,"red"]]),de=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"generateMessage",value:function(e,t,a){var n="transcribe:".concat(e),r=oe()(n);r.color=pe.get(e),a?r(a,t):r(t)}},{key:"trace",value:function(e,t){return this.generateMessage(n.TRACE,e,t)}},{key:"info",value:function(e,t){return this.generateMessage(n.INFO,e,t)}},{key:"warn",value:function(e,t){return this.generateMessage(n.WARN,e,t)}},{key:"error",value:function(e,t){return this.generateMessage(n.ERROR,e,t)}}]),e}(),me=a(29),he=Object(me.c)({name:"audio",initialState:{isPlaying:!1,detune:0,playbackRate:1},reducers:{triggeredPlay:function(e){e.isPlaying=!0},triggeredPause:function(e){e.isPlaying=!1},updatedPlaybackSettings:function(e,t){void 0!==t.payload.detune&&(e.detune=t.payload.detune),void 0!==t.payload.playbackRate&&(e.playbackRate=t.payload.playbackRate)}}}),fe=he.actions,be=fe.triggeredPause,ye=fe.triggeredPlay,Ee=fe.updatedPlaybackSettings,ge=he.reducer,ve=a(50);!function(e){e.NOT_INITIALIZED="not_initialized",e.INITIALIZING="initializing",e.INITIALIZED="initialized"}(ce||(ce={})),function(e){e.DEFAULT="default",e.STRUCTURE="structure",e.HARMONY="harmony",e.GUITAR="guitar",e.DRUM="drum",e.PRINT="print"}(ue||(ue={}));var Oe={status:ce.NOT_INITIALIZED,currentPage:ue.DEFAULT,title:"",audioUrl:"",syncFirstMeasureStart:!1},Ie=Object(me.c)({name:"project",initialState:Oe,reducers:{switchedPage:function(e,t){e.currentPage=t.payload},createdProject:function(e,t){return Object(ve.a)({},t.payload.project,{status:ce.INITIALIZING})},hotReloaded:function(e){e.status=ce.INITIALIZING},initializedProject:function(e,t){e.status=ce.INITIALIZED},enabledSyncFirstMeasureStart:function(e,t){e.syncFirstMeasureStart=t.payload}}}),je=Ie.actions,Ce=je.switchedPage,Se=je.createdProject,ke=je.initializedProject,Re=je.hotReloaded,Pe=je.enabledSyncFirstMeasureStart,Te=Ie.reducer,De=Object(me.c)({name:"wave",initialState:{zoom:0},reducers:{zoomedOut:function(e){e.zoom=42===e.zoom?e.zoom:e.zoom+1},zoomedIn:function(e){e.zoom=0===e.zoom?e.zoom:e.zoom-1}}}),Ne=De.actions,we=Ne.zoomedIn,Ue=Ne.zoomedOut,Fe=De.reducer,Me=a(343),Ae=a(94),ze=a(344),xe=a(345),Le=a(346),_e=a(347),Ze=a(348),Be=a(171),He=a.n(Be),We=a(170),Ve=a.n(We),Ge=a(342),Ye=a(89),Je=a.n(Ye),qe=function(e){return s.a.createElement(Je.a,{value:e.value,onChange:function(t){var a=t.target.value;e.onChange(a)},style:{minWidth:"40px"},disabled:e.disabled},new Array(e.max-e.min+1).fill(0).map((function(t,a){return s.a.createElement(Ge.a,{key:e.min+a,value:e.min+a},e.min+a)})))},Ke=function e(){Object(u.a)(this,e)};Ke.range=function(e,t){return e>t&&(e=t),Array(t-e+1).fill(e).map((function(t,a){return(e+a).toString()}))},Ke.bordersOf=function(e){return{start:parseInt(e[0]),end:parseInt(Ke.last(e))}},Ke.last=function(e){return e[e.length-1]};var Qe,Xe,$e=Ke,et=function(e,t,a,n){for(var r,i=t;i<a;i++)delete e.byId[e.allIds[i]];var l=[];n.forEach((function(t){var a=tt(t);l.push(a),e.byId[a]=t})),(r=e.allIds).splice.apply(r,[t,a].concat(l))},tt=function(e){return e.type+"_"+e.measures[0]+"_"+e.measures[e.measures.length-1]},at=function(e,t,a,n){for(var r=60*function(e){switch(e){case Qe.FOUR_FOUR:return{beatUnit:4,beatsPerMeasure:4};case Qe.THREE_FOUR:return{beatUnit:4,beatsPerMeasure:3}}}(e).beatsPerMeasure/t,i={allIds:[],byId:{}},l=0,s=a;s<n;s+=r)i.allIds.push(""+l),i.byId[l]={time:s,color:"",editable:!1,id:""+l,labelText:""+l},l++;return i};!function(e){e.FOUR_FOUR="FOUR_FOUR",e.THREE_FOUR="THREE_FOUR"}(Qe||(Qe={})),function(e){e.INTRO="INTRO",e.VERSE="VERSE",e.PRECHORUS="PRECHORUS",e.CHORUS="CHORUS",e.BRIDGE="BRIDGE",e.SOLO="SOLO",e.OUTRO="OUTRO",e.UNDEFINED="UNDEFINED"}(Xe||(Xe={}));var nt={sections:{allIds:[],byId:{}},bpm:120,firstMeasureStart:0,audioDuration:180,audioSampleRate:44400,measures:{allIds:[],byId:{}},timeSignature:Qe.FOUR_FOUR},rt=Object(me.c)({name:"analysis",initialState:nt,extraReducers:function(e){return e.addCase(Se,(function(e,t){return t.payload.analysis})).addCase(ke,(function(e,t){e.audioDuration=t.payload.audioDuration,e.audioSampleRate=t.payload.audioSampleRate,e.measures=at(e.timeSignature,e.bpm,e.firstMeasureStart,e.audioDuration),e.sections=function(e){var t,a="UNDEFINED_0_"+e;return(t={allIds:[a],byId:{}}).byId[a]={measures:$e.range(0,e),type:Xe.UNDEFINED},t}(e.measures.allIds.length-1)}))},reducers:{addedSection:function(e,t){return lt(e,t.payload)},updatedSection:function(e,t){return st(e,t.payload.before),lt(e,t.payload.after)},removedSection:function(e,t){return st(e,t.payload),e},updatedRhythm:function(e,t){var a,n,r;e.bpm=null!==(a=t.payload.bpm)&&void 0!==a?a:e.bpm,e.firstMeasureStart=null!==(n=t.payload.firstMeasureStart)&&void 0!==n?n:e.firstMeasureStart,e.timeSignature=null!==(r=t.payload.timeSignatureType)&&void 0!==r?r:e.timeSignature,e.measures=at(e.timeSignature,e.bpm,e.firstMeasureStart,e.audioDuration);var i=e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]];if(void 0===i)return e;if(parseInt($e.last(e.measures.allIds))>parseInt(i.measures[i.measures.length-1])){var l={type:i.type,measures:$e.range(parseInt(i.measures[0]),parseInt($e.last(e.measures.allIds)))},s=tt(l);delete e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]],e.sections.allIds[e.sections.allIds.length-1]=s,e.sections.byId[s]=l}return it(e),e}}}),it=function(e){for(var t=e.measures.allIds.length-1,a=-1,n=-1,r=0;r<=e.sections.allIds.length-1;r++){var i=e.sections.byId[e.sections.allIds[r]];if(parseInt($e.last(i.measures))>t){a=r,n=parseInt(i.measures[0]);break}}-1!==a&&et(e.sections,a,e.sections.allIds.length-a,[{measures:$e.range(n,t),type:Xe.UNDEFINED}])},lt=function(e,t){if(a=t,parseInt(a.measures[0])>=parseInt(a.measures[a.measures.length-1]))return e;var a,n=function(e,t){for(var a=$e.bordersOf(e.measures),n=a.start,r=a.end,i=t.allIds.length,l=0;l<=i-1;l++){var s=t.byId[t.allIds[l]],o=$e.bordersOf(s.measures).end;if(!(n>=o)){if(r>o)return;return{position:l,section:s}}}}(t,e.sections);if(void 0===n||n.section.type!==Xe.UNDEFINED)return e;var r=function(e,t){var a=[],n=$e.bordersOf(t.measures),r=n.start,i=n.end,l=$e.bordersOf(e.measures),s=l.start,o=l.end;if(r>s){var c={measures:$e.range(s,r),type:Xe.UNDEFINED};a.push(c)}if(a.push(t),i<o){var u={measures:$e.range(i,o),type:Xe.UNDEFINED};a.push(u)}return a}(n.section,t);return et(e.sections,n.position,1,r),e},st=function(e,t){var a=e.sections.allIds.indexOf(t),n=e.sections.byId[t],r=e.sections.allIds[a-1],i=e.sections.allIds[a+1],l=$e.bordersOf(n.measures),s=l.start,o=l.end,c=a,u=1;void 0!==r&&e.sections.byId[r].type===Xe.UNDEFINED&&(c--,u++,s=parseInt(e.sections.byId[r].measures[0])),void 0!==i&&e.sections.byId[i].type===Xe.UNDEFINED&&(u++,o=parseInt($e.last(e.sections.byId[i].measures))),et(e.sections,c,u,[{measures:$e.range(s,o),type:Xe.UNDEFINED}])},ot=rt.actions,ct=ot.addedSection,ut=ot.removedSection,pt=ot.updatedRhythm,dt=ot.updatedSection,mt=rt.reducer,ht=function e(){Object(u.a)(this,e)};ht.create=function(e){var t=document.getElementById("audio_dom_element");return{containers:{zoomview:document.getElementById("zoomview-container"),overview:document.getElementById("overview-container")},mediaElement:t,webAudio:{audioBuffer:e,scale:128,multiChannel:!1},keyboard:!0,pointMarkerColor:"#006eb0",showPlayheadTime:!0,zoomLevels:[42]}},ht.sectionsToSegment=function(e,t){var a=[];return e.allIds.forEach((function(n){var r=e.byId[n],i={id:n,labelText:r.type,startTime:t.byId[r.measures[0]].time,endTime:t.byId[r.measures[r.measures.length-1]].time,color:ht.SECTIONTYPE_TO_COLOR.get(r.type),editable:!1};a.push(i)})),a},ht.measuresToPoints=function(e){var t=[];return e.allIds.forEach((function(a){var n=e.byId[a];t.push(n)})),t},ht.computeZoomLevels=function(e,t,a,n){for(var r=Math.floor(e*t/a),i=new Array(n),l=0;l<i.length;l++)i[l]=r*(l+1);return i},ht.SECTIONTYPE_TO_COLOR=new Map([[Xe.INTRO,"#FFCA28"],[Xe.VERSE,"#FFA726"],[Xe.PRECHORUS,"#FF7043"],[Xe.CHORUS,"#9CCC65"],[Xe.SOLO,"#26C6DA"],[Xe.OUTRO,"#5C6BC0"],[Xe.BRIDGE,"#EC407A"],[Xe.VERSE,"#78909C"],[Xe.UNDEFINED,"#ffffff"]]);var ft,bt=ht,yt=function(e){return s.a.createElement(Je.a,{value:e.value,onChange:function(t){var a=t.target.value;e.onChange(a)},style:{backgroundColor:bt.SECTIONTYPE_TO_COLOR.get(e.value),minWidth:"140px"}},Object.values(Xe).map((function(e){return e===Xe.UNDEFINED?void 0:s.a.createElement(Ge.a,{key:e,value:e,style:{backgroundColor:bt.SECTIONTYPE_TO_COLOR.get(e)}},e)})))};!function(e){e.NONE="none",e.NEW="new",e.OPEN="open",e.SAVE="save",e.ADD_SECTION="add_section"}(ft||(ft={}));var Et={currentDialog:ft.NONE},gt=Object(me.c)({name:"dialogs",initialState:Et,reducers:{openedDialog:function(e,t){e.currentDialog=t.payload},closedDialog:function(e){e.currentDialog=ft.NONE}}}),vt=gt.actions,Ot=vt.openedDialog,It=vt.closedDialog,jt=gt.reducer,Ct=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleAddSection=function(e){a.props.addedSection(e)},a.handleUpdatedSection=function(e,n,r){de.info("Change section "+e+" from "+JSON.stringify(n)+" to "+JSON.stringify(r),t.name),parseInt(r.measures[0])>parseInt(r.measures[r.measures.length-1])||a.props.updatedSection({before:e,after:r})},a.handleRemoveSection=function(e){a.props.removedSection(e)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(Me.a,{component:Ae.a},s.a.createElement(ze.a,{size:"small"},s.a.createElement(xe.a,null,s.a.createElement(Le.a,null,s.a.createElement(_e.a,{style:{width:"10%"}}),s.a.createElement(_e.a,{style:{width:"30%"}},"Section"),s.a.createElement(_e.a,{style:{width:"30%"}},"First Measure"),s.a.createElement(_e.a,{style:{width:"30%"}},"Last Measure"))),s.a.createElement(Ze.a,null,this.props.sections.allIds.map((function(t){var a=e.props.sections.byId[t];return s.a.createElement(Le.a,{key:t},s.a.createElement(_e.a,{component:"th",scope:"row"},a.type!==Xe.UNDEFINED&&s.a.createElement(Y.a,{onClick:function(){return e.handleRemoveSection(t)},size:"small"},s.a.createElement(Ve.a,null))),s.a.createElement(_e.a,null,a.type===Xe.UNDEFINED?"UNDEFINED":s.a.createElement(yt,{value:a.type,onChange:function(n){return e.handleUpdatedSection(t,a,Object(ve.a)({},a,{type:n}))}})),s.a.createElement(_e.a,null,s.a.createElement(qe,{disabled:a.type===Xe.UNDEFINED,value:parseInt(a.measures[0]),min:0,max:e.props.measuresCount-1,onChange:function(n){return e.handleUpdatedSection(t,a,Object(ve.a)({},a,{measures:$e.range(n,parseInt(a.measures[a.measures.length-1]))}))}})),s.a.createElement(_e.a,null,s.a.createElement(qe,{disabled:a.type===Xe.UNDEFINED,value:parseInt(a.measures[a.measures.length-1]),min:0,max:e.props.measuresCount-1,onChange:function(n){return e.handleUpdatedSection(t,a,Object(ve.a)({},a,{measures:$e.range(parseInt(a.measures[0]),n)}))}})))})),s.a.createElement(Le.a,{key:"last"},s.a.createElement(_e.a,{component:"th",scope:"row"},s.a.createElement(Y.a,{onClick:function(){return e.props.openedDialog(ft.ADD_SECTION)},size:"small"},s.a.createElement(He.a,null))),s.a.createElement(_e.a,null),s.a.createElement(_e.a,null),s.a.createElement(_e.a,null)))))}}]),t}(l.Component),St={addedSection:ct,updatedSection:dt,removedSection:ut,openedDialog:Ot},kt=Object(c.b)((function(e){var t=e.analysis;return{sections:t.sections,measuresCount:t.measures.allIds.length}}),St)(Ct),Rt=a(350),Pt=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.sections,a=e.measures;return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{container:!0,direction:"column"},t.allIds.map((function(e){return s.a.createElement(f.a,{item:!0,key:e},s.a.createElement(f.a,{container:!0,direction:"column"},s.a.createElement(f.a,{item:!0,key:e+"_caption"},s.a.createElement(S.a,{variant:"caption"},t.byId[e].type.toLowerCase())),s.a.createElement(f.a,{item:!0,key:e+"_body"},s.a.createElement(f.a,{container:!0,direction:"column",style:{marginBottom:"5px"}},function(e,t){for(var a=[],n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a}(t.byId[e].measures,8).map((function(n){return s.a.createElement(Rt.a,{key:e+"_buttonGroup_"+n[0],orientation:"horizontal",size:"small"},n.map((function(n){var r=a.byId[n];return s.a.createElement(Tt,{key:r.id,value:r.id,bg:bt.SECTIONTYPE_TO_COLOR.get(t.byId[e].type)})})))}))))))}))))}}]),t}(s.a.Component),Tt=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(y.a,Object.assign({},this.props,{style:{backgroundColor:this.props.bg}}),this.props.value)}}]),t}(s.a.Component),Dt=Object(c.b)((function(e){var t=e.analysis;return{sections:t.sections,measures:t.measures}}),{})(Pt),Nt=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(Dt,null)}}]),t}(l.Component),wt=Object(c.b)((function(e){e.analysis;return{}}),{})(Nt),Ut=a(351),Ft=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.url!==this.props.url}},{key:"render",value:function(){return de.info("render with url="+this.props.url,t.name),s.a.createElement("div",null,s.a.createElement("div",{id:"waveform-container"},s.a.createElement("div",{id:"zoomview-container"}),s.a.createElement("div",{id:"overview-container"})))}}]),t}(l.Component),Mt=function(e){function t(e){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return de.info("render with props="+JSON.stringify(this.props),t.name),s.a.createElement("div",null,this.props.audioLoaded!==ce.INITIALIZED&&s.a.createElement(Ut.a,null),s.a.createElement(Ft,{url:this.props.audioUrl}))}}]),t}(l.Component),At={hotReloaded:Re},zt=Object(c.b)((function(e){var t=e.project;return{audioUrl:t.audioUrl,audioLoaded:t.status}}),At)(Mt),xt=a(352),Lt=a(353),_t=a(111),Zt=a(174),Bt=a(366),Ht=a(354),Wt=a(371),Vt=a(173),Gt=a.n(Vt),Yt=a(355),Jt=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleTimeSignatureChange=function(e){a.props.updatedRhythm({timeSignatureType:e.target.value})},a.handleBpmChange=function(e,t){Array.isArray(t)||a.props.updatedRhythm({bpm:t})},a.handleDetuneChange=function(e,t){Array.isArray(t)||t===a.props.detune||a.props.updatedPlaybackSettings({detune:t})},a.handlePlaybackRateChange=function(e,t){Array.isArray(t)||t===a.props.playbackRate||a.props.updatedPlaybackSettings({playbackRate:t})},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{container:!0,direction:"column",spacing:3},s.a.createElement(f.a,{item:!0},s.a.createElement(xt.a,{fullWidth:!0},s.a.createElement(Lt.a,null,"Start Measure 1"),s.a.createElement(_t.a,{type:"text",id:"startMeasure1",value:this.props.firstMeasureStart,startAdornment:s.a.createElement(Ht.a,{position:"start"},s.a.createElement(G.a,{title:"Sync with play head"},s.a.createElement(Yt.a,{style:{width:"15px",height:"25px"},value:"check",selected:this.props.syncFirstMeasureStart,onChange:function(){e.props.enabledSyncFirstMeasureStart(!e.props.syncFirstMeasureStart)}},s.a.createElement(Gt.a,null))))}))),s.a.createElement(f.a,{item:!0},s.a.createElement(qt,{title:"Bpm",value:this.props.bpm,min:40,max:220,step:1,onChange:this.handleBpmChange})),s.a.createElement(f.a,{item:!0},s.a.createElement(xt.a,{fullWidth:!0},s.a.createElement(Lt.a,null,"Time Signature"),s.a.createElement(Zt.a,{value:this.props.timeSignature,onChange:this.handleTimeSignatureChange},s.a.createElement("option",{value:Qe.FOUR_FOUR},"4/4"),s.a.createElement("option",{value:Qe.THREE_FOUR},"3/4")))),s.a.createElement(f.a,{item:!0},s.a.createElement(qt,{title:"Detune",value:this.props.detune,min:-12,max:12,step:.5,onChange:this.handleDetuneChange})),s.a.createElement(f.a,{item:!0},s.a.createElement(qt,{title:"Playback rate",value:this.props.playbackRate,min:.4,max:1.2,step:.05,onChange:this.handlePlaybackRateChange}))))}}]),t}(l.Component),qt=function(e){return s.a.createElement(xt.a,{style:{width:"100%"}},s.a.createElement(Lt.a,{shrink:!0},e.title),s.a.createElement(Bt.a,{mt:2},s.a.createElement(Wt.a,{value:e.value,valueLabelDisplay:"auto",min:e.min,max:e.max,onChange:e.onChange,step:e.step})))},Kt={updatedRhythm:pt,enabledSyncFirstMeasureStart:Pe,updatedPlaybackSettings:Ee},Qt=Object(c.b)((function(e){var t=e.project,a=e.analysis,n=e.audio,r=e.wave;return{firstMeasureStart:a.firstMeasureStart,bpm:a.bpm,timeSignature:a.timeSignature,syncFirstMeasureStart:t.syncFirstMeasureStart,detune:n.detune,playbackRate:n.playbackRate,zoom:r.zoom,status:t.status}}),Kt)(Jt),Xt=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={anchorEl:null},a.handleClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return de.info("render",t.name),s.a.createElement(le,{topLeft:s.a.createElement(L,{title:"Song Overview",body:s.a.createElement(zt,null),action:s.a.createElement(s.a.Fragment,null,this.props.isPlaying?s.a.createElement($t,{title:"Pause",icon:s.a.createElement(Q.a,null),onClick:function(){return e.props.triggeredPause()}}):s.a.createElement($t,{title:"Play",icon:s.a.createElement($.a,null),onClick:function(){return e.props.triggeredPlay()}}),s.a.createElement($t,{title:"Loop",icon:s.a.createElement(q.a,null)}),s.a.createElement($t,{title:"Metronome",icon:s.a.createElement(te.a,null),onClick:function(t){return e.handleClick(t)}}),s.a.createElement(V.a,{style:{height:"400px"},open:Boolean(this.state.anchorEl),anchorEl:this.state.anchorEl,onClose:function(){return e.handleClose()},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},s.a.createElement(Qt,null)),s.a.createElement($t,{title:"Zoom in",icon:s.a.createElement(ne.a,null),onClick:function(){return e.props.zoomedIn()}}),s.a.createElement($t,{title:"Zoom out",icon:s.a.createElement(ie.a,null),onClick:function(){return e.props.zoomedOut()}}))}),topRight:s.a.createElement(L,{title:"Song Measures",body:s.a.createElement(wt,null)}),bottom:s.a.createElement(L,{title:"Song Structure",body:s.a.createElement(kt,null)})})}}]),t}(s.a.Component),$t=function(e){return s.a.createElement(G.a,{title:e.title},s.a.createElement(Y.a,{onClick:e.onClick,size:"small",style:{marginTop:"8px",marginRight:"5px"}},e.icon))},ea={zoomedIn:we,zoomedOut:Ue,triggeredPlay:ye,triggeredPause:be},ta=Object(c.b)((function(e){var t=e.project,a=e.audio;return{loaded:t.status===ce.INITIALIZED,isPlaying:a.isPlaying}}),ea)(Xt),aa=a(356),na=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.version," (",s.a.createElement("a",{href:"https://github.com/tscz/transcribe/commit/"+this.props.hash},this.props.hash," - ",this.props.description),")")}}]),t}(s.a.Component);function ra(){return(ra=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ia(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var la=s.a.createElement("path",{d:"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z"}),sa=s.a.createElement("path",{d:"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z"}),oa=s.a.createElement("path",{d:"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z"}),ca=s.a.createElement("path",{d:"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z"}),ua=s.a.createElement("path",{d:"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z"}),pa=s.a.createElement("path",{d:"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z"}),da=s.a.createElement("path",{d:"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z"}),ma=s.a.createElement("path",{d:"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z"}),ha=s.a.createElement("path",{d:"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z"}),fa=s.a.createElement("path",{d:"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z"}),ba=s.a.createElement("g",null),ya=s.a.createElement("g",null),Ea=s.a.createElement("g",null),ga=s.a.createElement("g",null),va=s.a.createElement("g",null),Oa=s.a.createElement("g",null),Ia=s.a.createElement("g",null),ja=s.a.createElement("g",null),Ca=s.a.createElement("g",null),Sa=s.a.createElement("g",null),ka=s.a.createElement("g",null),Ra=s.a.createElement("g",null),Pa=s.a.createElement("g",null),Ta=s.a.createElement("g",null),Da=s.a.createElement("g",null),Na=function(e){var t=e.svgRef,a=e.title,n=ia(e,["svgRef","title"]);return s.a.createElement("svg",ra({id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:t},n),a?s.a.createElement("title",null,a):null,s.a.createElement("path",{style:{fill:"#EADCD6"},d:"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z"}),s.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z"}),s.a.createElement("path",{style:{fill:"#EADCD6"},d:"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z "}),s.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z"}),s.a.createElement("g",null,s.a.createElement("path",{style:{fill:"#F8BF00"},d:"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z"}),s.a.createElement("circle",{style:{fill:"#F8BF00"},cx:201.212,cy:201.242,r:22.708}),s.a.createElement("circle",{style:{fill:"#F8BF00"},cx:331.22,cy:201.242,r:22.708})),s.a.createElement("g",null,s.a.createElement("path",{style:{fill:"#EFA603"},d:"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z"}),s.a.createElement("path",{style:{fill:"#EFA603"},d:"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z"}),s.a.createElement("path",{style:{fill:"#EFA603"},d:"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z"})),s.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z"}),s.a.createElement("path",{style:{fill:"#C9BCB8"},d:"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z"}),la,sa,oa,ca,ua,pa,da,ma,ha,fa,ba,ya,Ea,ga,va,Oa,Ia,ja,Ca,Sa,ka,Ra,Pa,Ta,Da)},wa=s.a.forwardRef((function(e,t){return s.a.createElement(Na,ra({svgRef:t},e))})),Ua=(a.p,function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return de.info("render",t.name),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:this.props.classes.root},s.a.createElement(b.a,{position:"fixed",className:this.props.classes.appBar},s.a.createElement(C.a,null,s.a.createElement(wa,{height:"40px",style:{marginRight:"5px"}}),s.a.createElement(S.a,{color:"textPrimary",variant:"h4",noWrap:!0},"Transcribe"),s.a.createElement(S.a,{color:"textPrimary",variant:"caption",noWrap:!0,className:this.props.classes.title},"[",""!==this.props.title?this.props.title:"no file loaded","]"),s.a.createElement(y.a,{onClick:function(){return e.props.openedDialog(ft.NEW)},disabled:this.props.status===ce.INITIALIZING},"New"),s.a.createElement(y.a,{onClick:function(){return e.props.openedDialog(ft.OPEN)},disabled:this.props.status===ce.INITIALIZING},"Open"),s.a.createElement(y.a,{onClick:function(){return e.props.openedDialog(ft.SAVE)},disabled:this.props.status!==ce.INITIALIZED},"Save"))),s.a.createElement(E.a,{className:this.props.classes.drawer,variant:"permanent",classes:{paper:this.props.classes.drawerPaper}},s.a.createElement("div",{className:this.props.classes.toolbar}),s.a.createElement(g.a,{style:{color:"#abb1b7"}},s.a.createElement(v.a,{button:!0,key:"Structure",onClick:function(){return e.props.switchedPage(ue.STRUCTURE)},disabled:this.props.status!==ce.INITIALIZED},s.a.createElement(O.a,{style:{color:"#abb1b7"}},s.a.createElement(T.a,null)),s.a.createElement(I.a,{primary:"Structure"})),s.a.createElement(v.a,{button:!0,key:"Harmony",onClick:function(){return e.props.switchedPage(ue.HARMONY)},disabled:this.props.status!==ce.INITIALIZED},s.a.createElement(O.a,{style:{color:"#abb1b7"}},s.a.createElement(N.a,null)),s.a.createElement(I.a,{primary:"Harmony"})),s.a.createElement(v.a,{button:!0,key:"Guitar",onClick:function(){return e.props.switchedPage(ue.GUITAR)},disabled:this.props.status!==ce.INITIALIZED},s.a.createElement(O.a,{style:{color:"#abb1b7"}},s.a.createElement(M.a,null)),s.a.createElement(I.a,{primary:"Guitar"})),s.a.createElement(v.a,{button:!0,key:"Drum",onClick:function(){return e.props.switchedPage(ue.DRUM)},disabled:this.props.status!==ce.INITIALIZED},s.a.createElement(O.a,{style:{color:"#abb1b7"}},s.a.createElement(R.a,null)),s.a.createElement(I.a,{primary:"Drum"})),s.a.createElement(v.a,{button:!0,key:"Print",onClick:function(){return e.props.switchedPage(ue.PRINT)},disabled:this.props.status!==ce.INITIALIZED},s.a.createElement(O.a,{style:{color:"#abb1b7"}},s.a.createElement(U.a,null)),s.a.createElement(I.a,{primary:"Print"})))),s.a.createElement("main",{className:this.props.classes.content},s.a.createElement("div",{className:this.props.classes.toolbar}),s.a.createElement(Fa,{show:this.props.currentPage===ue.DEFAULT},s.a.createElement(_,null)),s.a.createElement(Fa,{show:this.props.currentPage===ue.STRUCTURE},s.a.createElement(ta,null)),s.a.createElement(Fa,{show:this.props.currentPage===ue.HARMONY},s.a.createElement(H,null)),s.a.createElement(Fa,{show:this.props.currentPage===ue.GUITAR},s.a.createElement(B,null)),s.a.createElement(Fa,{show:this.props.currentPage===ue.DRUM},s.a.createElement(Z,null)),s.a.createElement(Fa,{show:this.props.currentPage===ue.PRINT},s.a.createElement(W,null)),s.a.createElement(f.a,{container:!0,direction:"column",justify:"flex-end",alignItems:"flex-end",style:{marginTop:"20px"}},s.a.createElement(f.a,{item:!0},"App version:"," ",s.a.createElement(na,{version:null!=="0.0.6"?"0.0.6":"",hash:null!=="5c3f84a"?"5c3f84a":"",description:null!=="#12 Remove/Adjust sections after rhythm changes"?"#12 Remove/Adjust sections after rhythm changes":""}))))))}}]),t}(s.a.Component)),Fa=function(e){return e.show?s.a.createElement("div",{style:{display:"inline"}},e.children):s.a.createElement("div",{style:{display:"none"}},e.children)},Ma={switchedPage:Ce,openedDialog:Ot},Aa=Object(c.b)((function(e){var t=e.project;return{currentPage:t.currentPage,status:t.status,title:t.title}}),Ma)(Object(j.a)((function(e){return Object(aa.a)({root:{display:"flex",backgroundColor:"#d5d8da"},appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#FFFFFF"},drawer:{width:190,flexShrink:0},drawerPaper:{width:190,backgroundColor:"#202a2f"},content:{flexGrow:1,padding:e.spacing(3)},toolbar:e.mixins.toolbar,title:{flexGrow:1,marginLeft:"50px"}})}),{withTheme:!0})(Ua)),za=a(45),xa=a(188),La=a.n(xa),_a=a(19),Za=a.n(_a),Ba=a(51),Ha=a.n(Ba),Wa=a(189),Va=a(113),Ga=a.n(Va),Ya=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"open",value:function(t){var a,n,r,i;return Ha.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Ha.a.awrap(Ga.a.loadAsync(t));case 2:return a=l.sent,l.next=5,Ha.a.awrap(a.file(e.songFile).async("blob"));case 5:return n=l.sent,l.next=8,Ha.a.awrap(a.file(e.stateFile).async("text"));case 8:return r=l.sent,i=JSON.parse(r),l.abrupt("return",{audioBlob:n,state:i});case 11:case"end":return l.stop()}}))}},{key:"revokeLocalFile",value:function(e){window.URL.revokeObjectURL(e)}},{key:"getLocalFileUrl",value:function(e){return window.URL.createObjectURL(e)}}]),e}();Ya.songFile="song.blob",Ya.stateFile="state.json",Ya.save=function(e,t){var a,n,r;return Ha.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new Ga.a).file(Ya.stateFile,JSON.stringify(t.state)),i.next=4,Ha.a.awrap(fetch(t.audioFileUrl));case 4:return n=i.sent,i.next=7,Ha.a.awrap(n.blob());case 7:return r=i.sent,a.file(Ya.songFile,r),i.next=11,Ha.a.awrap(a.generateAsync({type:"blob"}).then((function(t){Object(Wa.saveAs)(t,e)})));case 11:case"end":return i.stop()}}))};var Ja,qa=Ya,Ka=function(){function e(t,a,n){var r=this;Object(u.a)(this,e),this.peaks=void 0,this.player=void 0,this.pitchShift=void 0,this.shiftToSemitones=function(e){return 12*Math.log2(1/e)},this.destroy=function(){Za.a.context.dispose(),Za.a.setContext(new AudioContext)},this.play=function(){Za.a.Transport.start(Za.a.now(),r.getCurrentTime()),r.peaks.emit("player_play",r.getCurrentTime())},this.pause=function(){Za.a.Transport.pause(),r.peaks.emit("player_pause",r.getCurrentTime())},this.isPlaying=function(){return"started"===Za.a.Transport.state},this.isSeeking=function(){return!1},this.getCurrentTime=function(){return r.player.buffer.toSeconds(Za.a.Transport.position)*r.player.playbackRate},this.getDuration=function(){return r.player.buffer.duration},this.seek=function(e){var t=e*r.player.playbackRate;r.isPlaying()?(Za.a.Transport.stop(),Za.a.Transport.start(Za.a.now(),t)):(Za.a.Transport.start(Za.a.now(),t),Za.a.Transport.pause()),r.peaks.emit("player_time_update",t),r.peaks.emit("player_seek",t)},this.peaks=t,this.player=new Za.a.Player(a),this.player.sync(),this.player.start(),this.pitchShift=new Za.a.PitchShift,Za.a.connectSeries(this.player,this.pitchShift,Za.a.Master),Za.a.Transport.scheduleRepeat((function(e){r.peaks.emit("player_time_update",r.getCurrentTime()),r.getCurrentTime()>=r.getDuration()&&(Za.a.Transport.stop(),n())}),.03),this.peaks.emit("player_canplay",this)}return Object(p.a)(e,[{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e,this.pitchShift.pitch=this.shiftToSemitones(e)}},{key:"setDetune",value:function(e){this.pitchShift.pitch=this.shiftToSemitones(this.player.playbackRate)+e}}]),e}(),Qa=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).peaks=void 0,a.player=void 0,a.getPeaks=function(){return a.peaks},a.getPlayer=function(){return a.player},a.init=function(){var e,t=Za.a.context;null===(e=a.getPeaks())||void 0===e||e.destroy();var n=Object(za.a)(a);fetch(a.props.audioUrl).then((function(e){return e.arrayBuffer()})).then((function(e){return t.decodeAudioData(e)})).then((function(e){n.initPeaks(e)}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){if(de.info("componentDidUpdate with status "+e.status+" -> "+this.props.status,t.name),this.props.status!==ce.NOT_INITIALIZED&&(e.status!==this.props.status||this.props.status!==ce.INITIALIZING)){if(e.status!==this.props.status&&this.props.status===ce.INITIALIZING)return de.info("initialize audio engine",t.name),e.audioUrl!==this.props.audioUrl&&(de.info("switch from "+e.audioUrl+" to "+this.props.audioUrl,t.name),qa.revokeLocalFile(e.audioUrl)),void this.init();var a,n,r,i;if(e.status!==this.props.status&&this.props.status===ce.INITIALIZED&&(this.recomputeZoomlevels(this.props.secondsPerMeasure,this.props.audioSampleRate,this.props.measures.allIds.length),this.repaintWaveform(this.props.sections,this.props.measures,this.props.zoomLevel)),e.secondsPerMeasure===this.props.secondsPerMeasure&&e.audioSampleRate===this.props.audioSampleRate&&e.measures.allIds.length===this.props.measures.allIds.length||this.recomputeZoomlevels(this.props.secondsPerMeasure,this.props.audioSampleRate,this.props.measures.allIds.length),e.sections===this.props.sections&&e.measures===this.props.measures&&e.zoomLevel===this.props.zoomLevel||this.repaintWaveform(this.props.sections,this.props.measures,this.props.zoomLevel),e.playbackRate!==this.props.playbackRate)null===(a=this.getPlayer())||void 0===a||a.setPlaybackRate(this.props.playbackRate);if(e.detune!==this.props.detune)null===(n=this.getPlayer())||void 0===n||n.setDetune(this.props.detune);if(e.isPlaying!==this.props.isPlaying)if(this.props.isPlaying)null===(r=this.getPlayer())||void 0===r||r.play();else null===(i=this.getPlayer())||void 0===i||i.pause()}}},{key:"recomputeZoomlevels",value:function(e,t,a){var n,r=bt.computeZoomLevels(e,t,document.getElementById("zoomview-container").clientWidth,a);(null===(n=this.getPeaks())||void 0===n?void 0:n.zoom).setZoomLevels(r)}},{key:"repaintWaveform",value:function(e,t,a){var n,r,i,l,s;null===(n=this.getPeaks())||void 0===n||n.segments.removeAll(),null===(r=this.getPeaks())||void 0===r||r.segments.add(bt.sectionsToSegment(e,t)),null===(i=this.getPeaks())||void 0===i||i.points.removeAll(),null===(l=this.getPeaks())||void 0===l||l.points.add(bt.measuresToPoints(t)),null===(s=this.getPeaks())||void 0===s||s.zoom.setZoom(a)}},{key:"initPeaks",value:function(e){var a=this;de.info("init peaks",t.name),La.a.init(bt.create(e),(function(t,i){if(t)throw t;if(void 0===i)throw new Error("Peaks instance is not correctly initialized.");n(i,e),r(i,e),i.on("player_seek",(function(e){a.props.syncFirstMeasureStart&&a.props.updatedRhythm({firstMeasureStart:e})})),a.peaks=i,a.props.initializedProject({audioDuration:e.duration,audioSampleRate:e.sampleRate})}));var n=function(e,t){a.player=new Ka(e,t,(function(){return a.props.triggeredPause()}))},r=function(e,t){e.player.destroy(),e.player=a.player}}},{key:"render",value:function(){return s.a.createElement("audio",{id:"audio_dom_element",controls:!0,hidden:!0},this.props.audioUrl?s.a.createElement("source",{src:this.props.audioUrl,type:"audio/mpeg"}):null,"Your browser does not support the audio element.")}}]),t}(s.a.Component),Xa={initializedProject:ke,updatedRhythm:pt,triggeredPause:be},$a=Object(c.b)((function(e){var t,a,n=e.project,r=e.analysis,i=e.audio,l=e.wave;return{audioUrl:n.audioUrl,sections:r.sections,measures:r.measures,zoomLevel:l.zoom,status:n.status,syncFirstMeasureStart:n.syncFirstMeasureStart,isPlaying:i.isPlaying,detune:i.detune,playbackRate:i.playbackRate,secondsPerMeasure:(null===(t=r.measures.byId[1])||void 0===t?void 0:t.time)-(null===(a=r.measures.byId[0])||void 0===a?void 0:a.time),audioSampleRate:r.audioSampleRate}}),Xa)(Qa),en=a(48),tn=a(303),an=a(367),nn=a(32),rn=Object(me.b)("restoredPersistedState"),ln=function(e,t){return e=sn(e,t),rn.match(t),e},sn=Object(nn.combineReducers)({analysis:mt,audio:ge,dialog:jt,project:Te,wave:Fe}),on=Object(me.a)({reducer:ln,preloadedState:void 0}),cn=a(197),un=a(190),pn=a.n(un);!function(e){e.AUDIO="audio/*",e.ZIP=".zip"}(Ja||(Ja={}));var dn=function(e){switch(e){case Ja.AUDIO:return"Audio File";case Ja.ZIP:return"Project Zip File"}},mn=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={display:""},a.fileInput=void 0,a.handleChange=function(e){if(null!==e){var t=e[0],n=qa.getLocalFileUrl(t);a.setState({display:t.name}),a.props.callback(t,n)}},a.fileInput=s.a.createRef(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ae.a,{component:"form",className:this.props.classes.root},s.a.createElement(cn.a,{className:this.props.classes.input,placeholder:"Choose "+dn(this.props.fileType)+" ...",inputProps:{"aria-label":"Choose "+dn(this.props.fileType)},value:this.state.display,readOnly:!0,onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()}}),s.a.createElement(Y.a,{"aria-label":"menu",onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()},className:this.props.classes.iconButton},s.a.createElement(pn.a,null)," ")),s.a.createElement("input",{hidden:!0,id:this.props.id,type:"file",accept:this.props.fileType,ref:this.fileInput,onChange:function(t){return e.handleChange(t.target.files)}}))}}]),t}(s.a.Component),hn=Object(j.a)((function(e){return Object(aa.a)({root:{padding:"4px 0px",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10}})}),{withTheme:!0})(mn),fn=a(363),bn=a(364),yn=a(365),En=a(361),gn=a(362),vn=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e;return s.a.createElement(En.a,{onClose:this.props.onCancel,open:!0,fullWidth:!0,maxWidth:"sm"},s.a.createElement(gn.a,null,this.props.title),s.a.createElement(fn.a,null,s.a.createElement(bn.a,null,this.props.subTitle),this.props.children),s.a.createElement(yn.a,null,null===(e=this.props.actions)||void 0===e?void 0:e.map((function(e,t){var a;return s.a.createElement(y.a,{key:e.label,onClick:e.onClick,color:"primary",disabled:null!==(a=e.disabled)&&void 0!==a&&a},e.label)}))))}}]),t}(l.Component),On=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;switch(this.props.type){case ft.NONE:return null;case ft.NEW:return s.a.createElement(In,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a){e.props.createdProject({analysis:nt,project:Object(ve.a)({},Oe,{audioUrl:a,title:t})}),e.props.switchedPage(ue.STRUCTURE),e.props.closedDialog()}});case ft.OPEN:return s.a.createElement(jn,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a){qa.open(t).then((function(t){var n=t.audioBlob,r=t.state,i=qa.getLocalFileUrl(n);qa.revokeLocalFile(a),e.props.createdProject({analysis:r.analysis,project:Object(ve.a)({},r.project,{audioUrl:i})}),e.props.switchedPage(ue.STRUCTURE),e.props.closedDialog()}))}});case ft.SAVE:return s.a.createElement(vn,{title:"Save Transcription",subTitle:"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.",onCancel:this.props.closedDialog,actions:[{label:"Cancel",onClick:function(){return e.props.closedDialog()}},{label:"Save",onClick:function(){qa.save("transcription.zip",{audioFileUrl:e.props.audioUrl,state:on.getState()}),e.props.closedDialog()}}]});case ft.ADD_SECTION:return s.a.createElement(Cn,{maxMeasure:this.props.maxMeasure,onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a,n){e.props.addedSection({measures:$e.range(a,n),type:t}),e.props.closedDialog()}});default:throw Error()}}}]),t}(l.Component),In=function(e){var t=Object(l.useState)(""),a=Object(en.a)(t,2),n=a[0],r=a[1],i=Object(l.useState)(""),o=Object(en.a)(i,2),c=o[0],u=o[1];return s.a.createElement(vn,{title:"Create new Transcription",subTitle:"Please add a project title and select an audio file from your hard disk below.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Create",onClick:function(){return e.onSubmit(c,n)},disabled:""===n||""===c}],onCancel:e.onCancel},s.a.createElement(xt.a,{fullWidth:!0},s.a.createElement(an.a,{id:"title",label:"Project title",margin:"normal",InputProps:{readOnly:!1},variant:"outlined",onChange:function(e){return u(e.target.value)}}),s.a.createElement(hn,{fileType:Ja.AUDIO,id:"audio_file",callback:function(e,t){r(t)}})))},jn=function(e){var t=Object(l.useState)(""),a=Object(en.a)(t,2),n=a[0],r=a[1],i=Object(l.useState)(),o=Object(en.a)(i,2),c=o[0],u=o[1];return s.a.createElement(vn,{title:"Open Transcription",subTitle:"Please select a project zip file from your hard disk below.",onCancel:e.onCancel,actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Open",onClick:function(){return e.onSubmit(c,n)},disabled:""===n}]},s.a.createElement(xt.a,{fullWidth:!0},s.a.createElement(hn,{fileType:Ja.ZIP,id:"zip_file",callback:function(e,t){r(t),u(e)}})))},Cn=function(e){var t=Object(l.useState)(Xe.INTRO),a=Object(en.a)(t,2),n=a[0],r=a[1],i=Object(l.useState)(0),o=Object(en.a)(i,2),c=o[0],u=o[1],p=Object(l.useState)(0),d=Object(en.a)(p,2),m=d[0],h=d[1];return s.a.createElement(vn,{title:"Add new Section",subTitle:"Please define section and add it to the song structure.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Add",onClick:function(){return e.onSubmit(n,c,m)},disabled:n===Xe.UNDEFINED||c>m}],onCancel:e.onCancel},s.a.createElement(xt.a,{fullWidth:!0,style:{marginBottom:"20px"}},s.a.createElement(tn.a,{component:"legend"},"Section Type"),s.a.createElement(yt,{value:n,onChange:function(e){return r(e)}})),s.a.createElement(xt.a,{fullWidth:!0,style:{marginBottom:"20px"}},s.a.createElement(tn.a,{component:"legend"},"First Measure"),s.a.createElement(qe,{value:c,min:0,max:e.maxMeasure,onChange:function(e){return u(e)}})),s.a.createElement(xt.a,{fullWidth:!0,style:{marginBottom:"20px"}},s.a.createElement(tn.a,{component:"legend"},"Last Measure"),s.a.createElement(qe,{value:m,min:0,max:e.maxMeasure,onChange:function(e){return h(e)}})))},Sn={closedDialog:It,switchedPage:Ce,createdProject:Se,addedSection:ct},kn=Object(c.b)((function(e){var t=e.dialog,a=e.project,n=e.analysis;return{type:t.currentDialog,audioUrl:a.audioUrl,maxMeasure:n.measures.allIds.length-1}}),Sn)(On),Rn=a(191),Pn=a.n(Rn),Tn=a(192),Dn=Object(Tn.a)({palette:{type:"light",primary:Pn.a}});Object(o.render)(s.a.createElement(c.a,{store:on},s.a.createElement(i.a,{theme:Dn},s.a.createElement(r.a,null),s.a.createElement($a,null),s.a.createElement(kn,null),s.a.createElement(Aa,null))),document.getElementById("root"))}},[[208,1,2]]]);
//# sourceMappingURL=main.751d9b71.chunk.js.map