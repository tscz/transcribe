(this.webpackJsonptranscribe=this.webpackJsonptranscribe||[]).push([[0],{870:function(e,t,a){e.exports=a(931)},931:function(e,t,a){"use strict";a.r(t);a(871);var n=a(1001),r=a(978),i=a(0),o=a.n(i),l=a(26),s=a(43),c=a(1),u=a(2),p=a(674),d=a.n(p),m=a(844),h=function e(){Object(c.a)(this,e)};h.range=function(e,t){return e>t&&(e=t),Array(t-e+1).fill(e).map((function(t,a){return(e+a).toString()}))},h.bordersOf=function(e){return{start:parseInt(e[0]),end:parseInt(h.last(e))}},h.last=function(e){return e[e.length-1]};var f,E,b=h;function y(e){switch(e){case f.FOUR_FOUR.toString():return f.FOUR_FOUR;case f.THREE_FOUR.toString():return f.THREE_FOUR;default:throw Error("Unknown time signature type: "+e)}}function g(e,t,a,n){for(var r,i=t;i<a;i++)delete e.byId[e.allIds[i]];var o=[];n.forEach((function(t){var a=v(t);o.push(a),e.byId[a]=t})),(r=e.allIds).splice.apply(r,[t,a].concat(o))}function v(e){return e.type+"_"+e.measures[0]+"_"+e.measures[e.measures.length-1]}function O(e,t){return t.allIds.length-1>e?t.byId[e+1].time:2*t.byId[e].time-t.byId[e-1].time}function I(e,t,a,n){for(var r=60*function(e){switch(e){case f.FOUR_FOUR:return{beatUnit:4,beatsPerMeasure:4};case f.THREE_FOUR:return{beatUnit:4,beatsPerMeasure:3}}}(e).beatsPerMeasure/t,i={allIds:[],byId:{}},o=0,l=a;l<n;l+=r)i.allIds.push(""+o),i.byId[o]={time:l,color:"",editable:!1,id:""+o,labelText:""+o},o++;return i}!function(e){e.FOUR_FOUR="FOUR_FOUR",e.THREE_FOUR="THREE_FOUR"}(f||(f={})),function(e){e.INTRO="INTRO",e.VERSE="VERSE",e.PRECHORUS="PRECHORUS",e.CHORUS="CHORUS",e.BRIDGE="BRIDGE",e.SOLO="SOLO",e.OUTRO="OUTRO",e.UNDEFINED="UNDEFINED"}(E||(E={}));var j=Object(m.a)({palette:{type:"light",primary:d.a,background:{default:"#d5d8da"}},logo:{height:"40px",marginRight:"5px"},popover:{width:"200px",minHeight:"50px",margin:"10px",marginTop:"20px"},measureSelect:{minWidth:"40px"},formControl:{marginBottom:"20px"},sectionTypes:{INTRO:"#FFCA28",VERSE:"#FFA726",PRECHORUS:"#FF7043",CHORUS:"#9CCC65",SOLO:"#26C6DA",OUTRO:"#5C6BC0",BRIDGE:"#EC407A",UNDEFINED:"#f2f2f2"},sectionSelect:{minWidth:"140px"},view:{background:"#ffffff",headerBackground:"#f1f4f6",headerPadding:"4px"},waveform:{pointMarkerColor:"#006eb0"},overrides:{MuiListItemIcon:{root:{color:"#abb1b7"}}}});function S(e){var t=C.get(e);if(!t)throw Error("Unknown SectionType "+e);return t}var C=new Map([[E.INTRO,j.sectionTypes.INTRO],[E.VERSE,j.sectionTypes.VERSE],[E.PRECHORUS,j.sectionTypes.PRECHORUS],[E.CHORUS,j.sectionTypes.CHORUS],[E.SOLO,j.sectionTypes.SOLO],[E.OUTRO,j.sectionTypes.OUTRO],[E.BRIDGE,j.sectionTypes.BRIDGE],[E.UNDEFINED,j.sectionTypes.UNDEFINED]]),k=j,T=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"create",value:function(e,t){var a=document.getElementById("audio_dom_element");return{containers:{zoomview:document.getElementById("zoomview-container"),overview:document.getElementById("overview-container")},mediaElement:a,webAudio:{audioBuffer:e,scale:128,multiChannel:!1},keyboard:!0,pointMarkerColor:k.waveform.pointMarkerColor,showPlayheadTime:!0,zoomLevels:[42],player:t}}},{key:"sectionsToSegment",value:function(e,t,a){var n=[];return e.allIds.forEach((function(r){var i=e.byId[r],o=t.byId[i.measures[0]].time,l=t.byId[i.measures[i.measures.length-1]].time+a,s={id:r,labelText:i.type,startTime:o,endTime:l,color:S(i.type),editable:!1};n.push(s)})),n}},{key:"measuresToPoints",value:function(e){var t=[];return e.allIds.forEach((function(a){var n=e.byId[a];t.push(n)})),t}}]),e}(),R=a(11),N=a(4),w=a(3),D=a(974),P=a(969),U=a(992),F=a(940),A=a(1004),L=a(938),x=a(939),M=a(994),H=a(995),z=a(12),_=a(993),B=a(63),W=a(841),G=a.n(W),Z=a(838),V=a.n(Z),Y=a(839),J=a.n(Y),K=a(842),q=a.n(K),Q=a(840),X=a.n(Q),$=a(675),ee=a.n($),te=function e(t,a){Object(c.a)(this,e),this.name=t,this.color=a};te.TRACE=new te("trace","lightblue"),te.INFO=new te("info","blue"),te.WARN=new te("warn","yellow"),te.ERROR=new te("error","red");var ae,ne,re=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"generateMessage",value:function(e,t,a){var n="transcribe:".concat(e.name),r=ee()(n);r.color=e.color,a?r(a,t):r(t)}},{key:"trace",value:function(e,t){this.generateMessage(te.TRACE,e,t)}},{key:"info",value:function(e,t){this.generateMessage(te.INFO,e,t)}},{key:"warn",value:function(e,t){this.generateMessage(te.WARN,e,t)}},{key:"error",value:function(e,t){this.generateMessage(te.ERROR,e,t)}}]),e}(),ie=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:this.props.show?this.props.classes.inline:this.props.classes.invisible},this.props.children)}}]),a}(i.Component),oe=Object(z.a)((function(){return Object(P.a)({inline:{display:"inline"},invisible:{display:"none"}})}),{withTheme:!0})(ie),le=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.props.version," (",o.a.createElement("a",{href:"https://github.com/tscz/transcribe/commit/"+this.props.hash},this.props.hash," - ",this.props.description),")")}}]),a}(o.a.Component),se=a(972),ce=a(971),ue=a(973),pe=Object(z.a)((function(e){return Object(P.a)({root:{height:"100%",backgroundColor:e.view.background},header:{backgroundColor:e.view.headerBackground,padding:e.view.headerPadding}})}))((function(e){return o.a.createElement(ce.a,{className:e.classes.root,raised:!1},o.a.createElement(se.a,{titleTypographyProps:{variant:"subtitle1"},title:e.title,className:e.classes.header,action:e.action}),o.a.createElement(ue.a,null,e.body))})),de=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(pe,{title:"Info",body:o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,"No Transcription started!!"),o.a.createElement("p",null,"Please create a new Transcription or open an existing one."))})}}]),a}(i.Component),me=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(pe,{title:"Drums View",body:o.a.createElement("p",null,"In this section you'll be able to transcribe the drum part. Please come back later.")})}}]),a}(o.a.Component),he=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(pe,{title:"Guitar",body:o.a.createElement("p",null,"In this section you'll be able to transcribe the guitar part. Please come back later.")})}}]),a}(o.a.Component),fe=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(pe,{title:"Harmony",body:o.a.createElement("p",null,"In this section you'll be able to transcribe the harmony. Please come back later.")})}}]),a}(o.a.Component),Ee=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(pe,{title:"Print",body:o.a.createElement("p",null,"In this section you'll be able to print the leadsheet. Please come back later.")})}}]),a}(o.a.Component),be=a(190),ye=a(987),ge=a(1003),ve=a(975),Oe=a(976),Ie=a(163),je=a(990),Se=a(835),Ce=a.n(Se),ke=a(834),Te=a.n(ke),Re=a(831),Ne=a.n(Re),we=a(833),De=a.n(we),Pe=a(829),Ue=a.n(Pe),Fe=a(830),Ae=a.n(Fe),Le=a(832),xe=a.n(Le),Me=a(837),He=a.n(Me),ze=a(991),_e=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(D.a,{container:!0,spacing:2,alignItems:"stretch"},o.a.createElement(D.a,{item:!0,xs:10},o.a.createElement(D.a,{container:!0,spacing:2,alignItems:"stretch"},o.a.createElement(D.a,{item:!0,xs:12},this.props.topLeft),o.a.createElement(D.a,{item:!0,xs:12},o.a.createElement(D.a,{container:!0,spacing:2,alignItems:"stretch"},o.a.createElement(D.a,{item:!0,xs:10},this.props.bottomLeft),o.a.createElement(D.a,{item:!0,xs:2},this.props.bottomRight))))),o.a.createElement(D.a,{item:!0,xs:2},this.props.topRight))}}]),a}(i.Component),Be=a(1005),We=a(1006),Ge=Object(z.a)((function(){return Object(P.a)({root:{width:"100%"}})}))((function(e){return o.a.createElement(ve.a,{className:e.classes.root},o.a.createElement(Oe.a,{shrink:!0},e.title),o.a.createElement(Be.a,{mt:2},o.a.createElement(We.a,{value:e.value,valueLabelDisplay:"auto",min:e.min,max:e.max,onChange:e.onChange,step:e.step})))})),Ze=a(48);!function(e){e.NOT_INITIALIZED="not_initialized",e.INITIALIZING="initializing",e.INITIALIZED="initialized"}(ae||(ae={})),function(e){e.DEFAULT="default",e.STRUCTURE="structure",e.HARMONY="harmony",e.GUITAR="guitar",e.DRUM="drum",e.PRINT="print"}(ne||(ne={}));var Ve,Ye={status:ae.NOT_INITIALIZED,currentPage:ne.DEFAULT,title:"",audioUrl:"",syncFirstMeasureStart:!1},Je=Object(Ze.c)({name:"project",initialState:Ye,reducers:{switchedPage:function(e,t){e.currentPage=t.payload},createdProject:function(e,t){return Object(R.a)({},t.payload.project,{status:ae.INITIALIZING})},hotReloaded:function(e){e.status=ae.INITIALIZING},initializedProject:function(e){e.status=ae.INITIALIZED},enabledSyncFirstMeasureStart:function(e,t){e.syncFirstMeasureStart=t.payload}}}),Ke=Je.actions,qe=Ke.switchedPage,Qe=Ke.createdProject,Xe=Ke.initializedProject,$e=Ke.hotReloaded,et=Ke.enabledSyncFirstMeasureStart,tt=Je.reducer,at={sections:{allIds:[],byId:{}},bpm:120,firstMeasureStart:0,duration:180,measures:{allIds:[],byId:{}},timeSignature:f.FOUR_FOUR},nt=Object(Ze.c)({name:"analysis",initialState:at,extraReducers:function(e){return e.addCase(Qe,(function(e,t){return t.payload.analysis}))},reducers:{addedSection:function(e,t){return it(e,t.payload)},updatedSection:function(e,t){return ot(e,t.payload.before),it(e,t.payload.after)},removedSection:function(e,t){return ot(e,t.payload),e},updatedRhythm:function(e,t){var a,n,r,i;if(e.duration=null!==(a=t.payload.duration)&&void 0!==a?a:e.duration,e.bpm=null!==(n=t.payload.bpm)&&void 0!==n?n:e.bpm,e.firstMeasureStart=null!==(r=t.payload.firstMeasureStart)&&void 0!==r?r:e.firstMeasureStart,e.timeSignature=null!==(i=t.payload.timeSignatureType)&&void 0!==i?i:e.timeSignature,e.measures=I(e.timeSignature,e.bpm,e.firstMeasureStart,e.duration),0===e.sections.allIds.length)return e.sections=function(e){var t="UNDEFINED_0_"+e,a={allIds:[t],byId:{}};return a.byId[t]={measures:b.range(0,e),type:E.UNDEFINED},a}(e.measures.allIds.length-1),e;var o=e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]];if(void 0===o)return e;if(parseInt(b.last(e.measures.allIds))>parseInt(o.measures[o.measures.length-1])){var l={type:o.type,measures:b.range(parseInt(o.measures[0]),parseInt(b.last(e.measures.allIds)))},s=v(l);delete e.sections.byId[e.sections.allIds[e.sections.allIds.length-1]],e.sections.allIds[e.sections.allIds.length-1]=s,e.sections.byId[s]=l}return rt(e),e}}}),rt=function(e){for(var t=e.measures.allIds.length-1,a=-1,n=-1,r=0;r<=e.sections.allIds.length-1;r++){var i=e.sections.byId[e.sections.allIds[r]];if(parseInt(b.last(i.measures))>t){a=r,n=parseInt(i.measures[0]);break}}-1!==a&&g(e.sections,a,e.sections.allIds.length-a,[{measures:b.range(n,t),type:E.UNDEFINED}])},it=function(e,t){if(a=t,parseInt(a.measures[0])>parseInt(a.measures[a.measures.length-1]))return e;var a,n=function(e,t){for(var a=b.bordersOf(e.measures),n=a.start,r=a.end,i=t.allIds.length,o=0;o<=i-1;o++){var l=t.byId[t.allIds[o]],s=b.bordersOf(l.measures).end;if(!(n>=s)){if(r>s)return;return{position:o,section:l}}}}(t,e.sections);if(void 0===n||n.section.type!==E.UNDEFINED)return e;var r=function(e,t){var a=[],n=b.bordersOf(t.measures),r=n.start,i=n.end,o=b.bordersOf(e.measures),l=o.start,s=o.end;if(r>l){var c={measures:b.range(l,r-1),type:E.UNDEFINED};a.push(c)}if(a.push(t),i<s){var u={measures:b.range(i+1,s),type:E.UNDEFINED};a.push(u)}return a}(n.section,t);return g(e.sections,n.position,1,r),e},ot=function(e,t){var a=e.sections.allIds.indexOf(t),n=e.sections.byId[t],r=e.sections.allIds[a-1],i=e.sections.allIds[a+1],o=b.bordersOf(n.measures),l=o.start,s=o.end,c=a,u=1;void 0!==r&&e.sections.byId[r].type===E.UNDEFINED&&(c--,u++,l=parseInt(e.sections.byId[r].measures[0])),void 0!==i&&e.sections.byId[i].type===E.UNDEFINED&&(u++,s=parseInt(b.last(e.sections.byId[i].measures))),g(e.sections,c,u,[{measures:b.range(l,s),type:E.UNDEFINED}])},lt=nt.actions,st=lt.addedSection,ct=lt.removedSection,ut=lt.updatedRhythm,pt=lt.updatedSection,dt=nt.reducer,mt=Object(Ze.c)({name:"audio",initialState:{isPlaying:!1,detune:0,playbackRate:1,isLooping:!1,loopStart:0,loopEnd:0},reducers:{triggeredPlay:function(e){e.isPlaying=!0},triggeredPause:function(e){e.isPlaying=!1},updatedPlaybackSettings:function(e,t){void 0!==t.payload.detune&&(e.detune=t.payload.detune),void 0!==t.payload.playbackRate&&(e.playbackRate=t.payload.playbackRate)},toggledLoop:function(e){e.isLooping=!e.isLooping},updatedLoopSettings:function(e,t){void 0!==t.payload.start&&(e.loopStart=t.payload.start),void 0!==t.payload.end&&(e.loopEnd=t.payload.end)}}}),ht=mt.actions,ft=ht.triggeredPause,Et=ht.triggeredPlay,bt=ht.updatedPlaybackSettings,yt=ht.toggledLoop,gt=ht.updatedLoopSettings,vt=mt.reducer;!function(e){e.NONE="none",e.NEW="new",e.OPEN="open",e.SAVE="save",e.ADD_SECTION="add_section"}(Ve||(Ve={}));var Ot,It={currentDialog:Ve.NONE},jt=Object(Ze.c)({name:"dialogs",initialState:It,reducers:{openedDialog:function(e,t){e.currentDialog=t.payload},closedDialog:function(e){e.currentDialog=Ve.NONE}}}),St=jt.actions,Ct=St.openedDialog,kt=St.closedDialog,Tt=jt.reducer,Rt=a(676),Nt=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ge,{title:"Bpm",value:this.props.bpm,min:40,max:220,step:1,onChange:function(t,a){Array.isArray(a)||e.props.updatedRhythm({bpm:a})}}),o.a.createElement(ve.a,{fullWidth:!0},o.a.createElement(Oe.a,null,"Time Signature"),o.a.createElement(Rt.a,{value:this.props.timeSignature,onChange:function(t){return e.props.updatedRhythm({timeSignatureType:y(t.target.value)})}},o.a.createElement("option",{value:f.FOUR_FOUR},"4/4"),o.a.createElement("option",{value:f.THREE_FOUR},"3/4"))))}}]),a}(i.Component),wt={updatedRhythm:ut},Dt=Object(s.b)((function(e){var t=e.analysis;return{bpm:t.bpm,timeSignature:t.timeSignature}}),wt)(Nt),Pt=a(981),Ut=a(982),Ft=a(983),At=a(984),Lt=a(985),xt=a(986),Mt=a(677),Ht=a.n(Mt),zt=a(980),_t=a(138),Bt=a.n(_t),Wt=Object(z.a)((function(e){return Object(P.a)({root:{minWidth:e.measureSelect.minWidth}})}))((function(e){return o.a.createElement(Bt.a,{value:e.value,onChange:function(t){var a=t.target.value;e.onChange(a)},className:e.classes.root,disabled:e.disabled},new Array(e.max-e.min+1).fill(0).map((function(t,a){return o.a.createElement(zt.a,{key:e.min+a,value:e.min+a},e.min+a)})))})),Gt=a(9),Zt=Object(z.a)((function(e){return Object(P.a)({root:{minWidth:e.sectionSelect.minWidth},colored:{backgroundColor:function(e){return S(e.value)}}})}))((function(e){return o.a.createElement(Bt.a,{value:e.value,onChange:function(t){var a=t.target.value;e.onChange(a)},className:Object(Gt.default)(e.classes.root)},Object.values(E).map((function(e){return e===E.UNDEFINED?void 0:o.a.createElement(zt.a,{key:e,value:e},e)})))})),Vt=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleAddSection=function(t){e.props.addedSection(t)},e.handleUpdatedSection=function(t,n,r){re.info("Change section "+t+" from "+JSON.stringify(n)+" to "+JSON.stringify(r),a.name),parseInt(r.measures[0])>parseInt(r.measures[r.measures.length-1])||e.props.updatedSection({before:t,after:r})},e.handleRemoveSection=function(t){e.props.removedSection(t)},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(Pt.a,null,o.a.createElement(Ut.a,{size:"small"},o.a.createElement(Ft.a,null,o.a.createElement(At.a,null,o.a.createElement(Lt.a,{className:this.props.classes.column1}),o.a.createElement(Lt.a,{className:this.props.classes.column2},"Section"),o.a.createElement(Lt.a,{className:this.props.classes.column3},"First Measure"),o.a.createElement(Lt.a,{className:this.props.classes.column4},"Last Measure"))),o.a.createElement(xt.a,null,this.props.sections.allIds.map((function(t){var a=e.props.sections.byId[t];return o.a.createElement(At.a,{key:t},o.a.createElement(Lt.a,{component:"th",scope:"row"},a.type!==E.UNDEFINED&&o.a.createElement(ye.a,{onClick:function(){return e.handleRemoveSection(t)},size:"small"},o.a.createElement(Ht.a,null))),o.a.createElement(Lt.a,null,a.type===E.UNDEFINED?"UNDEFINED":o.a.createElement(Zt,{value:a.type,onChange:function(n){return e.handleUpdatedSection(t,a,Object(R.a)({},a,{type:n}))}})),o.a.createElement(Lt.a,null,o.a.createElement(Wt,{disabled:a.type===E.UNDEFINED,value:parseInt(a.measures[0]),min:0,max:e.props.measuresCount-1,onChange:function(n){return e.handleUpdatedSection(t,a,Object(R.a)({},a,{measures:b.range(n,parseInt(a.measures[a.measures.length-1]))}))}})),o.a.createElement(Lt.a,null,o.a.createElement(Wt,{disabled:a.type===E.UNDEFINED,value:parseInt(a.measures[a.measures.length-1]),min:0,max:e.props.measuresCount-1,onChange:function(n){return e.handleUpdatedSection(t,a,Object(R.a)({},a,{measures:b.range(parseInt(a.measures[0]),n)}))}})))})))))}}]),a}(i.Component),Yt={addedSection:st,updatedSection:pt,removedSection:ct},Jt=Object(s.b)((function(e){var t=e.analysis;return{sections:t.sections,measuresCount:t.measures.allIds.length}}),Yt)(Object(z.a)((function(){return Object(P.a)({column1:{width:"10%"},column2:{width:"30%"},column3:{width:"30%"},column4:{width:"30%"}})}),{withTheme:!0})(Vt)),Kt=a(68),qt=a(988);!function(e){e[e.OUTSIDE=0]="OUTSIDE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INSIDE=3]="INSIDE",e[e.LEFT_AND_RIGHT=4]="LEFT_AND_RIGHT"}(Ot||(Ot={}));var Qt=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={start:0,end:0},e}return Object(u.a)(a,[{key:"getArea",value:function(e){return this.state.start>e||this.state.end<e?Ot.OUTSIDE:e===this.state.start&&e===this.state.end?Ot.LEFT_AND_RIGHT:e===this.state.start?Ot.LEFT:e===this.state.end?Ot.RIGHT:Ot.INSIDE}},{key:"render",value:function(){var e=this,t=this.props,a=t.sections,n=t.measures;return o.a.createElement(o.a.Fragment,null,o.a.createElement(D.a,{container:!0,direction:"column"},a.allIds.map((function(t){return o.a.createElement(D.a,{item:!0,key:t},o.a.createElement(D.a,{container:!0,direction:"column"},o.a.createElement(D.a,{item:!0,key:t+"_caption"},o.a.createElement(B.a,{variant:"caption"},a.byId[t].type.toLowerCase())),o.a.createElement(D.a,{item:!0,key:t+"_body"},o.a.createElement(D.a,{container:!0,direction:"column",className:e.props.classes.mainGrid},function(e,t){for(var a=[],n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a}(a.byId[t].measures,8).map((function(r){return o.a.createElement(qt.a,{key:t+"_buttonGroup_"+r[0],orientation:"horizontal",size:"small",className:e.props.classes.section},r.map((function(r){var i=n.byId[r],l=Number(r);return i?o.a.createElement($t,{key:i.id,value:i.id,sectiontype:a.byId[t].type,onClick:function(){l<=e.state.end?(e.setState((function(){return{start:l,end:l}})),e.props.updatedLoopSettings({start:n.byId[l].time,end:O(l,n)})):(e.setState((function(){return{end:l}})),e.props.updatedLoopSettings({end:O(l,n)}))},position:e.getArea(l)}):o.a.createElement("div",null,"?")})))}))))))}))))}}]),a}(o.a.Component),Xt=function(e){switch(e.position){case Ot.OUTSIDE:return Object(Gt.default)(e.classes.root);case Ot.INSIDE:return Object(Gt.default)(e.classes.root,e.classes.selected);case Ot.LEFT:return Object(Gt.default)(e.classes.root,e.classes.selected,e.classes.selectedLeft);case Ot.RIGHT:return Object(Gt.default)(e.classes.root,e.classes.selected,e.classes.selectedRight);case Ot.LEFT_AND_RIGHT:return Object(Gt.default)(e.classes.root,e.classes.selected,e.classes.selectedLeft,e.classes.selectedRight)}},$t=Object(z.a)((function(){return Object(P.a)({root:{backgroundColor:function(e){return S(e.sectiontype)},minWidth:"12%",minHeight:"15px",padding:"0px",marginLeft:"2px",marginBottom:"2px",opacity:"0.7"},selected:{opacity:"1",borderTopColor:"#000000",borderBottomColor:"#000000"},selectedLeft:{borderLeftWidth:"4px",borderLeftColor:"#000000"},selectedRight:{borderRightWidth:"4px",borderRightColor:"#000000"}})}))((function(e){e.classes;var t=Object(Kt.a)(e,["classes"]);return o.a.createElement(F.a,Object.assign({},t,{onClick:function(){return e.onClick()},className:Xt(e)}),e.value)})),ea={updatedLoopSettings:gt},ta=Object(s.b)((function(e){var t=e.analysis;return{sections:t.sections,measures:t.measures}}),ea)(Object(z.a)((function(){return Object(P.a)({mainGrid:{marginBottom:"5px"},section:{}})}),{withTheme:!0})(Qt)),aa=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return o.a.createElement(D.a,{container:!0,direction:"column",justify:"center",alignItems:"center",alignContent:"stretch"},o.a.createElement(D.a,{style:{width:"100%"}},o.a.createElement(ta,null)))}}]),a}(i.Component),na=a(989),ra=a(8),ia=a.n(ra),oa=a(15),la=a(678),sa=a(165),ca=a.n(sa),ua=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"save",value:function(){var t=Object(oa.a)(ia.a.mark((function t(a,n){var r,i,o;return ia.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new ca.a).file(e.stateFile,JSON.stringify(n.state)),t.next=4,fetch(n.audioFileUrl);case 4:return i=t.sent,t.next=7,i.blob();case 7:return o=t.sent,r.file(e.songFile,o),t.next=11,r.generateAsync({type:"blob"}).then((function(e){Object(la.saveAs)(e,a)}));case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"open",value:function(){var t=Object(oa.a)(ia.a.mark((function t(a){var n,r,i,o,l,s;return ia.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ca.a.loadAsync(a);case 2:if(n=t.sent,null!==(r=n.file(e.songFile))){t.next=6;break}throw new Error("Project must contain an audio file "+e.songFile);case 6:if(null!==(i=n.file(e.stateFile))){t.next=9;break}throw new Error("Project must contain a project config/state file "+e.stateFile);case 9:return t.next=11,r.async("blob");case 11:return o=t.sent,t.next=14,i.async("text");case 14:return l=t.sent,s=JSON.parse(l),t.abrupt("return",{audioBlob:o,state:s});case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"revokeLocalFile",value:function(e){window.URL.revokeObjectURL(e)}},{key:"getLocalFileUrl",value:function(e){return window.URL.createObjectURL(e)}}]),e}();ua.songFile="song.blob",ua.stateFile="state.json";var pa,da=ua,ma=a(679),ha=a.n(ma),fa=a(40),Ea=function(){function e(t,a){var n=this;Object(c.a)(this,e),this.audioBuffer=t,this.onSongComplete=a,this.shouldLoop=void 0,this.player=void 0,this.pitchShift=void 0,this.detune=void 0,this.eventEmitter=void 0,this.loopStart=void 0,this.loopEnd=void 0,this.init=function(t){re.info("init",e.name),n.eventEmitter=t,fa.c.scheduleRepeat((function(){t.emit("player.timeupdate",n.getCurrentTime()),n.shouldLoop&&(n.getCurrentTime()>=n.loopEnd||n.getCurrentTime()<=n.loopStart)&&n.seek(n.loopStart),n.getCurrentTime()>=n.getDuration()&&(fa.c.stop(),n.onSongComplete())}),.25),t.emit("player.canplay")},this.shiftToSemitones=function(e){return 12*Math.log2(1/e)},this.destroy=function(){re.info("destroy",e.name),n.player.dispose(),n.pitchShift.dispose(),fa.c.cancel(),fa.c.position=0},this.play=function(){var e;fa.c.start(Object(fa.e)(),n.getCurrentTime()/n.player.playbackRate),null===(e=n.eventEmitter)||void 0===e||e.emit("player.play",n.getCurrentTime()/n.player.playbackRate)},this.playSegment=function(e){var t;fa.c.start(Object(fa.e)(),e.startTime/n.player.playbackRate),null===(t=n.eventEmitter)||void 0===t||t.emit("player.play",n.getCurrentTime()/n.player.playbackRate)},this.pause=function(){var e;fa.c.pause(),null===(e=n.eventEmitter)||void 0===e||e.emit("player.pause",n.getCurrentTime())},this.isPlaying=function(){return"started"===fa.c.state},this.isSeeking=function(){return!1},this.getCurrentTime=function(){return n.player.toSeconds(fa.c.position)*n.player.playbackRate},this.getDuration=function(){return n.player.buffer.duration},this.seek=function(e){var t,a,r=e/n.player.playbackRate;fa.c.seconds=r,null===(t=n.eventEmitter)||void 0===t||t.emit("player.seeked",n.getCurrentTime()),null===(a=n.eventEmitter)||void 0===a||a.emit("player.timeupdate",n.getCurrentTime())},this.player=new fa.b(this.audioBuffer),this.pitchShift=new fa.a,this.detune=0,this.shouldLoop=!1,this.loopStart=0,this.loopEnd=0,this.player.sync(),this.player.start(),this.player.connect(this.pitchShift),this.pitchShift.toDestination()}return Object(u.a)(e,[{key:"setPlaybackRate",value:function(e){this.player.playbackRate=e,this.setDetune(this.detune),this.isPlaying()&&this.seek(this.getCurrentTime())}},{key:"setDetune",value:function(e){this.detune=e,this.pitchShift.pitch=this.shiftToSemitones(this.player.playbackRate)+e}},{key:"toggleLoop",value:function(){this.shouldLoop=!this.shouldLoop}},{key:"setLoop",value:function(e,t){if(this.loopStart<0||this.loopStart>this.getDuration())throw new Error("Loop start invalid. Must be a millisecond between 0 and "+this.getDuration());if(this.loopEnd<this.loopStart||this.loopEnd>this.getDuration())throw new Error("Loop start invalid. Must be a millisecond between "+this.loopStart+" and "+this.getDuration());this.loopStart=e,this.loopEnd=t}}]),e}(),ba=Object(Ze.b)("switchAudioFile"),ya=Object(Ze.b)("updateWaveform"),ga=function(){function e(){var t=this;Object(c.a)(this,e),this.peaks=void 0,this.player=void 0,this.url=void 0,this.getPlayer=function(){if(!t.player)throw new Error("player undefined");return t.player},this.createMiddleware=function(a){return function(n){return function(r){if(re.info("action "+r.type,e.name),Qe.match(r))return t.initAudioContext(r.payload.project.audioUrl,a),n(r);if($e.match(r))return n(r);if(Et.match(r))return t.getPlayer().play(),n(r);if(ft.match(r))return t.getPlayer().pause(),n(r);if(ya.match(r))return t.repaintWaveform(r.payload.sections,r.payload.measures),n(r);if(bt.match(r))return r.payload.playbackRate&&t.getPlayer().setPlaybackRate(r.payload.playbackRate),r.payload.detune&&t.getPlayer().setDetune(r.payload.detune),n(r);if(yt.match(r))return t.getPlayer().toggleLoop(),n(r);if(gt.match(r)){var i,o,l=null!==(i=r.payload.start)&&void 0!==i?i:a.getState().audio.loopStart,s=null!==(o=r.payload.end)&&void 0!==o?o:a.getState().audio.loopEnd;return t.getPlayer().seek(l),t.getPlayer().setLoop(l,s),t.setZoom(l,s),n(r)}return n(r)}}},this.computeSecondsPerMeasure=function(e){return e&&e.byId[1]&&e.byId[0]?e.byId[1].time-e.byId[0].time:0}}return Object(u.a)(e,[{key:"cleanupPreviousInit",value:function(){var e,t;null===(e=this.peaks)||void 0===e||e.destroy(),null===(t=this.player)||void 0===t||t.destroy(),this.url&&da.revokeLocalFile(this.url)}},{key:"initAudioContext",value:function(t,a){var n=this;this.cleanupPreviousInit(),this.url=t,re.info("start fetch audio file into audiobuffer from "+this.url,e.name),fetch(this.url).then((function(e){return e.arrayBuffer()})).then((function(e){return fa.d.decodeAudioData(e)})).then((function(t){re.info("audiobuffer loaded from "+n.url,e.name),r(t)}));var r=function(t){re.info("init peaks start",e.name),n.player=new Ea(t,(function(){})),ha.a.init(T.create(t,n.player),(function(r,i){if(console.log("body="+document.body.innerHTML),r)throw new Error("Peaks could not be initialized: "+r);if(!i)throw new Error("Peaks instance is not correctly initialized.");re.info("init peaks end",e.name),i.on("player.seeked",(function(e){a.getState().project.syncFirstMeasureStart&&a.dispatch(ut({firstMeasureStart:e}))})),n.peaks=i,a.dispatch(Xe()),a.dispatch(ut({duration:t.duration}))}))}}},{key:"repaintWaveform",value:function(e,t){var a,n,r,i,o=this.computeSecondsPerMeasure(t);null===(a=this.peaks)||void 0===a||a.segments.removeAll(),null===(n=this.peaks)||void 0===n||n.segments.add(T.sectionsToSegment(e,t,o)),null===(r=this.peaks)||void 0===r||r.points.removeAll(),null===(i=this.peaks)||void 0===i||i.points.add(T.measuresToPoints(t))}},{key:"setZoom",value:function(e,t){var a,n=null===(a=this.peaks)||void 0===a?void 0:a.views.getView("zoomview");if(n){var r=t-e;n.setZoom({seconds:r}),n.setStartTime(e)}}}]),e}(),va=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return re.info("render",a.name),o.a.createElement("div",null,o.a.createElement("div",{id:"waveform-container"},o.a.createElement("div",{id:"zoomview-container",className:this.props.classes.zoomview}),o.a.createElement("div",{id:"overview-container",className:this.props.classes.overview})))}}]),a}(i.Component),Oa=Object(z.a)((function(){return Object(P.a)({zoomview:{maxHeight:"400px"},overview:{marginTop:"30px",height:"50px"}})}),{withTheme:!0})(va),Ia=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e){e.sections===this.props.sections&&e.measures===this.props.measures||this.props.updateWaveform({sections:this.props.sections,measures:this.props.measures})}},{key:"render",value:function(){return re.info("render",a.name),o.a.createElement("div",null,this.props.status!==ae.INITIALIZED&&o.a.createElement(na.a,null),o.a.createElement(Oa,null))}}]),a}(i.Component),ja={hotReloaded:$e,updateWaveform:ya},Sa=Object(s.b)((function(e){var t=e.project,a=e.analysis;return{status:t.status,sections:a.sections,measures:a.measures,audioUrl:t.audioUrl}}),ja)(Ia);!function(e){e[e.RHYTHM=0]="RHYTHM",e[e.PLAYBACKRATE=1]="PLAYBACKRATE",e[e.DETUNE=2]="DETUNE",e[e.STARTMEASURE=3]="STARTMEASURE",e[e.NONE=4]="NONE"}(pa||(pa={}));var Ca=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null,activePopover:pa.NONE},e.handlePopoverOpen=function(t,a){t&&t.currentTarget&&e.setState({anchorEl:t.currentTarget,activePopover:a})},e.handlePopoverClose=function(){e.setState({anchorEl:null,activePopover:pa.NONE})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;re.info("render",a.name);var t=this.props.shouldLoop?"Turn Loop off":"Turn Loop on",n=this.props.shouldLoop?"secondary":"primary";return o.a.createElement(_e,{topLeft:o.a.createElement(pe,{title:"Song Overview",body:o.a.createElement(Sa,null),action:o.a.createElement(o.a.Fragment,null,this.props.isPlaying?o.a.createElement(ka,{title:"Pause",icon:o.a.createElement(Ue.a,null),onClick:function(){return e.props.triggeredPause()}}):o.a.createElement(ka,{title:"Play",icon:o.a.createElement(Ae.a,null),onClick:function(){return e.props.triggeredPlay()}}),o.a.createElement(ka,{title:t,icon:o.a.createElement(Ne.a,null),onClick:function(){return e.props.toggledLoop()},disabled:!1,color:n}),o.a.createElement(ka,{title:"Playback Rate",icon:o.a.createElement(xe.a,null),onClick:function(t){return e.handlePopoverOpen(t,pa.PLAYBACKRATE)},disabled:!1}),o.a.createElement(ka,{title:"Detune",icon:o.a.createElement(De.a,null),onClick:function(t){return e.handlePopoverOpen(t,pa.DETUNE)},disabled:!1}),o.a.createElement(be.a,{className:this.props.classes.popover,open:this.state.activePopover!==pa.NONE,anchorEl:this.state.anchorEl,onClose:function(){return e.handlePopoverClose()},anchorOrigin:{vertical:"bottom",horizontal:"left"},anchorPosition:{top:50,left:0},transformOrigin:{vertical:"top",horizontal:"center"}},this.state.activePopover!==pa.NONE&&o.a.createElement("div",{className:this.props.classes.content},Ta(this.state.activePopover,this.props))))}),topRight:o.a.createElement(pe,{title:"Song Measures",body:o.a.createElement(aa,null)}),bottomLeft:o.a.createElement(pe,{title:"Song Sections",action:o.a.createElement(o.a.Fragment,null,o.a.createElement(ka,{title:"Start Measure 0",icon:o.a.createElement(Te.a,null),onClick:function(t){return e.handlePopoverOpen(t,pa.STARTMEASURE)},disabled:!1}),o.a.createElement(ka,{title:"Add section",icon:o.a.createElement(Ce.a,null),onClick:function(){return e.props.openedDialog(Ve.ADD_SECTION)}})),body:o.a.createElement(Jt,null)}),bottomRight:o.a.createElement(pe,{title:"Song Properties",body:o.a.createElement(Dt,null)})})}}]),a}(o.a.Component),ka=Object(z.a)((function(){return Object(P.a)({root:{marginTop:"8px",marginRight:"5px"}})}))((function(e){var t=o.a.createElement(ye.a,{className:e.classes.root,onClick:e.onClick,size:"small",disabled:e.disabled,color:e.color},e.icon);return e.disabled?t:o.a.createElement(ge.a,{title:e.title},t)})),Ta=function(e,t){switch(e){case pa.DETUNE:return o.a.createElement(Ra,t);case pa.PLAYBACKRATE:return o.a.createElement(wa,t);case pa.STARTMEASURE:return o.a.createElement(Na,t);default:throw Error("Popup type undefined: "+e)}},Ra=function(e){return o.a.createElement(Ge,{title:"Detune",value:e.detune,min:-12,max:12,step:.5,onChange:function(t,a){Array.isArray(a)||a===e.detune||e.updatedPlaybackSettings({detune:a})}})},Na=Object(z.a)((function(){return Object(P.a)({toggleButton:{width:"15px",height:"25px"}})}))((function(e){return o.a.createElement(ve.a,{fullWidth:!0},o.a.createElement(Oe.a,null,"Start Measure 1"),o.a.createElement(Ie.a,{type:"text",id:"startMeasure1",value:e.firstMeasureStart,startAdornment:o.a.createElement(je.a,{position:"start"},o.a.createElement(ge.a,{title:"Toggle sync with mouse click. If enabled, clicking into the waveform will update the start of measure 0 to the selected position."},o.a.createElement(ze.a,{className:e.classes.toggleButton,value:"check",selected:e.syncFirstMeasureStart,onChange:function(){e.enabledSyncFirstMeasureStart(!e.syncFirstMeasureStart)}},o.a.createElement(He.a,null))))}))})),wa=function(e){return o.a.createElement(Ge,{title:"Playback rate",value:e.playbackRate,min:.4,max:1.2,step:.05,onChange:function(t,a){Array.isArray(a)||a===e.playbackRate||e.updatedPlaybackSettings({playbackRate:a})}})},Da={triggeredPlay:Et,triggeredPause:ft,enabledSyncFirstMeasureStart:et,updatedRhythm:ut,updatedPlaybackSettings:bt,openedDialog:Ct,toggledLoop:yt},Pa=Object(s.b)((function(e){var t=e.project,a=e.audio,n=e.analysis;return{loaded:t.status===ae.INITIALIZED,isPlaying:a.isPlaying,firstMeasureStart:n.firstMeasureStart,syncFirstMeasureStart:t.syncFirstMeasureStart,detune:a.detune,playbackRate:a.playbackRate,shouldLoop:a.isLooping}}),Da)(Object(z.a)((function(e){return Object(P.a)({content:{width:e.popover.width,minHeight:e.popover.minHeight,margin:e.popover.margin,marginTop:e.popover.marginTop},popover:{height:"400px"}})}),{withTheme:!0})(Ca));function Ua(){return(Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Fa(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Aa,La=o.a.createElement("path",{d:"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z"}),xa=o.a.createElement("path",{d:"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z"}),Ma=o.a.createElement("path",{d:"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z"}),Ha=o.a.createElement("path",{d:"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z"}),za=o.a.createElement("path",{d:"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z"}),_a=o.a.createElement("path",{d:"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z"}),Ba=o.a.createElement("path",{d:"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z"}),Wa=o.a.createElement("path",{d:"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z"}),Ga=o.a.createElement("path",{d:"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z"}),Za=o.a.createElement("path",{d:"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z"}),Va=o.a.createElement("g",null),Ya=o.a.createElement("g",null),Ja=o.a.createElement("g",null),Ka=o.a.createElement("g",null),qa=o.a.createElement("g",null),Qa=o.a.createElement("g",null),Xa=o.a.createElement("g",null),$a=o.a.createElement("g",null),en=o.a.createElement("g",null),tn=o.a.createElement("g",null),an=o.a.createElement("g",null),nn=o.a.createElement("g",null),rn=o.a.createElement("g",null),on=o.a.createElement("g",null),ln=o.a.createElement("g",null),sn=function(e){var t=e.svgRef,a=e.title,n=Fa(e,["svgRef","title"]);return o.a.createElement("svg",Ua({id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:t},n),a?o.a.createElement("title",null,a):null,o.a.createElement("path",{style:{fill:"#EADCD6"},d:"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z"}),o.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z"}),o.a.createElement("path",{style:{fill:"#EADCD6"},d:"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z "}),o.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z"}),o.a.createElement("g",null,o.a.createElement("path",{style:{fill:"#F8BF00"},d:"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z"}),o.a.createElement("circle",{style:{fill:"#F8BF00"},cx:201.212,cy:201.242,r:22.708}),o.a.createElement("circle",{style:{fill:"#F8BF00"},cx:331.22,cy:201.242,r:22.708})),o.a.createElement("g",null,o.a.createElement("path",{style:{fill:"#EFA603"},d:"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z"}),o.a.createElement("path",{style:{fill:"#EFA603"},d:"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z"}),o.a.createElement("path",{style:{fill:"#EFA603"},d:"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z"})),o.a.createElement("path",{style:{fill:"#DDCDC7"},d:"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z"}),o.a.createElement("path",{style:{fill:"#C9BCB8"},d:"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z"}),La,xa,Ma,Ha,za,_a,Ba,Wa,Ga,Za,Va,Ya,Ja,Ka,qa,Qa,Xa,$a,en,tn,an,nn,rn,on,ln)},cn=o.a.forwardRef((function(e,t){return o.a.createElement(sn,Ua({svgRef:t},e))})),un=(a.p,function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return re.info("render",a.name),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:this.props.classes.root},o.a.createElement(U.a,{color:"inherit",className:this.props.classes.appBar},o.a.createElement(_.a,null,o.a.createElement(cn,{className:this.props.classes.logo}),o.a.createElement(B.a,{color:"textPrimary",variant:"h4",noWrap:!0},"Transcribe"),o.a.createElement(B.a,{color:"textPrimary",variant:"caption",noWrap:!0,className:this.props.classes.title},"[",""!==this.props.title?this.props.title:"no file loaded","]"),o.a.createElement(F.a,{onClick:function(){return e.props.openedDialog(Ve.NEW)},disabled:this.props.status===ae.INITIALIZING},"New"),o.a.createElement(F.a,{onClick:function(){return e.props.openedDialog(Ve.OPEN)},disabled:this.props.status===ae.INITIALIZING},"Open"),o.a.createElement(F.a,{onClick:function(){return e.props.openedDialog(Ve.SAVE)},disabled:this.props.status!==ae.INITIALIZED},"Save"))),o.a.createElement(A.a,{className:this.props.classes.drawer,variant:"permanent",classes:{paper:this.props.classes.drawerPaper}},o.a.createElement("div",{className:this.props.classes.toolbar}),o.a.createElement(L.a,{className:this.props.classes.menuItem},o.a.createElement(x.a,{button:!0,key:"Structure",onClick:function(){return e.props.switchedPage(ne.STRUCTURE)},disabled:this.props.status!==ae.INITIALIZED},o.a.createElement(M.a,null,o.a.createElement(V.a,null)),o.a.createElement(H.a,{primary:"Structure"})),o.a.createElement(x.a,{button:!0,key:"Harmony",onClick:function(){return e.props.switchedPage(ne.HARMONY)},disabled:this.props.status!==ae.INITIALIZED},o.a.createElement(M.a,null,o.a.createElement(J.a,null)),o.a.createElement(H.a,{primary:"Harmony"})),o.a.createElement(x.a,{button:!0,key:"Guitar",onClick:function(){return e.props.switchedPage(ne.GUITAR)},disabled:this.props.status!==ae.INITIALIZED},o.a.createElement(M.a,null,o.a.createElement(X.a,null)),o.a.createElement(H.a,{primary:"Guitar"})),o.a.createElement(x.a,{button:!0,key:"Drum",onClick:function(){return e.props.switchedPage(ne.DRUM)},disabled:this.props.status!==ae.INITIALIZED},o.a.createElement(M.a,null,o.a.createElement(G.a,null)),o.a.createElement(H.a,{primary:"Drum"})),o.a.createElement(x.a,{button:!0,key:"Print",onClick:function(){return e.props.switchedPage(ne.PRINT)},disabled:this.props.status!==ae.INITIALIZED},o.a.createElement(M.a,null,o.a.createElement(q.a,null)),o.a.createElement(H.a,{primary:"Print"})))),o.a.createElement("main",{className:this.props.classes.content},o.a.createElement("div",{className:this.props.classes.toolbar}),o.a.createElement(oe,{show:this.props.currentPage===ne.DEFAULT},o.a.createElement(de,null)),o.a.createElement(oe,{show:this.props.currentPage===ne.STRUCTURE},o.a.createElement(Pa,null)),o.a.createElement(oe,{show:this.props.currentPage===ne.HARMONY},o.a.createElement(fe,null)),o.a.createElement(oe,{show:this.props.currentPage===ne.GUITAR},o.a.createElement(he,null)),o.a.createElement(oe,{show:this.props.currentPage===ne.DRUM},o.a.createElement(me,null)),o.a.createElement(oe,{show:this.props.currentPage===ne.PRINT},o.a.createElement(Ee,null)),o.a.createElement(D.a,{container:!0,direction:"column",justify:"flex-end",alignItems:"flex-end",className:this.props.classes.footer},o.a.createElement(D.a,{item:!0},"App version:"," ",o.a.createElement(le,{version:null!=="0.0.10"?"0.0.10":"",hash:null!=="003411e"?"003411e":"",description:null!=="0.0.10"?"0.0.10":""}))))))}}]),a}(o.a.Component)),pn={switchedPage:qe,openedDialog:Ct},dn=Object(s.b)((function(e){var t=e.project;return{currentPage:t.currentPage,status:t.status,title:t.title}}),pn)(Object(z.a)((function(e){return Object(P.a)({root:{display:"flex",backgroundColor:e.palette.background.default},drawer:{width:190,flexShrink:0},drawerPaper:{width:190,backgroundColor:"#202a2f"},content:{flexGrow:1,padding:e.spacing(3)},title:{flexGrow:1,marginLeft:"50px"},toolbar:Object(R.a)({},e.mixins.toolbar),menuItem:{color:"#abb1b7"},logo:{height:e.logo.height,marginRight:e.logo.marginRight},footer:{marginTop:"20px"},appBar:{zIndex:e.zIndex.drawer+1}})}),{withTheme:!0})(un)),mn=a(21),hn=a(936),fn=a(1002),En=a(860),bn=a(149),yn=a(843),gn=a.n(yn);!function(e){e.AUDIO="audio/*",e.ZIP=".zip"}(Aa||(Aa={}));var vn=function(e){switch(e){case Aa.AUDIO:return"Audio File";case Aa.ZIP:return"Project Zip File"}},On=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={display:""},n.fileInput=void 0,n.handleChange=function(e){if(null!==e){var t=e[0],a=da.getLocalFileUrl(t);n.setState({display:t.name}),n.props.callback(t,a)}},n.fileInput=o.a.createRef(),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(bn.a,{component:"form",className:this.props.classes.root},o.a.createElement(En.a,{className:this.props.classes.input,placeholder:"Choose "+vn(this.props.fileType)+" ...",inputProps:{"aria-label":"Choose "+vn(this.props.fileType)},value:this.state.display,readOnly:!0,onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()}}),o.a.createElement(ye.a,{"aria-label":"menu",onClick:function(){var t;return null===(t=e.fileInput.current)||void 0===t?void 0:t.click()},className:this.props.classes.iconButton},o.a.createElement(gn.a,null)," ")),o.a.createElement("input",{hidden:!0,id:this.props.id,type:"file",accept:this.props.fileType,ref:this.fileInput,onChange:function(t){return e.handleChange(t.target.files)}}))}}]),a}(o.a.Component),In=Object(z.a)((function(e){return Object(P.a)({root:{padding:"4px 0px",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10}})}),{withTheme:!0})(On),jn=a(998),Sn=a(999),Cn=a(1e3),kn=a(996),Tn=a(997),Rn=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e;return o.a.createElement(kn.a,{onClose:this.props.onCancel,open:!0,fullWidth:!0,maxWidth:"sm"},o.a.createElement(Tn.a,null,this.props.title),o.a.createElement(jn.a,null,o.a.createElement(Sn.a,null,this.props.subTitle),this.props.children),o.a.createElement(Cn.a,null,null===(e=this.props.actions)||void 0===e?void 0:e.map((function(e){var t;return o.a.createElement(F.a,{key:e.label,onClick:e.onClick,color:"primary",disabled:null!==(t=e.disabled)&&void 0!==t&&t},e.label)}))))}}]),a}(i.Component),Nn=a(50),wn=Object(Ze.b)("restoredPersistedState"),Dn=Object(Nn.c)({analysis:dt,audio:vt,dialog:Tt,project:tt}),Pn=function(e,t){return e=Dn(e,t),wn.match(t),e},Un=Object(Ze.a)({reducer:Pn,preloadedState:void 0,middleware:[(new ga).createMiddleware]}),Fn=function(e){Object(N.a)(a,e);var t=Object(w.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;switch(this.props.type){case Ve.NONE:return null;case Ve.NEW:return o.a.createElement(An,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a){e.props.createdProject({analysis:at,project:Object(R.a)({},Ye,{audioUrl:a,title:t})}),e.props.switchedPage(ne.STRUCTURE),e.props.closedDialog()}});case Ve.OPEN:return o.a.createElement(Ln,{onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a){da.open(t).then((function(t){var n=t.audioBlob,r=t.state,i=da.getLocalFileUrl(n);da.revokeLocalFile(a),e.props.createdProject({analysis:r.analysis,project:Object(R.a)({},r.project,{audioUrl:i})}),e.props.switchedPage(ne.STRUCTURE),e.props.closedDialog()}))}});case Ve.SAVE:return o.a.createElement(Rn,{title:"Save Transcription",subTitle:"Please click on 'save' to generate a transcription.zip file. It contains the transcription and the source audio file.",onCancel:function(){return e.props.closedDialog()},actions:[{label:"Cancel",onClick:function(){return e.props.closedDialog()}},{label:"Save",onClick:function(){da.save("transcription.zip",{audioFileUrl:e.props.audioUrl,state:Un.getState()}),e.props.closedDialog()}}]});case Ve.ADD_SECTION:return o.a.createElement(xn,{maxMeasure:this.props.maxMeasure,onCancel:function(){return e.props.closedDialog()},onSubmit:function(t,a,n){e.props.addedSection({measures:b.range(a,n),type:t}),e.props.closedDialog()}});default:throw Error()}}}]),a}(i.Component),An=function(e){var t=Object(i.useState)(""),a=Object(mn.a)(t,2),n=a[0],r=a[1],l=Object(i.useState)(""),s=Object(mn.a)(l,2),c=s[0],u=s[1];return o.a.createElement(Rn,{title:"Create new Transcription",subTitle:"Please add a project title and select an audio file from your hard disk below.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Create",onClick:function(){return e.onSubmit(c,n)},disabled:""===n||""===c}],onCancel:e.onCancel},o.a.createElement(ve.a,{fullWidth:!0},o.a.createElement(fn.a,{id:"title",label:"Project title",margin:"normal",InputProps:{readOnly:!1},variant:"outlined",onChange:function(e){return u(e.target.value)}}),o.a.createElement(In,{fileType:Aa.AUDIO,id:"audio_file",callback:function(e,t){r(t)}})))},Ln=function(e){var t=Object(i.useState)(""),a=Object(mn.a)(t,2),n=a[0],r=a[1],l=Object(i.useState)(),s=Object(mn.a)(l,2),c=s[0],u=s[1];return o.a.createElement(Rn,{title:"Open Transcription",subTitle:"Please select a project zip file from your hard disk below.",onCancel:e.onCancel,actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Open",onClick:function(){if(!c)throw Error("file undefined");e.onSubmit(c,n)},disabled:""===n}]},o.a.createElement(ve.a,{fullWidth:!0},o.a.createElement(In,{fileType:Aa.ZIP,id:"zip_file",callback:function(e,t){r(t),u(e)}})))},xn=Object(z.a)((function(e){return Object(P.a)({formControl:{marginBottom:e.formControl.marginBottom}})}))((function(e){var t=Object(i.useState)(E.INTRO),a=Object(mn.a)(t,2),n=a[0],r=a[1],l=Object(i.useState)(0),s=Object(mn.a)(l,2),c=s[0],u=s[1],p=Object(i.useState)(0),d=Object(mn.a)(p,2),m=d[0],h=d[1];return o.a.createElement(Rn,{title:"Add new Section",subTitle:"Please define section and add it to the song structure.",actions:[{label:"Cancel",onClick:function(){return e.onCancel()}},{label:"Add",onClick:function(){return e.onSubmit(n,c,m)},disabled:n===E.UNDEFINED||c>m}],onCancel:e.onCancel},o.a.createElement(ve.a,{fullWidth:!0,className:e.classes.formControl},o.a.createElement(hn.a,{component:"legend"},"Section Type"),o.a.createElement(Zt,{value:n,onChange:function(e){return r(e)}})),o.a.createElement(ve.a,{fullWidth:!0,className:e.classes.formControl},o.a.createElement(hn.a,{component:"legend"},"First Measure"),o.a.createElement(Wt,{value:c,min:0,max:e.maxMeasure,onChange:function(e){return u(e)}})),o.a.createElement(ve.a,{fullWidth:!0,className:e.classes.formControl},o.a.createElement(hn.a,{component:"legend"},"Last Measure"),o.a.createElement(Wt,{value:m,min:0,max:e.maxMeasure,onChange:function(e){return h(e)}})))})),Mn={closedDialog:kt,switchedPage:qe,createdProject:Qe,addedSection:st,switchAudioFile:ba},Hn=Object(s.b)((function(e){var t=e.dialog,a=e.project,n=e.analysis;return{type:t.currentDialog,audioUrl:a.audioUrl,maxMeasure:n.measures.allIds.length-1}}),Mn)(Fn);var zn=function(){return o.a.createElement("audio",{id:"audio_dom_element",controls:!0,hidden:!0},"Your browser does not support the audio element.")};Object(l.render)(o.a.createElement(s.a,{store:Un},o.a.createElement(r.a,{theme:k},o.a.createElement(n.a,null),o.a.createElement(zn,null),o.a.createElement(Hn,null),o.a.createElement(dn,null))),document.getElementById("root"))}},[[870,1,2]]]);
//# sourceMappingURL=main.a23b3c76.chunk.js.map