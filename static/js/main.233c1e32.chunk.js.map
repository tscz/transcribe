{"version":3,"sources":["components/log/log.ts","components/view/view.tsx","pages/default/defaultPage.tsx","pages/drum/drumPage.tsx","pages/guitar/guitarPage.tsx","pages/harmony/harmonyPage.tsx","pages/print/printPage.tsx","components/contentLayout/contentLayout.tsx","states/projectSlice.ts","states/audioSlice.ts","states/analysisSlice.ts","states/waveSlice.ts","components/measureSelect/measureSelect.tsx","components/audioManagement/peaksConfig.ts","components/sectionSelect/sectionSelect.tsx","util/ArrayUtil.ts","states/dialogsSlice.ts","views/structure/structureView.tsx","components/sectionOverview/sectionOverview.tsx","views/structureNavigation/structureNavigationView.tsx","views/wave/waveView.tsx","views/wave/waveContainer.tsx","views/waveControl/waveControlView.tsx","pages/structure/structurePage.tsx","components/versionInfo/versionInfo.tsx","components/app/logo.svg","components/app/app.tsx","styles/styles.ts","api/persistenceApi.ts","components/fileInput/fileInput.tsx","components/audioManagement/audioPlayer.ts","components/audioManagement/audioManagement.tsx","states/store.ts","components/modalDialog/modalDialog.tsx","components/dialogManagement/dialogManagement.tsx","styles/theme.ts","index.tsx"],"names":["Level","View","Card","style","height","backgroundColor","raised","CardHeader","titleTypographyProps","variant","title","this","props","padding","action","CardContent","body","Component","DefaultPage","React","DrumPage","GuitarPage","HarmonyPage","PrintPage","ContentLayout","Grid","container","spacing","alignItems","item","xs","topLeft","topRight","bottom","LoadingStatus","Page","LEVEL_TO_COLOR","Map","TRACE","INFO","WARN","ERROR","Log","level","message","source","namespace","createDebug","debug","color","get","generateMessage","audioSlice","createSlice","name","initialState","isPlaying","detune","playbackRate","reducers","triggeredPlay","state","triggeredPause","updatedPlaybackSettings","undefined","payload","actions","TimeSignatureType","initialProjectState","status","NOT_INITIALIZED","currentPage","DEFAULT","audioUrl","syncFirstMeasureStart","projectSlice","switchedPage","createdProject","project","INITIALIZING","hotReloaded","initializedProject","INITIALIZED","enabledSyncFirstMeasureStart","waveSlice","zoom","zoomedOut","zoomedIn","MeasureSelect","value","onChange","event","newMeasure","target","minWidth","Array","max","min","fill","map","_","idx","MenuItem","key","SectionType","initialAnalysisState","sections","allIds","byId","bpm","firstMeasureStart","audioDuration","audioSampleRate","measures","timeSignature","FOUR_FOUR","generateMeasures","timeSignatureType","length","lengthOfOneMeasure","type","beatUnit","beatsPerMeasure","THREE_FOUR","toTimeSignature","index","start","push","time","editable","id","labelText","analysisSlice","extraReducers","builder","addCase","analysis","addedSection","generateSectionId","updatedSection","filter","before","after","removedSection","updatedRhythm","section","PeaksConfig","create","audioBuffer","mediaelement","document","getElementById","containers","zoomview","overview","mediaElement","webAudio","scale","multiChannel","keyboard","pointMarkerColor","showPlayheadTime","zoomLevels","sectionsToSegment","segments","forEach","segment","startTime","endTime","SECTIONTYPE_TO_COLOR","measuresToPoints","points","point","computeZoomLevels","secondsPerMeasure","zoomviewWidth","measuresCount","baseZoom","Math","floor","levels","INTRO","VERSE","PRECHORUS","CHORUS","SOLO","OUTRO","BRIDGE","UNDEFINED","SectionSelect","newSection","Object","values","sectionType","ArrayUtil","range","end","toString","DialogType","StructureView","handleAddSection","handleUpdatedSection","info","JSON","stringify","handleRemoveSection","TableContainer","component","Paper","Table","size","TableHead","TableRow","TableCell","width","TableBody","scope","IconButton","onClick","parseInt","measure","mapDispatchToProps","connect","SectionOverview","direction","sectionId","Typography","toLowerCase","marginBottom","arr","res","i","slice","generateMatrix","row","ButtonGroup","orientation","measureId","bg","Square","Button","StructureNavigationView","WaveView","nextProps","url","WaveContainer","audioLoaded","CircularProgress","WaveControlView","handleTimeSignatureChange","e","handleBpmChange","isArray","handleDetuneChange","handlePlaybackRateChange","FormControl","fullWidth","InputLabel","Input","startAdornment","InputAdornment","position","Tooltip","ToggleButton","selected","step","NativeSelect","SliderInput","shrink","Box","mt","Slider","valueLabelDisplay","audio","wave","StructurePage","anchorEl","handleClick","setState","currentTarget","handleClose","icon","Popover","open","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","WaveformControlButton","marginTop","marginRight","loaded","initialDialogState","currentDialog","NONE","dialogsSlice","openedDialog","closedDialog","VersionInfo","version","href","hash","description","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","d","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref17","_ref18","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","_ref25","_ref26","_ref","svgRef","x","y","viewBox","enableBackground","xmlSpace","ref","cx","cy","r","ForwardRef","forwardRef","App","className","classes","root","AppBar","appBar","Toolbar","noWrap","NEW","disabled","OPEN","SAVE","Drawer","drawer","paper","drawerPaper","toolbar","List","ListItem","button","STRUCTURE","ListItemIcon","ListItemText","primary","HARMONY","GUITAR","DRUM","PRINT","content","show","justify","process","Toggle","display","children","withStyles","theme","createStyles","zIndex","flexShrink","flexGrow","mixins","marginLeft","withTheme","PersistenceApi","zip","JSZip","loadAsync","archive","file","songFile","async","audioBlob","stateFile","json","parse","window","URL","revokeObjectURL","blob","createObjectURL","save","filename","options","a","fetch","audioFileUrl","response","generateAsync","then","saveAs","FileType","AudioPlayer","peaks","onSongComplete","player","pitchShift","shiftToSemitones","shift","log2","destroy","Tone","context","dispose","setContext","AudioContext","play","Transport","now","getCurrentTime","emit","pause","isSeeking","buffer","toSeconds","getDuration","duration","seek","normalizedTime","stop","Player","sync","PitchShift","connectSeries","Master","scheduleRepeat","pitch","AudioManagement","getPeaks","getPlayer","init","audioCtx","arrayBuffer","decodeAudioData","initPeaks","prevProps","revokeLocalFile","recomputeZoomlevels","repaintWaveform","zoomLevel","setPlaybackRate","setDetune","newZoomLevels","clientWidth","setZoomLevels","removeAll","add","setZoom","Peaks","err","Error","initPlayer","replacePlayer","on","sampleRate","controls","hidden","src","restoredPersistedState","createAction","createRootReducer","sliceReducer","match","combineReducers","analysisReducer","audioReducer","dialog","dialogReducer","projectReducer","waveReducer","createAppStore","configureStore","reducer","preloadedState","AUDIO","ZIP","FileInput","fileInput","handleChange","fileList","fileURL","getLocalFileUrl","callback","createRef","InputBase","input","placeholder","fileType","inputProps","readOnly","current","click","aria-label","iconButton","accept","files","flex","ModalDialog","Dialog","onCancel","maxWidth","DialogTitle","DialogContent","DialogActions","label","DialogManagement","onSubmit","zipUrl","store","getState","NewDialog","useState","fileUrl","setFileUrl","setTitle","TextField","margin","InputProps","OpenDialog","setFile","createMuiTheme","palette","blueGrey","render","ThemeProvider","CssBaseline"],"mappings":"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","file":"static/js/main.233c1e32.chunk.js","sourcesContent":["import debug from \"debug\";\r\n\r\nenum Level {\r\n  TRACE = \"trace\",\r\n  INFO = \"info\",\r\n  WARN = \"warn\",\r\n  ERROR = \"error\"\r\n}\r\n\r\nconst LEVEL_TO_COLOR = new Map<Level, string>([\r\n  [Level.TRACE, \"lightblue\"],\r\n  [Level.INFO, \"blue\"],\r\n  [Level.WARN, \"yellow\"],\r\n  [Level.ERROR, \"red\"]\r\n]) as ReadonlyMap<Level, string>;\r\n\r\nclass Log {\r\n  private static generateMessage(\r\n    level: Level,\r\n    message: string,\r\n    source: string\r\n  ) {\r\n    const namespace = `transcribe:${level}`;\r\n    const createDebug = debug(namespace);\r\n\r\n    createDebug.color = LEVEL_TO_COLOR.get(level)!;\r\n\r\n    if (source) {\r\n      createDebug(source, message);\r\n    } else {\r\n      createDebug(message);\r\n    }\r\n  }\r\n\r\n  static trace(message: string, source: string) {\r\n    return this.generateMessage(Level.TRACE, message, source);\r\n  }\r\n\r\n  static info(message: string, source: string) {\r\n    return this.generateMessage(Level.INFO, message, source);\r\n  }\r\n\r\n  static warn(message: string, source: string) {\r\n    return this.generateMessage(Level.WARN, message, source);\r\n  }\r\n\r\n  static error(message: string, source: string) {\r\n    return this.generateMessage(Level.ERROR, message, source);\r\n  }\r\n}\r\n\r\nexport default Log;\r\n","import { CardHeader } from \"@material-ui/core\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport React, { Component, ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  body: ReactElement;\r\n  title: string;\r\n  action?: ReactElement;\r\n}\r\n\r\nclass View extends Component<Props> {\r\n  render() {\r\n    return (\r\n      <Card\r\n        style={{\r\n          height: \"100%\",\r\n          backgroundColor: \"#ffffff\"\r\n        }}\r\n        raised={false}\r\n      >\r\n        <CardHeader\r\n          titleTypographyProps={{ variant: \"subtitle1\" }}\r\n          title={this.props.title}\r\n          style={{ backgroundColor: \"#f1f4f6\", padding: \"4px\" }}\r\n          action={this.props.action}\r\n        />\r\n        <CardContent>{this.props.body}</CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nexport default View;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DefaultPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Info\"\r\n        body={\r\n          <>\r\n            <p>No Transcription started!!</p>\r\n            <p>Please create a new Transcription or open an existing one.</p>\r\n          </>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DefaultPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass DrumPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Drums View\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the drum part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DrumPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass GuitarPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Guitar\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the guitar part. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GuitarPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass HarmonyPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Harmony\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to transcribe the harmony. Please\r\n            come back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HarmonyPage;\r\n","import React from \"react\";\r\n\r\nimport View from \"../../components/view/view\";\r\n\r\nclass PrintPage extends React.Component {\r\n  render() {\r\n    return (\r\n      <View\r\n        title=\"Print\"\r\n        body={\r\n          <p>\r\n            In this section you'll be able to print the leadsheet. Please come\r\n            back later.\r\n          </p>\r\n        }\r\n      ></View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PrintPage;\r\n","import Grid from \"@material-ui/core/Grid\";\r\nimport React, { ReactElement } from \"react\";\r\n\r\ninterface Props {\r\n  topLeft: ReactElement;\r\n  topRight: ReactElement;\r\n  bottom?: ReactElement;\r\n}\r\n\r\nclass ContentLayout extends React.Component<Props> {\r\n  render() {\r\n    return (\r\n      <Grid container spacing={2} alignItems=\"stretch\">\r\n        <Grid item xs={9}>\r\n          {this.props.topLeft}\r\n        </Grid>\r\n        <Grid item xs={3}>\r\n          {this.props.topRight}\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          {this.props.bottom}\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ContentLayout;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nimport { PersistedState } from \"./store\";\r\n\r\nexport interface ProjectState {\r\n  readonly status: LoadingStatus;\r\n  readonly currentPage: Page;\r\n  readonly title: string;\r\n  readonly audioUrl: string;\r\n  readonly syncFirstMeasureStart: boolean;\r\n}\r\n\r\nexport enum LoadingStatus {\r\n  NOT_INITIALIZED = \"not_initialized\",\r\n  INITIALIZING = \"initializing\",\r\n  INITIALIZED = \"initialized\"\r\n}\r\n\r\nexport enum Page {\r\n  DEFAULT = \"default\",\r\n  STRUCTURE = \"structure\",\r\n  HARMONY = \"harmony\",\r\n  GUITAR = \"guitar\",\r\n  DRUM = \"drum\",\r\n  PRINT = \"print\"\r\n}\r\n\r\nexport const initialProjectState: ProjectState = {\r\n  status: LoadingStatus.NOT_INITIALIZED,\r\n  currentPage: Page.DEFAULT,\r\n  title: \"\",\r\n  audioUrl: \"\",\r\n  syncFirstMeasureStart: false\r\n};\r\n\r\nconst projectSlice = createSlice({\r\n  name: \"project\",\r\n  initialState: initialProjectState,\r\n  reducers: {\r\n    switchedPage(state, action: PayloadAction<Page>) {\r\n      state.currentPage = action.payload;\r\n    },\r\n    createdProject(state, action: PayloadAction<PersistedState>) {\r\n      return { ...action.payload.project, status: LoadingStatus.INITIALIZING };\r\n    },\r\n    hotReloaded(state) {\r\n      state.status = LoadingStatus.INITIALIZING;\r\n    },\r\n    initializedProject(\r\n      state,\r\n      action: PayloadAction<{ audioDuration: number; audioSampleRate: number }>\r\n    ) {\r\n      state.status = LoadingStatus.INITIALIZED;\r\n    },\r\n    enabledSyncFirstMeasureStart(state, action: PayloadAction<boolean>) {\r\n      state.syncFirstMeasureStart = action.payload;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  switchedPage,\r\n  createdProject,\r\n  initializedProject,\r\n  hotReloaded,\r\n  enabledSyncFirstMeasureStart\r\n} = projectSlice.actions;\r\n\r\nexport default projectSlice.reducer;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface AudioState {\r\n  readonly isPlaying: boolean;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n}\r\n\r\nexport interface PlaybackSettings {\r\n  readonly detune?: number;\r\n  readonly playbackRate?: number;\r\n}\r\n\r\nexport const initialAudioState: AudioState = {\r\n  isPlaying: false,\r\n  detune: 0,\r\n  playbackRate: 1\r\n};\r\n\r\nconst audioSlice = createSlice({\r\n  name: \"audio\",\r\n  initialState: initialAudioState,\r\n  reducers: {\r\n    triggeredPlay(state) {\r\n      state.isPlaying = true;\r\n    },\r\n    triggeredPause(state) {\r\n      state.isPlaying = false;\r\n    },\r\n    updatedPlaybackSettings(\r\n      state,\r\n      action: PayloadAction<{ playbackRate?: number; detune?: number }>\r\n    ) {\r\n      if (action.payload.detune !== undefined)\r\n        state.detune = action.payload.detune;\r\n      if (action.payload.playbackRate !== undefined)\r\n        state.playbackRate = action.payload.playbackRate;\r\n    }\r\n  }\r\n});\r\n\r\nexport const {\r\n  triggeredPause,\r\n  triggeredPlay,\r\n  updatedPlaybackSettings\r\n} = audioSlice.actions;\r\n\r\nexport default audioSlice.reducer;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { PointAddOptions } from \"peaks.js\";\r\n\r\nimport { createdProject, initializedProject } from \"./projectSlice\";\r\nimport { NormalizedObjects } from \"./store\";\r\n\r\nexport interface AnalysisState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly audioDuration: number;\r\n  readonly audioSampleRate: number;\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly measures: NormalizedObjects<Measure>;\r\n}\r\n\r\nexport interface Section {\r\n  type: SectionType;\r\n  measures: string[];\r\n}\r\n\r\nexport interface Measure extends PointAddOptions {}\r\n\r\nexport interface TimeSignature {\r\n  beatsPerMeasure: number;\r\n  beatUnit: number;\r\n}\r\n\r\nexport enum TimeSignatureType {\r\n  FOUR_FOUR = \"FOUR_FOUR\",\r\n  THREE_FOUR = \"THREE_FOUR\"\r\n}\r\n\r\nexport const toTimeSignature = (type: TimeSignatureType) => {\r\n  switch (type) {\r\n    case TimeSignatureType.FOUR_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 4 };\r\n    case TimeSignatureType.THREE_FOUR:\r\n      return { beatUnit: 4, beatsPerMeasure: 3 };\r\n  }\r\n};\r\n\r\nexport enum SectionType {\r\n  INTRO = \"INTRO\",\r\n  VERSE = \"VERSE\",\r\n  PRECHORUS = \"PRECHORUS\",\r\n  CHORUS = \"CHORUS\",\r\n  BRIDGE = \"BRIDGE\",\r\n  SOLO = \"SOLO\",\r\n  OUTRO = \"OUTRO\",\r\n  UNDEFINED = \"UNDEFINED\"\r\n}\r\n\r\nexport const initialAnalysisState: AnalysisState = {\r\n  sections: { allIds: [], byId: {} },\r\n  bpm: 120,\r\n  firstMeasureStart: 0,\r\n  audioDuration: 180,\r\n  audioSampleRate: 44400,\r\n  measures: { allIds: [], byId: {} },\r\n  timeSignature: TimeSignatureType.FOUR_FOUR\r\n};\r\n\r\nconst generateMeasures = (\r\n  timeSignatureType: TimeSignatureType,\r\n  bpm: number,\r\n  firstMeasureStart: number,\r\n  length: number\r\n) => {\r\n  const timeSignature = toTimeSignature(timeSignatureType);\r\n  const lengthOfOneMeasure = (60 * timeSignature.beatsPerMeasure) / bpm;\r\n  const measures: NormalizedObjects<Measure> = { allIds: [], byId: {} };\r\n\r\n  let index = 0;\r\n  for (\r\n    let start = firstMeasureStart;\r\n    start < length;\r\n    start += lengthOfOneMeasure\r\n  ) {\r\n    measures.allIds.push(\"\" + index);\r\n    measures.byId[index] = {\r\n      time: start,\r\n      color: \"\",\r\n      editable: false,\r\n      id: \"\" + index,\r\n      labelText: \"\" + index\r\n    };\r\n    index++;\r\n  }\r\n\r\n  return measures;\r\n};\r\n\r\nconst analysisSlice = createSlice({\r\n  name: \"analysis\",\r\n  initialState: initialAnalysisState,\r\n  extraReducers: builder =>\r\n    builder\r\n      .addCase(createdProject, (state, action) => {\r\n        return action.payload.analysis;\r\n      })\r\n      .addCase(initializedProject, (state, action) => {\r\n        state.audioDuration = action.payload.audioDuration;\r\n        state.audioSampleRate = action.payload.audioSampleRate;\r\n        state.measures = generateMeasures(\r\n          state.timeSignature,\r\n          state.bpm,\r\n          state.firstMeasureStart,\r\n          state.audioDuration\r\n        );\r\n      }),\r\n  reducers: {\r\n    addedSection(state, action: PayloadAction<Section>) {\r\n      const id = generateSectionId(action.payload);\r\n      state.sections.allIds.push(id);\r\n      state.sections.byId[id] = action.payload;\r\n    },\r\n    updatedSection(\r\n      state,\r\n      action: PayloadAction<{ before: string; after: Section }>\r\n    ) {\r\n      state.sections.allIds = state.sections.allIds.filter(\r\n        id => id !== action.payload.before\r\n      );\r\n\r\n      delete state.sections.byId[action.payload.before];\r\n\r\n      const id = generateSectionId(action.payload.after);\r\n      state.sections.allIds.push(id);\r\n      state.sections.byId[id] = action.payload.after;\r\n    },\r\n    removedSection(state, action: PayloadAction<string>) {\r\n      state.sections.allIds = state.sections.allIds.filter(\r\n        id => id !== action.payload\r\n      );\r\n\r\n      delete state.sections.byId[action.payload];\r\n    },\r\n    updatedRhythm(\r\n      state,\r\n      action: PayloadAction<{\r\n        firstMeasureStart?: number;\r\n        bpm?: number;\r\n        timeSignatureType?: TimeSignatureType;\r\n      }>\r\n    ) {\r\n      state.bpm = action.payload.bpm ?? state.bpm;\r\n      state.firstMeasureStart =\r\n        action.payload.firstMeasureStart ?? state.firstMeasureStart;\r\n      state.timeSignature =\r\n        action.payload.timeSignatureType ?? state.timeSignature;\r\n\r\n      state.measures = generateMeasures(\r\n        state.timeSignature,\r\n        state.bpm,\r\n        state.firstMeasureStart,\r\n        state.audioDuration\r\n      );\r\n    }\r\n  }\r\n});\r\n\r\nconst generateSectionId = (section: Section) =>\r\n  section.type +\r\n  \"_\" +\r\n  section.measures[0] +\r\n  \"_\" +\r\n  section.measures[section.measures.length - 1];\r\n\r\nexport const {\r\n  addedSection,\r\n  removedSection,\r\n  updatedRhythm,\r\n  updatedSection\r\n} = analysisSlice.actions;\r\n\r\nexport default analysisSlice.reducer;\r\n","import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport interface WaveState {\r\n  readonly zoom: number;\r\n}\r\n\r\nexport const initialWaveState: WaveState = {\r\n  zoom: 0\r\n};\r\n\r\nconst waveSlice = createSlice({\r\n  name: \"wave\",\r\n  initialState: initialWaveState,\r\n  reducers: {\r\n    zoomedOut(state) {\r\n      state.zoom =\r\n        state.zoom === 42 //TODO: use max zoomlevel here, which is dynamic\r\n          ? state.zoom\r\n          : state.zoom + 1;\r\n    },\r\n    zoomedIn(state) {\r\n      state.zoom = state.zoom === 0 ? state.zoom : state.zoom - 1;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { zoomedIn, zoomedOut } = waveSlice.actions;\r\n\r\nexport default waveSlice.reducer;\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nconst MeasureSelect: FunctionComponent<{\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  onChange: (value: number) => void;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newMeasure = event.target.value as number;\r\n    props.onChange(newMeasure);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        minWidth: \"40px\"\r\n      }}\r\n    >\r\n      {new Array<number>(props.max - props.min + 1)\r\n        .fill(0)\r\n        .map((_, idx: number) => {\r\n          return (\r\n            <MenuItem key={props.min + idx} value={props.min + idx}>\r\n              {props.min + idx}\r\n            </MenuItem>\r\n          );\r\n        })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default MeasureSelect;\r\n","import { PointAddOptions, SegmentAddOptions } from \"peaks.js\";\r\n\r\nimport { Measure, Section, SectionType } from \"../../states/analysisSlice\";\r\nimport { NormalizedObjects } from \"../../states/store\";\r\n\r\nexport const AUDIO_DOM_ELEMENT = \"audio_dom_element\";\r\nexport const ZOOMVIEW_CONTAINER = \"zoomview-container\";\r\nexport const OVERVIEW_CONTAINER = \"overview-container\";\r\n\r\nclass PeaksConfig {\r\n  static create = (audioBuffer: AudioBuffer) => {\r\n    let mediaelement = document!.getElementById(\r\n      AUDIO_DOM_ELEMENT\r\n    )! as HTMLAudioElement;\r\n\r\n    return {\r\n      containers: {\r\n        zoomview: document!.getElementById(ZOOMVIEW_CONTAINER)!,\r\n        overview: document!.getElementById(OVERVIEW_CONTAINER)!\r\n      },\r\n      mediaElement: mediaelement,\r\n      webAudio: {\r\n        audioBuffer: audioBuffer,\r\n        scale: 128,\r\n        multiChannel: false\r\n      },\r\n      keyboard: true,\r\n      pointMarkerColor: \"#006eb0\",\r\n      showPlayheadTime: true,\r\n      zoomLevels: [42] //TODO: Define good initial default\r\n    };\r\n  };\r\n\r\n  static sectionsToSegment = (\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>\r\n  ) => {\r\n    let segments: SegmentAddOptions[] = [];\r\n    sections.allIds.forEach(id => {\r\n      const section = sections.byId[id];\r\n\r\n      let segment: SegmentAddOptions = {\r\n        id,\r\n        labelText: section.type,\r\n        startTime: measures.byId[section.measures[0]].time,\r\n        endTime:\r\n          measures.byId[section.measures[section.measures.length - 1]].time,\r\n        color: PeaksConfig.SECTIONTYPE_TO_COLOR.get(section.type),\r\n        editable: false\r\n      };\r\n\r\n      segments.push(segment);\r\n    });\r\n\r\n    return segments;\r\n  };\r\n\r\n  static measuresToPoints = (measures: NormalizedObjects<Measure>) => {\r\n    let points: PointAddOptions[] = [];\r\n    measures.allIds.forEach(id => {\r\n      const measure = measures.byId[id];\r\n\r\n      let point: PointAddOptions = measure;\r\n\r\n      points.push(point);\r\n    });\r\n\r\n    return points;\r\n  };\r\n\r\n  static computeZoomLevels = (\r\n    secondsPerMeasure: number,\r\n    audioSampleRate: number,\r\n    zoomviewWidth: number,\r\n    measuresCount: number\r\n  ) => {\r\n    const baseZoom = Math.floor(\r\n      (secondsPerMeasure * audioSampleRate) / zoomviewWidth\r\n    );\r\n\r\n    let levels = new Array<number>(measuresCount);\r\n\r\n    for (let index = 0; index < levels.length; index++) {\r\n      levels[index] = baseZoom * (index + 1);\r\n    }\r\n\r\n    return levels;\r\n  };\r\n\r\n  static SECTIONTYPE_TO_COLOR = new Map<SectionType, string>([\r\n    [SectionType.INTRO, \"#FFCA28\"],\r\n    [SectionType.VERSE, \"#FFA726\"],\r\n    [SectionType.PRECHORUS, \"#FF7043\"],\r\n    [SectionType.CHORUS, \"#9CCC65\"],\r\n    [SectionType.SOLO, \"#26C6DA\"],\r\n    [SectionType.OUTRO, \"#5C6BC0\"],\r\n    [SectionType.BRIDGE, \"#EC407A\"],\r\n    [SectionType.VERSE, \"#78909C\"],\r\n    [SectionType.UNDEFINED, \"#ffffff\"]\r\n  ]) as ReadonlyMap<SectionType, string>;\r\n}\r\n\r\nexport default PeaksConfig;\r\n","import { MenuItem } from \"@material-ui/core\";\r\nimport Select from \"@material-ui/core/Select/Select\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nimport { SectionType } from \"../../states/analysisSlice\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\nconst SectionSelect: FunctionComponent<{\r\n  value: SectionType;\r\n  onChange: (sectionType: SectionType) => void;\r\n}> = props => {\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    let newSection = event.target.value as SectionType;\r\n    props.onChange(newSection);\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      value={props.value}\r\n      onChange={handleChange}\r\n      style={{\r\n        backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(props.value),\r\n        minWidth: \"140px\"\r\n      }}\r\n    >\r\n      {Object.values(SectionType).map(sectionType => {\r\n        return (\r\n          <MenuItem\r\n            key={sectionType}\r\n            value={sectionType}\r\n            style={{\r\n              backgroundColor: PeaksConfig.SECTIONTYPE_TO_COLOR.get(sectionType)\r\n            }}\r\n          >\r\n            {sectionType}\r\n          </MenuItem>\r\n        );\r\n      })}\r\n    </Select>\r\n  );\r\n};\r\n\r\nexport default SectionSelect;\r\n","class ArrayUtil {\r\n  static range: (start: number, end: number) => string[] = (start, end) => {\r\n    if (start > end) start = end;\r\n\r\n    return Array(end - start + 1)\r\n      .fill(start)\r\n      .map((_, idx) => (start + idx).toString());\r\n  };\r\n}\r\n\r\nexport default ArrayUtil;\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface DialogState {\r\n  readonly currentDialog: DialogType;\r\n}\r\n\r\nexport enum DialogType {\r\n  NONE = \"none\",\r\n  NEW = \"new\",\r\n  OPEN = \"open\",\r\n  SAVE = \"save\"\r\n}\r\n\r\nconst initialDialogState: DialogState = {\r\n  currentDialog: DialogType.NONE\r\n};\r\n\r\nconst dialogsSlice = createSlice({\r\n  name: \"dialogs\",\r\n  initialState: initialDialogState,\r\n  reducers: {\r\n    openedDialog(state, action: PayloadAction<DialogType>) {\r\n      state.currentDialog = action.payload;\r\n    },\r\n    closedDialog(state) {\r\n      state.currentDialog = DialogType.NONE;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { openedDialog, closedDialog } = dialogsSlice.actions;\r\n\r\nexport default dialogsSlice.reducer;\r\n","import {\r\n  IconButton,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow\r\n} from \"@material-ui/core\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport MeasureSelect from \"../../components/measureSelect/measureSelect\";\r\nimport SectionSelect from \"../../components/sectionSelect/sectionSelect\";\r\nimport {\r\n  addedSection,\r\n  removedSection,\r\n  Section,\r\n  SectionType,\r\n  updatedSection\r\n} from \"../../states/analysisSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport ArrayUtil from \"../../util/ArrayUtil\";\r\n\r\ninterface PropsFromState {\r\n  readonly sections: NormalizedObjects<Section>;\r\n  readonly measuresCount: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  addedSection: typeof addedSection;\r\n  updatedSection: typeof updatedSection;\r\n  removedSection: typeof removedSection;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureView extends Component<AllProps> {\r\n  handleAddSection = (section: Section) => {\r\n    this.props.addedSection(section);\r\n  };\r\n\r\n  handleUpdatedSection = (id: string, before: Section, after: Section) => {\r\n    Log.info(\r\n      \"Change section \" +\r\n        id +\r\n        \" from \" +\r\n        JSON.stringify(before) +\r\n        \" to \" +\r\n        JSON.stringify(after),\r\n      StructureView.name\r\n    );\r\n\r\n    if (after.measures[0] > after.measures[after.measures.length - 1]) return;\r\n\r\n    this.props.updatedSection({ before: id, after });\r\n  };\r\n\r\n  handleRemoveSection = (id: string) => {\r\n    this.props.removedSection(id);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <TableContainer component={Paper}>\r\n        <Table size=\"small\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell style={{ width: \"10%\" }}></TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Section</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>First Measure</TableCell>\r\n              <TableCell style={{ width: \"30%\" }}>Last Measure</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {this.props.sections.allIds.map((id: string) => {\r\n              let section = this.props.sections.byId[id];\r\n              return (\r\n                <TableRow key={id}>\r\n                  <TableCell component=\"th\" scope=\"row\">\r\n                    <IconButton\r\n                      onClick={() => this.handleRemoveSection(id)}\r\n                      size=\"small\"\r\n                    >\r\n                      <RemoveIcon></RemoveIcon>\r\n                    </IconButton>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <SectionSelect\r\n                      value={section.type}\r\n                      onChange={sectionType =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          type: sectionType\r\n                        })\r\n                      }\r\n                    ></SectionSelect>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      value={parseInt(section.measures[0])}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            measure,\r\n                            parseInt(\r\n                              section.measures[section.measures.length - 1]\r\n                            )\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <MeasureSelect\r\n                      value={parseInt(\r\n                        section.measures[section.measures.length - 1]\r\n                      )}\r\n                      min={0}\r\n                      max={this.props.measuresCount - 1}\r\n                      onChange={measure =>\r\n                        this.handleUpdatedSection(id, section, {\r\n                          ...section,\r\n                          measures: ArrayUtil.range(\r\n                            parseInt(section.measures[0]),\r\n                            measure\r\n                          )\r\n                        })\r\n                      }\r\n                    />\r\n                  </TableCell>\r\n                </TableRow>\r\n              );\r\n            })}\r\n            <TableRow key=\"last\">\r\n              <TableCell component=\"th\" scope=\"row\">\r\n                <IconButton\r\n                  onClick={() => {\r\n                    this.handleAddSection({\r\n                      type: SectionType.SOLO,\r\n                      measures: [\"1\", \"2\", \"3\", \"4\"]\r\n                    });\r\n                  }}\r\n                  size=\"small\"\r\n                >\r\n                  <AddIcon></AddIcon>\r\n                </IconButton>\r\n              </TableCell>\r\n              <TableCell />\r\n              <TableCell />\r\n              <TableCell />\r\n            </TableRow>\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measuresCount: analysis.measures.allIds.length\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  addedSection,\r\n  updatedSection,\r\n  removedSection\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructureView);\r\n","import { Button, ButtonGroup, Grid, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { Measure, Section } from \"../../states/analysisSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport PeaksConfig from \"../audioManagement/peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n}\r\n\r\ninterface PropsFromDispatch {}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass SectionOverview extends React.Component<AllProps> {\r\n  render() {\r\n    let { sections, measures } = this.props;\r\n\r\n    let generateMatrix = (arr: string[], size: number) => {\r\n      var res = [];\r\n      for (var i = 0; i < arr.length; i = i + size)\r\n        res.push(arr.slice(i, i + size));\r\n      return res;\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <Grid container direction=\"column\">\r\n          {sections.allIds.map(sectionId => (\r\n            <Grid item key={sectionId}>\r\n              <Grid container direction=\"column\">\r\n                <Grid item>\r\n                  <Typography variant=\"caption\">\r\n                    {sections.byId[sectionId].type.toLowerCase()}\r\n                  </Typography>\r\n                </Grid>\r\n                <Grid item>\r\n                  <Grid\r\n                    container\r\n                    direction=\"column\"\r\n                    style={{ marginBottom: \"5px\" }}\r\n                  >\r\n                    {generateMatrix(sections.byId[sectionId].measures, 8).map(\r\n                      row => (\r\n                        <ButtonGroup orientation=\"horizontal\" size=\"small\">\r\n                          {row.map(measureId => {\r\n                            let measure: Measure = measures.byId[measureId];\r\n\r\n                            return (\r\n                              <Square\r\n                                key={measure.id}\r\n                                value={measure.id!}\r\n                                bg={\r\n                                  PeaksConfig.SECTIONTYPE_TO_COLOR.get(\r\n                                    sections.byId[sectionId].type\r\n                                  )!\r\n                                }\r\n                              ></Square>\r\n                            );\r\n                          })}\r\n                        </ButtonGroup>\r\n                      )\r\n                    )}\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nclass Square extends React.Component<{\r\n  value: string;\r\n  bg: string;\r\n}> {\r\n  render() {\r\n    return (\r\n      <Button\r\n        {...this.props}\r\n        style={{\r\n          backgroundColor: this.props.bg\r\n        }}\r\n      >\r\n        {this.props.value}\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {\r\n    sections: analysis.sections,\r\n    measures: analysis.measures\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SectionOverview);\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport SectionOverview from \"../../components/sectionOverview/sectionOverview\";\r\nimport { ApplicationState } from \"../../states/store\";\r\n\r\ninterface PropsFromState {}\r\n\r\ninterface PropsFromDispatch {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass StructureNavigationView extends Component<AllProps> {\r\n  render() {\r\n    return <SectionOverview></SectionOverview>;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ analysis }: ApplicationState) => {\r\n  return {};\r\n};\r\n\r\nconst mapDispatchToProps = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(StructureNavigationView);\r\n","import React, { Component } from \"react\";\r\n\r\nimport {\r\n  OVERVIEW_CONTAINER,\r\n  ZOOMVIEW_CONTAINER\r\n} from \"../../components/audioManagement/peaksConfig\";\r\nimport Log from \"../../components/log/log\";\r\n\r\ninterface Props {\r\n  url: string;\r\n}\r\n\r\nexport default class WaveView extends Component<Props> {\r\n  shouldComponentUpdate(nextProps: Props) {\r\n    return nextProps.url !== this.props.url;\r\n  }\r\n\r\n  render() {\r\n    Log.info(\"render with url=\" + this.props.url, WaveView.name);\r\n    return (\r\n      <div>\r\n        <div id=\"waveform-container\">\r\n          <div id={ZOOMVIEW_CONTAINER}></div>\r\n          <div id={OVERVIEW_CONTAINER}></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport Log from \"../../components/log/log\";\r\nimport { hotReloaded, LoadingStatus } from \"../../states/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport WaveView from \"./waveView\";\r\n\r\ninterface PropsFromState {\r\n  audioLoaded: LoadingStatus;\r\n  audioUrl: string;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  hotReloaded: typeof hotReloaded;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass WaveContainer extends Component<AllProps> {\r\n  constructor(props: AllProps) {\r\n    super(props);\r\n\r\n    if (process.env.NODE_ENV !== \"production\" && props.audioUrl) {\r\n      Log.info(\"Hot reload with url=\" + props.audioUrl, WaveContainer.name);\r\n      this.props.hotReloaded();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    Log.info(\r\n      \"render with props=\" + JSON.stringify(this.props),\r\n      WaveContainer.name\r\n    );\r\n\r\n    return (\r\n      <div>\r\n        {this.props.audioLoaded !== LoadingStatus.INITIALIZED && (\r\n          <CircularProgress />\r\n        )}\r\n        <WaveView url={this.props.audioUrl} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ project }: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    audioLoaded: project.status\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  hotReloaded\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveContainer);\r\n","import {\r\n  Box,\r\n  FormControl,\r\n  Input,\r\n  InputLabel,\r\n  NativeSelect,\r\n  Tooltip\r\n} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport SyncAltIcon from \"@material-ui/icons/SyncAlt\";\r\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\r\nimport React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { TimeSignatureType, updatedRhythm } from \"../../states/analysisSlice\";\r\nimport { updatedPlaybackSettings } from \"../../states/audioSlice\";\r\nimport { enabledSyncFirstMeasureStart } from \"../../states/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\n\r\ninterface PropsFromState {\r\n  readonly firstMeasureStart: number;\r\n  readonly timeSignature: TimeSignatureType;\r\n  readonly bpm: number;\r\n  readonly syncFirstMeasureStart: boolean;\r\n  readonly detune: number;\r\n  readonly playbackRate: number;\r\n  readonly zoom: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  updatedRhythm: typeof updatedRhythm;\r\n  enabledSyncFirstMeasureStart: typeof enabledSyncFirstMeasureStart;\r\n  updatedPlaybackSettings: typeof updatedPlaybackSettings;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass WaveControlView extends Component<AllProps> {\r\n  handleTimeSignatureChange = (e: any) => {\r\n    this.props.updatedRhythm({ timeSignatureType: e.target.value });\r\n  };\r\n\r\n  handleBpmChange = (e: any, bpm: number | number[]) => {\r\n    if (!Array.isArray(bpm)) {\r\n      this.props.updatedRhythm({ bpm: bpm });\r\n    }\r\n  };\r\n\r\n  handleDetuneChange = (e: any, detune: number | number[]) => {\r\n    if (!Array.isArray(detune) && detune !== this.props.detune) {\r\n      this.props.updatedPlaybackSettings({ detune: detune });\r\n    }\r\n  };\r\n\r\n  handlePlaybackRateChange = (e: any, playbackRate: number | number[]) => {\r\n    if (\r\n      !Array.isArray(playbackRate) &&\r\n      playbackRate !== this.props.playbackRate\r\n    ) {\r\n      this.props.updatedPlaybackSettings({ playbackRate: playbackRate });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Grid container direction=\"column\" spacing={3}>\r\n          <Grid item>\r\n            <FormControl fullWidth={true}>\r\n              <InputLabel>Start Measure 1</InputLabel>\r\n              <Input\r\n                type=\"text\"\r\n                id=\"startMeasure1\"\r\n                value={this.props.firstMeasureStart}\r\n                startAdornment={\r\n                  <InputAdornment position=\"start\">\r\n                    <Tooltip title=\"Sync with play head\">\r\n                      <ToggleButton\r\n                        style={{ width: \"15px\", height: \"25px\" }}\r\n                        value=\"check\"\r\n                        selected={this.props.syncFirstMeasureStart}\r\n                        onChange={() => {\r\n                          this.props.enabledSyncFirstMeasureStart(\r\n                            !this.props.syncFirstMeasureStart\r\n                          );\r\n                        }}\r\n                      >\r\n                        <SyncAltIcon />\r\n                      </ToggleButton>\r\n                    </Tooltip>\r\n                  </InputAdornment>\r\n                }\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Bpm\"\r\n              value={this.props.bpm}\r\n              min={40}\r\n              max={220}\r\n              step={1}\r\n              onChange={this.handleBpmChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n          <Grid item>\r\n            <FormControl fullWidth={true}>\r\n              <InputLabel>Time Signature</InputLabel>\r\n              <NativeSelect\r\n                value={this.props.timeSignature}\r\n                onChange={this.handleTimeSignatureChange}\r\n              >\r\n                <option value={TimeSignatureType.FOUR_FOUR}>4/4</option>\r\n                <option value={TimeSignatureType.THREE_FOUR}>3/4</option>\r\n              </NativeSelect>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Detune\"\r\n              value={this.props.detune}\r\n              min={-12}\r\n              max={12}\r\n              step={0.5}\r\n              onChange={this.handleDetuneChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n          <Grid item>\r\n            <SliderInput\r\n              title=\"Playback rate\"\r\n              value={this.props.playbackRate}\r\n              min={0.4}\r\n              max={1.2}\r\n              step={0.05}\r\n              onChange={this.handlePlaybackRateChange}\r\n            ></SliderInput>\r\n          </Grid>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst SliderInput = (props: {\r\n  title: string;\r\n  min: number;\r\n  max: number;\r\n  step: number;\r\n  value: number;\r\n  onChange: (event: any, value: number | number[]) => void;\r\n}) => {\r\n  return (\r\n    <FormControl style={{ width: \"100%\" }}>\r\n      <InputLabel shrink>{props.title}</InputLabel>\r\n      <Box mt={2}>\r\n        <Slider\r\n          value={props.value}\r\n          valueLabelDisplay=\"auto\"\r\n          min={props.min}\r\n          max={props.max}\r\n          onChange={props.onChange}\r\n          step={props.step}\r\n        />\r\n      </Box>\r\n    </FormControl>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({\r\n  project,\r\n  analysis,\r\n  audio,\r\n  wave\r\n}: ApplicationState) => {\r\n  return {\r\n    firstMeasureStart: analysis.firstMeasureStart,\r\n    bpm: analysis.bpm,\r\n    timeSignature: analysis.timeSignature,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate,\r\n    zoom: wave.zoom,\r\n    status: project.status\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  updatedRhythm,\r\n  enabledSyncFirstMeasureStart,\r\n  updatedPlaybackSettings\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(WaveControlView);\r\n","import { IconButton, Popover, Tooltip } from \"@material-ui/core\";\r\nimport LoopIcon from \"@material-ui/icons/Loop\";\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport TimerIcon from \"@material-ui/icons/Timer\";\r\nimport ZoomInIcon from \"@material-ui/icons/ZoomIn\";\r\nimport ZoomOutIcon from \"@material-ui/icons/ZoomOut\";\r\nimport React, { ReactElement } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport ContentLayout from \"../../components/contentLayout/contentLayout\";\r\nimport Log from \"../../components/log/log\";\r\nimport View from \"../../components/view/view\";\r\nimport { triggeredPause, triggeredPlay } from \"../../states/audioSlice\";\r\nimport { LoadingStatus } from \"../../states/projectSlice\";\r\nimport { ApplicationState } from \"../../states/store\";\r\nimport { zoomedIn, zoomedOut } from \"../../states/waveSlice\";\r\nimport StructureView from \"../../views/structure/structureView\";\r\nimport StructureNavigationView from \"../../views/structureNavigation/structureNavigationView\";\r\nimport WaveContainer from \"../../views/wave/waveContainer\";\r\nimport WaveControlView from \"../../views/waveControl/waveControlView\";\r\n\r\ninterface PropsFromState {\r\n  readonly loaded: boolean;\r\n  readonly isPlaying: boolean;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  zoomedIn: typeof zoomedIn;\r\n  zoomedOut: typeof zoomedOut;\r\n  triggeredPlay: typeof triggeredPlay;\r\n  triggeredPause: typeof triggeredPause;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\ninterface State {\r\n  anchorEl: HTMLButtonElement | null;\r\n}\r\n\r\nclass StructurePage extends React.Component<AllProps, State> {\r\n  state: State = {\r\n    anchorEl: null\r\n  };\r\n\r\n  handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    this.setState({ anchorEl: event.currentTarget });\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({ anchorEl: null });\r\n  };\r\n\r\n  render() {\r\n    Log.info(\"render\", StructurePage.name);\r\n    return (\r\n      <ContentLayout\r\n        topLeft={\r\n          <View\r\n            title=\"Song Overview\"\r\n            body={<WaveContainer />}\r\n            action={\r\n              <>\r\n                {this.props.isPlaying ? (\r\n                  <WaveformControlButton\r\n                    title=\"Pause\"\r\n                    icon={<PauseIcon />}\r\n                    onClick={() => this.props.triggeredPause()}\r\n                  />\r\n                ) : (\r\n                  <WaveformControlButton\r\n                    title=\"Play\"\r\n                    icon={<PlayArrowIcon />}\r\n                    onClick={() => this.props.triggeredPlay()}\r\n                  />\r\n                )}\r\n\r\n                <WaveformControlButton title=\"Loop\" icon={<LoopIcon />} />\r\n                <WaveformControlButton\r\n                  title=\"Metronome\"\r\n                  icon={<TimerIcon />}\r\n                  onClick={e => this.handleClick(e)}\r\n                />\r\n                <Popover\r\n                  style={{ height: \"400px\" }}\r\n                  open={Boolean(this.state.anchorEl)}\r\n                  anchorEl={this.state.anchorEl}\r\n                  onClose={() => this.handleClose()}\r\n                  anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"left\"\r\n                  }}\r\n                  transformOrigin={{\r\n                    vertical: \"top\",\r\n                    horizontal: \"left\"\r\n                  }}\r\n                >\r\n                  <WaveControlView></WaveControlView>\r\n                </Popover>\r\n                <WaveformControlButton\r\n                  title=\"Zoom in\"\r\n                  icon={<ZoomInIcon />}\r\n                  onClick={() => this.props.zoomedIn()}\r\n                />\r\n                <WaveformControlButton\r\n                  title=\"Zoom out\"\r\n                  icon={<ZoomOutIcon />}\r\n                  onClick={() => this.props.zoomedOut()}\r\n                />\r\n              </>\r\n            }\r\n          ></View>\r\n        }\r\n        topRight={\r\n          <View\r\n            title=\"Song Navigation\"\r\n            body={<StructureNavigationView />}\r\n          ></View>\r\n        }\r\n        bottom={<View title=\"Song Structure\" body={<StructureView />}></View>}\r\n      ></ContentLayout>\r\n    );\r\n  }\r\n}\r\n\r\nconst WaveformControlButton = (props: {\r\n  title: string;\r\n  icon: ReactElement;\r\n  onClick?: (e?: any) => void;\r\n}) => {\r\n  return (\r\n    <Tooltip title={props.title}>\r\n      <IconButton\r\n        onClick={props.onClick}\r\n        size=\"small\"\r\n        style={{ marginTop: \"8px\", marginRight: \"5px\" }}\r\n      >\r\n        {props.icon}\r\n      </IconButton>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ project, audio }: ApplicationState) => {\r\n  return {\r\n    loaded: project.status === LoadingStatus.INITIALIZED,\r\n    isPlaying: audio.isPlaying\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  zoomedIn,\r\n  zoomedOut,\r\n  triggeredPlay,\r\n  triggeredPause\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StructurePage);\r\n","import React from \"react\";\r\n\r\nclass VersionInfo extends React.Component<{\r\n  version: string;\r\n  hash: string;\r\n  description: string;\r\n}> {\r\n  render() {\r\n    return (\r\n      <>\r\n        {this.props.version} (\r\n        <a\r\n          href={\"https://github.com/tscz/transcribe/commit/\" + this.props.hash}\r\n        >\r\n          {this.props.hash} - {this.props.description}\r\n        </a>\r\n        )\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default VersionInfo;\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M339.063,60.817H228.938c-7.628,0-13.834,6.206-13.834,13.834v99.816l0,0c-4.47-2.616-9.666-4.123-15.208-4.123 c-16.658,0-30.21,13.552-30.21,30.209s13.552,30.209,30.21,30.209c16.657,0,30.209-13.552,30.209-30.209v-86.423h107.95v60.338 c-4.47-2.616-9.666-4.123-15.208-4.123c-16.657,0-30.209,13.552-30.209,30.209s13.552,30.209,30.209,30.209 s30.209-13.552,30.209-30.209V74.81l0,0C353.056,67.093,346.778,60.817,339.063,60.817z M199.896,215.759 c-8.387,0-15.209-6.822-15.209-15.208s6.822-15.208,15.209-15.208c8.385,0,15.208,6.822,15.208,15.208 S208.282,215.759,199.896,215.759z M322.848,215.759c-8.385,0-15.208-6.822-15.208-15.208s6.822-15.208,15.208-15.208 c8.386,0,15.208,6.822,15.208,15.208S331.232,215.759,322.848,215.759z M338.055,99.127H230.105V75.818h107.95v23.309H338.055z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,317.548h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,317.548,254.433,317.548z\"\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,355.124h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,358.482,258.577,355.124,254.433,355.124z\"\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,392.698h-97.159c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 S258.577,392.698,254.433,392.698z\"\n});\n\nvar _ref6 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,317.548h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 S391.226,317.548,387.082,317.548z\"\n});\n\nvar _ref7 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M329.632,274.728c0-4.142-3.357-7.5-7.5-7.5h-97.16c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5h97.16 C326.274,282.228,329.632,278.87,329.632,274.728z\"\n});\n\nvar _ref8 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M387.082,355.124h-97.16c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.16c4.143,0,7.5-3.358,7.5-7.5 C394.583,358.482,391.226,355.124,387.082,355.124z\"\n});\n\nvar _ref9 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M254.433,430.273h-97.159c-4.143,0-7.5,3.358-7.5,7.5c0,4.142,3.357,7.5,7.5,7.5h97.159c4.143,0,7.5-3.358,7.5-7.5 C261.934,433.631,258.577,430.273,254.433,430.273z\"\n});\n\nvar _ref10 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M444.04,0H289.236c-4.143,0-7.5,3.358-7.5,7.5s3.357,7.5,7.5,7.5H444.04c4.444,0,8.061,3.616,8.061,8.06v215.437 c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5V23.061C467.102,10.346,456.757,0,444.04,0z\"\n});\n\nvar _ref11 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M459.602,266c-4.143,0-7.5,3.358-7.5,7.5v119.197c-4.693,0-151.358,0-162.179,0c-4.143,0-7.5,3.358-7.5,7.5 s3.357,7.5,7.5,7.5h59.335c-0.939,2.51-1.457,5.226-1.457,8.06v14.514h-57.878c-4.143,0-7.5,3.358-7.5,7.5 c0,4.142,3.357,7.5,7.5,7.5H347.8v51.725H122.344c-4.444,0-8.061-3.616-8.061-8.06V23.061c0-4.444,3.616-8.06,8.061-8.06h131.889 c4.143,0,7.5-3.358,7.5-7.5s-3.357-7.5-7.5-7.5H67.959l0,0C55.243,0,44.898,10.346,44.898,23.061v465.877 c0,12.716,10.346,23.061,23.061,23.061l0,0h287.341c0.041,0,0.08-0.005,0.12-0.006c2.005-0.033,3.861-0.87,5.184-2.191 l104.301-104.3c1.333-1.332,2.196-3.245,2.196-5.303V273.502C467.102,269.358,463.744,266,459.602,266z M100.736,496.999H67.959 c-4.444,0-8.06-3.616-8.06-8.06V23.061c0-4.444,3.615-8.06,8.06-8.06h32.777c-0.901,2.496-1.453,5.115-1.453,8.06v465.877 C99.283,491.82,99.815,494.448,100.736,496.999z M362.801,486.391v-70.632c0-4.444,3.615-8.06,8.06-8.06c7.587,0,62.354,0,70.633,0 C433.153,416.039,371.141,478.051,362.801,486.391z\"\n});\n\nvar _ref12 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref13 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref14 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref15 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref16 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref17 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref18 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref19 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref20 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref21 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref22 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref23 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref24 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref25 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar _ref26 =\n/*#__PURE__*/\nReact.createElement(\"g\", null);\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M107.736,489.624V23.576c0-8.598,6.969-15.567,15.567-15.567H68.896 c-8.598,0-15.567,6.969-15.567,15.567v466.047c0,8.598,6.969,15.567,15.567,15.567h54.405 C114.704,505.191,107.736,498.221,107.736,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M73.331,489.624V23.576c0-8.598,6.969-15.567,15.566-15.567H68.896 c-8.598,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.001 C80.301,505.191,73.331,498.221,73.331,489.624z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EADCD6\"\n    },\n    d: \"M444.015,8.01H122.202c-8.598,0-15.567,6.969-15.567,15.567v466.047 c0,8.598,6.969,15.567,15.567,15.567h233.041l104.339-104.339c0-3.762,0-370.62,0-377.275C459.582,14.98,452.612,8.01,444.015,8.01z \"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M127.051,489.624V23.577c0-8.598,6.969-15.567,15.567-15.567h-20.415 c-8.597,0-15.566,6.969-15.566,15.567v466.047c0,8.598,6.969,15.567,15.566,15.567h20.415 C134.02,505.191,127.051,498.221,127.051,489.624z\"\n  }), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    d: \"M353.931,107.32H230.98V75.342c0-3.498,2.836-6.333,6.333-6.333h110.125 c3.586,0,6.492,2.907,6.492,6.492v31.819H353.931z\"\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 201.212,\n    cy: 201.242,\n    r: 22.708\n  }), React.createElement(\"circle\", {\n    style: {\n      fill: \"#F8BF00\"\n    },\n    cx: 331.22,\n    cy: 201.242,\n    r: 22.708\n  })), React.createElement(\"g\", null, React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M257.315,69.008h-20.001c-3.498,0-6.333,2.836-6.333,6.333v31.977h20.001V75.342 C250.981,71.844,253.817,69.008,257.315,69.008z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M198.503,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C203.685,217.933,198.503,210.195,198.503,201.242z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#EFA603\"\n    },\n    d: \"M328.516,201.242c0-8.952,5.181-16.691,12.708-20.389c-3.018-1.483-6.411-2.319-10.001-2.319 c-12.542,0-22.708,10.167-22.708,22.708c0,12.542,10.167,22.708,22.708,22.708c3.589,0,6.982-0.836,10.001-2.319 C333.697,217.933,328.516,210.195,328.516,201.242z\"\n  })), React.createElement(\"path\", {\n    style: {\n      fill: \"#DDCDC7\"\n    },\n    d: \"M459.582,400.852h-88.772c-8.598,0-15.567,6.969-15.567,15.567v88.772L459.582,400.852z\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#C9BCB8\"\n    },\n    d: \"M375.245,416.418c0-8.598,6.969-15.567,15.567-15.567H370.81c-8.598,0-15.567,6.969-15.567,15.567 v88.772l20.001-20.001V416.418z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16, _ref17, _ref18, _ref19, _ref20, _ref21, _ref22, _ref23, _ref24, _ref25, _ref26);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dd187a77.svg\";\nexport { ForwardRef as ReactComponent };","import { Grid } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Button from \"@material-ui/core/Button\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { Theme, WithStyles, withStyles } from \"@material-ui/core/styles\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport MusicVideoIcon from \"@material-ui/icons/MusicVideo\";\nimport PrintIcon from \"@material-ui/icons/Print\";\nimport RadioIcon from \"@material-ui/icons/Radio\";\nimport React from \"react\";\nimport { FunctionComponent } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport DefaultPage from \"../../pages/default/defaultPage\";\nimport DrumPage from \"../../pages/drum/drumPage\";\nimport GuitarPage from \"../../pages/guitar/guitarPage\";\nimport HarmonyPage from \"../../pages/harmony/harmonyPage\";\nimport PrintPage from \"../../pages/print/printPage\";\nimport StructurePage from \"../../pages/structure/structurePage\";\nimport { DialogType, openedDialog } from \"../../states/dialogsSlice\";\nimport { LoadingStatus } from \"../../states/projectSlice\";\nimport { Page, switchedPage } from \"../../states/projectSlice\";\nimport { ApplicationState } from \"../../states/store\";\nimport { stylesForApp } from \"../../styles/styles\";\nimport Log from \"../log/log\";\nimport VersionInfo from \"../versionInfo/versionInfo\";\nimport { ReactComponent as Logo } from \"./logo.svg\";\n\ninterface PropsFromState {\n  currentPage: Page;\n  status: LoadingStatus;\n  title: string;\n}\n\ninterface PropsFromDispatch {\n  switchedPage: typeof switchedPage;\n  openedDialog: typeof openedDialog;\n}\n\ninterface Props extends WithStyles<typeof stylesForApp> {\n  theme: Theme;\n}\n\ntype AllProps = Props & PropsFromState & PropsFromDispatch;\n\nclass App extends React.Component<AllProps> {\n  render() {\n    Log.info(\"render\", App.name);\n    return (\n      <>\n        <div className={this.props.classes.root}>\n          <AppBar position=\"fixed\" className={this.props.classes.appBar}>\n            <Toolbar>\n              <Logo height=\"40px\" style={{ marginRight: \"5px\" }}></Logo>\n              <Typography color=\"textPrimary\" variant=\"h4\" noWrap>\n                Transcribe\n              </Typography>\n              <Typography\n                color=\"textPrimary\"\n                variant=\"caption\"\n                noWrap\n                className={this.props.classes.title}\n              >\n                [{this.props.title !== \"\" ? this.props.title : \"no file loaded\"}\n                ]\n              </Typography>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.NEW)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                New\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.OPEN)}\n                disabled={this.props.status === LoadingStatus.INITIALIZING}\n              >\n                Open\n              </Button>\n              <Button\n                onClick={() => this.props.openedDialog(DialogType.SAVE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                Save\n              </Button>\n            </Toolbar>\n          </AppBar>\n          <Drawer\n            className={this.props.classes.drawer}\n            variant=\"permanent\"\n            classes={{\n              paper: this.props.classes.drawerPaper\n            }}\n          >\n            <div className={this.props.classes.toolbar} />\n            <List style={{ color: \"#abb1b7\" }}>\n              <ListItem\n                button\n                key=\"Structure\"\n                onClick={() => this.props.switchedPage(Page.STRUCTURE)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <HomeIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Structure\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Harmony\"\n                onClick={() => this.props.switchedPage(Page.HARMONY)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <MusicVideoIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Harmony\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Guitar\"\n                onClick={() => this.props.switchedPage(Page.GUITAR)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <RadioIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Guitar\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Drum\"\n                onClick={() => this.props.switchedPage(Page.DRUM)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <AlbumIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Drum\" />\n              </ListItem>\n              <ListItem\n                button\n                key=\"Print\"\n                onClick={() => this.props.switchedPage(Page.PRINT)}\n                disabled={this.props.status !== LoadingStatus.INITIALIZED}\n              >\n                <ListItemIcon style={{ color: \"#abb1b7\" }}>\n                  <PrintIcon />\n                </ListItemIcon>\n                <ListItemText primary=\"Print\" />\n              </ListItem>\n            </List>\n          </Drawer>\n          <main className={this.props.classes.content}>\n            <div className={this.props.classes.toolbar} />\n            <Toggle show={this.props.currentPage === Page.DEFAULT}>\n              <DefaultPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.STRUCTURE}>\n              <StructurePage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.HARMONY}>\n              <HarmonyPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.GUITAR}>\n              <GuitarPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.DRUM}>\n              <DrumPage />\n            </Toggle>\n            <Toggle show={this.props.currentPage === Page.PRINT}>\n              <PrintPage />\n            </Toggle>\n            <Grid\n              container\n              direction=\"column\"\n              justify=\"flex-end\"\n              alignItems=\"flex-end\"\n              style={{ marginTop: \"20px\" }}\n            >\n              <Grid item>\n                App version:{\" \"}\n                <VersionInfo\n                  version={process.env.REACT_APP_VERSION ?? \"\"}\n                  hash={process.env.REACT_APP_VERSION_HASH ?? \"\"}\n                  description={process.env.REACT_APP_VERSION_DESCRIPTION ?? \"\"}\n                />\n              </Grid>\n            </Grid>\n          </main>\n        </div>\n      </>\n    );\n  }\n}\n\nconst Toggle: FunctionComponent<{ show: boolean }> = props => {\n  if (props.show) {\n    return <div style={{ display: \"inline\" }}>{props.children}</div>;\n  } else {\n    return <div style={{ display: \"none\" }}>{props.children}</div>;\n  }\n};\n\nconst mapStateToProps = ({ project }: ApplicationState) => {\n  return {\n    currentPage: project.currentPage,\n    status: project.status,\n    title: project.title\n  };\n};\n\nconst mapDispatchToProps = {\n  switchedPage,\n  openedDialog\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(stylesForApp, { withTheme: true })(App));\n","import { createStyles, Theme } from \"@material-ui/core/styles\";\r\n\r\nconst drawerWidth = 190;\r\n\r\nexport const stylesForApp = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: \"flex\",\r\n      backgroundColor: \"#d5d8da\"\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      backgroundColor: \"#FFFFFF\"\r\n    },\r\n    drawer: {\r\n      width: drawerWidth,\r\n      flexShrink: 0\r\n    },\r\n    drawerPaper: {\r\n      width: drawerWidth,\r\n      backgroundColor: \"#202a2f\"\r\n    },\r\n    content: {\r\n      flexGrow: 1,\r\n      padding: theme.spacing(3)\r\n    },\r\n    toolbar: theme.mixins.toolbar,\r\n    title: {\r\n      flexGrow: 1,\r\n      marginLeft: \"50px\"\r\n    }\r\n  });\r\n","import { saveAs } from \"file-saver\";\r\nimport JSZip from \"jszip\";\r\n\r\nimport { PersistedState } from \"../states/store\";\r\n\r\ninterface SaveOptions {\r\n  audioFileUrl: string;\r\n  state: PersistedState;\r\n}\r\n\r\nclass PersistenceApi {\r\n  private constructor() {}\r\n\r\n  private static songFile = \"song.blob\";\r\n  private static stateFile = \"state.json\";\r\n\r\n  static save = async (filename: string, options: SaveOptions) => {\r\n    let zip = new JSZip();\r\n    zip.file(PersistenceApi.stateFile, JSON.stringify(options.state));\r\n\r\n    let response = await fetch(options.audioFileUrl);\r\n    let audioBlob: Blob = await response.blob();\r\n    zip.file(PersistenceApi.songFile, audioBlob);\r\n\r\n    await zip.generateAsync({ type: \"blob\" }).then(file => {\r\n      saveAs(file, filename);\r\n    });\r\n  };\r\n\r\n  static async open(\r\n    zip: File\r\n  ): Promise<{ audioBlob: Blob; state: PersistedState }> {\r\n    let archive = await JSZip.loadAsync(zip);\r\n    let audioBlob = await archive.file(PersistenceApi.songFile).async(\"blob\");\r\n\r\n    let json = await archive.file(PersistenceApi.stateFile).async(\"text\");\r\n    let state: PersistedState = JSON.parse(json);\r\n\r\n    return { audioBlob, state };\r\n  }\r\n\r\n  static revokeLocalFile(url: string) {\r\n    window.URL.revokeObjectURL(url);\r\n  }\r\n\r\n  static getLocalFileUrl(blob: Blob) {\r\n    return window.URL.createObjectURL(blob);\r\n  }\r\n}\r\n\r\nexport default PersistenceApi;\r\n","import {\r\n  createStyles,\r\n  InputBase,\r\n  Theme,\r\n  WithStyles,\r\n  withStyles\r\n} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport MenuIcon from \"@material-ui/icons/OpenInBrowser\";\r\nimport React from \"react\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\n\r\nexport enum FileType {\r\n  AUDIO = \"audio/*\",\r\n  ZIP = \".zip\"\r\n}\r\n\r\nconst toString = (type: FileType) => {\r\n  switch (type) {\r\n    case FileType.AUDIO:\r\n      return \"Audio File\";\r\n    case FileType.ZIP:\r\n      return \"Project Zip File\";\r\n  }\r\n};\r\n\r\ninterface Props extends WithStyles<typeof stylesForFileInput> {\r\n  id: string;\r\n  fileType: FileType;\r\n  callback: (file: File, fileUrl: string) => void;\r\n}\r\n\r\ninterface State {\r\n  display: string;\r\n}\r\n\r\nconst stylesForFileInput = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      padding: \"4px 0px\",\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      width: \"100%\"\r\n    },\r\n    input: {\r\n      marginLeft: theme.spacing(1),\r\n      flex: 1\r\n    },\r\n    iconButton: {\r\n      padding: 10\r\n    }\r\n  });\r\n\r\nclass FileInput extends React.Component<Props, State> {\r\n  state: State = {\r\n    display: \"\"\r\n  };\r\n\r\n  fileInput: React.RefObject<HTMLInputElement>;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.fileInput = React.createRef();\r\n  }\r\n\r\n  handleChange = (fileList: FileList | null) => {\r\n    if (fileList === null) return;\r\n\r\n    var file = fileList[0];\r\n    var fileURL = PersistenceApi.getLocalFileUrl(file);\r\n\r\n    this.setState({ display: file.name });\r\n    this.props.callback(file, fileURL);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Paper component=\"form\" className={this.props.classes.root}>\r\n          <InputBase\r\n            className={this.props.classes.input}\r\n            placeholder={\"Choose \" + toString(this.props.fileType) + \" ...\"}\r\n            inputProps={{\r\n              \"aria-label\": \"Choose \" + toString(this.props.fileType)\r\n            }}\r\n            value={this.state.display}\r\n            readOnly={true}\r\n            onClick={() => this.fileInput.current?.click()}\r\n          />\r\n          <IconButton\r\n            aria-label=\"menu\"\r\n            onClick={() => this.fileInput.current?.click()}\r\n            className={this.props.classes.iconButton}\r\n          >\r\n            <MenuIcon />{\" \"}\r\n          </IconButton>\r\n        </Paper>\r\n        <input\r\n          hidden={true}\r\n          id={this.props.id}\r\n          type=\"file\"\r\n          accept={this.props.fileType}\r\n          ref={this.fileInput}\r\n          onChange={e => this.handleChange(e.target.files)}\r\n        ></input>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(stylesForFileInput, { withTheme: true })(FileInput);\r\n","import { PeaksInstance } from \"peaks.js\";\r\nimport Tone from \"tone\";\r\n\r\ninterface Player {\r\n  destroy: () => void;\r\n  play: () => void;\r\n  pause: () => void;\r\n  isPlaying: () => boolean;\r\n  isSeeking: () => boolean;\r\n  getCurrentTime: () => number;\r\n  getDuration: () => number;\r\n  seek: (time: number) => void;\r\n  setPlaybackRate: (playbackRate: number) => void;\r\n  setDetune: (pitch: number) => void;\r\n}\r\n\r\ninterface EmitAware {\r\n  emit: (id: string, value: any) => void;\r\n}\r\n\r\nexport interface PeaksInstanceEmitAware extends PeaksInstance, EmitAware {}\r\n\r\n/**\r\n * Tone.js Player replacement for the <audio>-element based Peaks.js player\r\n */\r\nclass AudioPlayer implements Player {\r\n  peaks: PeaksInstanceEmitAware;\r\n  player: Tone.Player;\r\n  pitchShift: Tone.PitchShift;\r\n\r\n  constructor(\r\n    peaks: PeaksInstance,\r\n    audioBuffer: AudioBuffer,\r\n    onSongComplete: () => void\r\n  ) {\r\n    this.peaks = peaks as PeaksInstanceEmitAware;\r\n\r\n    this.player = new Tone.Player(audioBuffer);\r\n    this.player.sync();\r\n    this.player.start();\r\n\r\n    this.pitchShift = new Tone.PitchShift();\r\n\r\n    Tone.connectSeries(this.player, this.pitchShift, Tone.Master);\r\n\r\n    Tone.Transport.scheduleRepeat(time => {\r\n      this.peaks.emit(\"player_time_update\", this.getCurrentTime());\r\n      if (this.getCurrentTime() >= this.getDuration()) {\r\n        Tone.Transport.stop();\r\n        onSongComplete();\r\n      }\r\n    }, 0.03);\r\n\r\n    this.peaks.emit(\"player_canplay\", this);\r\n  }\r\n\r\n  shiftToSemitones = (shift: number) => 12 * Math.log2(1 / shift);\r\n\r\n  setPlaybackRate(playbackRate: number) {\r\n    this.player.playbackRate = playbackRate;\r\n\r\n    this.pitchShift.pitch = this.shiftToSemitones(playbackRate);\r\n  }\r\n\r\n  setDetune(detune: number) {\r\n    this.pitchShift.pitch =\r\n      this.shiftToSemitones(this.player.playbackRate) + detune;\r\n  }\r\n\r\n  destroy = () => {\r\n    Tone.context.dispose();\r\n    ((Tone as unknown) as Tone & {\r\n      setContext: (ctx: AudioContext) => void;\r\n    }).setContext(new AudioContext());\r\n  };\r\n\r\n  play = () => {\r\n    Tone.Transport.start(Tone.now(), this.getCurrentTime());\r\n    this.peaks.emit(\"player_play\", this.getCurrentTime());\r\n  };\r\n\r\n  pause = () => {\r\n    Tone.Transport.pause();\r\n    this.peaks.emit(\"player_pause\", this.getCurrentTime());\r\n  };\r\n\r\n  isPlaying = () => {\r\n    return Tone.Transport.state === \"started\";\r\n  };\r\n\r\n  isSeeking = () => {\r\n    return false;\r\n  };\r\n\r\n  getCurrentTime = () => {\r\n    return (\r\n      this.player.buffer.toSeconds(Tone.Transport.position) *\r\n      this.player.playbackRate\r\n    );\r\n  };\r\n\r\n  getDuration = () => {\r\n    return this.player.buffer.duration;\r\n  };\r\n\r\n  seek = (time: number) => {\r\n    const normalizedTime = time * this.player.playbackRate;\r\n\r\n    if (this.isPlaying()) {\r\n      Tone.Transport.stop();\r\n      Tone.Transport.start(Tone.now(), normalizedTime);\r\n    } else {\r\n      Tone.Transport.start(Tone.now(), normalizedTime);\r\n      Tone.Transport.pause();\r\n    }\r\n    this.peaks.emit(\"player_time_update\", normalizedTime);\r\n    this.peaks.emit(\"player_seek\", normalizedTime);\r\n  };\r\n}\r\n\r\nexport default AudioPlayer;\r\n","import Peaks, { PeaksInstance } from \"peaks.js\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Tone from \"tone\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport { Measure, Section, updatedRhythm } from \"../../states/analysisSlice\";\r\nimport { triggeredPause } from \"../../states/audioSlice\";\r\nimport { initializedProject, LoadingStatus } from \"../../states/projectSlice\";\r\nimport { ApplicationState, NormalizedObjects } from \"../../states/store\";\r\nimport Log from \"../log/log\";\r\nimport AudioPlayer from \"./audioPlayer\";\r\nimport PeaksConfig, {\r\n  AUDIO_DOM_ELEMENT,\r\n  ZOOMVIEW_CONTAINER\r\n} from \"./peaksConfig\";\r\n\r\ninterface PropsFromState {\r\n  audioUrl: string;\r\n  status: LoadingStatus;\r\n  sections: NormalizedObjects<Section>;\r\n  measures: NormalizedObjects<Measure>;\r\n  zoomLevel: number;\r\n  syncFirstMeasureStart: boolean;\r\n  isPlaying: boolean;\r\n  detune: number;\r\n  playbackRate: number;\r\n  secondsPerMeasure: number;\r\n  audioSampleRate: number;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  initializedProject: typeof initializedProject;\r\n  updatedRhythm: typeof updatedRhythm;\r\n  triggeredPause: typeof triggeredPause;\r\n}\r\n\r\ninterface Props {}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch & Props;\r\n\r\nclass AudioManagement extends React.Component<AllProps> {\r\n  peaks: Peaks.PeaksInstance | undefined;\r\n  player: AudioPlayer | undefined;\r\n\r\n  private getPeaks = () => this.peaks;\r\n  private getPlayer = () => this.player;\r\n\r\n  componentDidUpdate(prevProps: AllProps) {\r\n    Log.info(\r\n      \"componentDidUpdate with status \" +\r\n        prevProps.status +\r\n        \" -> \" +\r\n        this.props.status,\r\n      AudioManagement.name\r\n    );\r\n\r\n    // Early return if there is no audio file initialized yet.\r\n    if (this.props.status === LoadingStatus.NOT_INITIALIZED) return;\r\n\r\n    // Early return if an initialization is still in progress\r\n    if (\r\n      prevProps.status === this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    )\r\n      return;\r\n\r\n    // Initialize audio management if status changed to init\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZING\r\n    ) {\r\n      Log.info(\"initialize audio engine\", AudioManagement.name);\r\n      if (prevProps.audioUrl !== this.props.audioUrl) {\r\n        Log.info(\r\n          \"switch from \" + prevProps.audioUrl + \" to \" + this.props.audioUrl,\r\n          AudioManagement.name\r\n        );\r\n        PersistenceApi.revokeLocalFile(prevProps.audioUrl);\r\n      }\r\n      this.init();\r\n      return;\r\n    }\r\n\r\n    if (\r\n      prevProps.status !== this.props.status &&\r\n      this.props.status === LoadingStatus.INITIALIZED\r\n    ) {\r\n      this.recomputeZoomlevels(\r\n        this.props.secondsPerMeasure,\r\n        this.props.audioSampleRate,\r\n        this.props.measures.allIds.length\r\n      );\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.zoomLevel\r\n      );\r\n    }\r\n\r\n    if (\r\n      prevProps.secondsPerMeasure !== this.props.secondsPerMeasure ||\r\n      prevProps.audioSampleRate !== this.props.audioSampleRate ||\r\n      prevProps.measures.allIds.length !== this.props.measures.allIds.length\r\n    ) {\r\n      this.recomputeZoomlevels(\r\n        this.props.secondsPerMeasure,\r\n        this.props.audioSampleRate,\r\n        this.props.measures.allIds.length\r\n      );\r\n    }\r\n\r\n    if (\r\n      prevProps.sections !== this.props.sections ||\r\n      prevProps.measures !== this.props.measures ||\r\n      prevProps.zoomLevel !== this.props.zoomLevel\r\n    ) {\r\n      this.repaintWaveform(\r\n        this.props.sections,\r\n        this.props.measures,\r\n        this.props.zoomLevel\r\n      );\r\n    }\r\n\r\n    if (prevProps.playbackRate !== this.props.playbackRate) {\r\n      this.getPlayer()?.setPlaybackRate(this.props.playbackRate);\r\n    }\r\n\r\n    if (prevProps.detune !== this.props.detune) {\r\n      this.getPlayer()?.setDetune(this.props.detune);\r\n    }\r\n\r\n    if (prevProps.isPlaying !== this.props.isPlaying) {\r\n      if (this.props.isPlaying) {\r\n        this.getPlayer()?.play();\r\n      } else {\r\n        this.getPlayer()?.pause();\r\n      }\r\n    }\r\n  }\r\n\r\n  private recomputeZoomlevels(\r\n    secondsPerMeasure: number,\r\n    audioSampleRate: number,\r\n    measuresCount: number\r\n  ) {\r\n    let newZoomLevels = PeaksConfig.computeZoomLevels(\r\n      secondsPerMeasure,\r\n      audioSampleRate,\r\n      document.getElementById(ZOOMVIEW_CONTAINER)!.clientWidth,\r\n      measuresCount\r\n    );\r\n\r\n    //TODO: Used any because setZoomlevel is not API. See https://github.com/bbc/peaks.js/issues/295.\r\n    (this.getPeaks()?.zoom as any).setZoomLevels(newZoomLevels);\r\n  }\r\n\r\n  private repaintWaveform(\r\n    sections: NormalizedObjects<Section>,\r\n    measures: NormalizedObjects<Measure>,\r\n    zoomLevel: number\r\n  ) {\r\n    this.getPeaks()?.segments.removeAll();\r\n    this.getPeaks()?.segments.add(\r\n      PeaksConfig.sectionsToSegment(sections, measures)\r\n    );\r\n    this.getPeaks()?.points.removeAll();\r\n    this.getPeaks()?.points.add(PeaksConfig.measuresToPoints(measures));\r\n    this.getPeaks()?.zoom.setZoom(zoomLevel);\r\n  }\r\n\r\n  private init = () => {\r\n    const audioCtx: AudioContext = (Tone.context as unknown) as AudioContext;\r\n\r\n    this.getPeaks()?.destroy();\r\n\r\n    let audio = this;\r\n\r\n    // Load audioFile into audio buffer\r\n    fetch(this.props.audioUrl)\r\n      .then(function(response) {\r\n        return response.arrayBuffer();\r\n      })\r\n      .then(function(buffer) {\r\n        return audioCtx.decodeAudioData(buffer);\r\n      })\r\n      .then(function(audioBuffer) {\r\n        audio.initPeaks(audioBuffer);\r\n      });\r\n  };\r\n\r\n  private initPeaks(audioBuffer: AudioBuffer) {\r\n    Log.info(\"init peaks\", AudioManagement.name);\r\n\r\n    Peaks.init(PeaksConfig.create(audioBuffer), (err, peaks) => {\r\n      if (err) throw err;\r\n      if (peaks === undefined)\r\n        throw new Error(\"Peaks instance is not correctly initialized.\");\r\n\r\n      initPlayer(peaks, audioBuffer);\r\n      replacePlayer(peaks, audioBuffer);\r\n\r\n      peaks.on(\"player_seek\", (time: number) => {\r\n        if (this.props.syncFirstMeasureStart)\r\n          this.props.updatedRhythm({ firstMeasureStart: time });\r\n      });\r\n\r\n      this.peaks = peaks;\r\n\r\n      this.props.initializedProject({\r\n        audioDuration: audioBuffer.duration,\r\n        audioSampleRate: audioBuffer.sampleRate\r\n      });\r\n    });\r\n\r\n    let initPlayer = (peaks: Peaks.PeaksInstance, audioBuffer: AudioBuffer) => {\r\n      this.player = new AudioPlayer(peaks, audioBuffer, () =>\r\n        this.props.triggeredPause()\r\n      );\r\n    };\r\n\r\n    let replacePlayer = (\r\n      peaks: Peaks.PeaksInstance,\r\n      audioBuffer: AudioBuffer\r\n    ) => {\r\n      (peaks.player as any).destroy();\r\n      peaks.player = (this.player as unknown) as PeaksInstance[\"player\"];\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <audio id={AUDIO_DOM_ELEMENT} controls hidden>\r\n        {this.props.audioUrl ? (\r\n          <source src={this.props.audioUrl} type=\"audio/mpeg\" />\r\n        ) : null}\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({\r\n  project,\r\n  analysis,\r\n  audio,\r\n  wave\r\n}: ApplicationState) => {\r\n  return {\r\n    audioUrl: project.audioUrl,\r\n    sections: analysis.sections,\r\n    measures: analysis.measures,\r\n    zoomLevel: wave.zoom,\r\n    status: project.status,\r\n    syncFirstMeasureStart: project.syncFirstMeasureStart,\r\n    isPlaying: audio.isPlaying,\r\n    detune: audio.detune,\r\n    playbackRate: audio.playbackRate,\r\n    secondsPerMeasure:\r\n      analysis.measures.byId[\"1\"]?.time - analysis.measures.byId[\"0\"]?.time,\r\n    audioSampleRate: analysis.audioSampleRate\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  initializedProject,\r\n  updatedRhythm,\r\n  triggeredPause\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AudioManagement);\r\n","import { configureStore, createAction } from \"@reduxjs/toolkit\";\r\nimport { AnyAction, combineReducers, Reducer } from \"redux\";\r\n\r\nimport analysisReducer, { AnalysisState } from \"./analysisSlice\";\r\nimport audioReducer, { AudioState } from \"./audioSlice\";\r\nimport dialogReducer, { DialogState } from \"./dialogsSlice\";\r\nimport projectReducer, { ProjectState } from \"./projectSlice\";\r\nimport waveReducer, { WaveState } from \"./waveSlice\";\r\n\r\n/** The top-level application state object. */\r\nexport interface ApplicationState {\r\n  analysis: AnalysisState;\r\n  audio: AudioState;\r\n  dialog: DialogState;\r\n  project: ProjectState;\r\n  wave: WaveState;\r\n}\r\n\r\nexport interface PersistedState {\r\n  analysis: AnalysisState;\r\n  project: ProjectState;\r\n}\r\n\r\nexport interface NormalizedObjects<T> {\r\n  byId: { [id: string]: T };\r\n  allIds: string[];\r\n}\r\n\r\nexport const restoredPersistedState = createAction<PersistedState>(\r\n  \"restoredPersistedState\"\r\n);\r\n\r\nexport const createRootReducer: Reducer<ApplicationState, AnyAction> = (\r\n  state,\r\n  action\r\n) => {\r\n  state = sliceReducer(state, action);\r\n\r\n  if (restoredPersistedState.match(action)) {\r\n    return state;\r\n  }\r\n\r\n  return state;\r\n};\r\n\r\nexport const sliceReducer = combineReducers({\r\n  analysis: analysisReducer,\r\n  audio: audioReducer,\r\n  dialog: dialogReducer,\r\n  project: projectReducer,\r\n  wave: waveReducer\r\n});\r\n\r\nconst createAppStore = () => {\r\n  const store = configureStore({\r\n    reducer: createRootReducer,\r\n    preloadedState: undefined\r\n  });\r\n\r\n  if (process.env.NODE_ENV !== \"production\" && module.hot) {\r\n    module.hot.accept(\"./store\", () => store.replaceReducer(createRootReducer));\r\n  }\r\n  return store;\r\n};\r\n\r\nexport default createAppStore();\r\n","import { DialogActions, DialogContent } from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\ninterface DialogAction {\r\n  label: string;\r\n  onClick: () => void;\r\n}\r\n\r\ninterface ModalDialogProps {\r\n  title: string;\r\n  onCancel: () => void;\r\n  actions?: DialogAction[];\r\n}\r\n\r\nclass ModalDialog extends Component<ModalDialogProps> {\r\n  render() {\r\n    return (\r\n      <Dialog\r\n        onClose={this.props.onCancel}\r\n        open={true}\r\n        fullWidth={true}\r\n        maxWidth={\"sm\"}\r\n      >\r\n        <DialogTitle>{this.props.title}</DialogTitle>\r\n        <DialogContent>{this.props.children}</DialogContent>\r\n        <DialogActions>\r\n          {this.props.actions?.map((value, index) => (\r\n            <Button key={value.label} onClick={value.onClick} color=\"primary\">\r\n              {value.label}\r\n            </Button>\r\n          ))}\r\n        </DialogActions>\r\n      </Dialog>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ModalDialog;\r\n","import FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport React, { Component, FunctionComponent, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport PersistenceApi from \"../../api/persistenceApi\";\r\nimport { initialAnalysisState } from \"../../states/analysisSlice\";\r\nimport { closedDialog, DialogType } from \"../../states/dialogsSlice\";\r\nimport {\r\n  createdProject,\r\n  initialProjectState,\r\n  Page,\r\n  switchedPage\r\n} from \"../../states/projectSlice\";\r\nimport store, { ApplicationState } from \"../../states/store\";\r\nimport FileInput, { FileType } from \"../fileInput/fileInput\";\r\nimport ModalDialog from \"../modalDialog/modalDialog\";\r\n\r\ninterface PropsFromState {\r\n  type: DialogType;\r\n  audioUrl: string;\r\n}\r\n\r\ninterface PropsFromDispatch {\r\n  switchedPage: typeof switchedPage;\r\n  closedDialog: typeof closedDialog;\r\n  createdProject: typeof createdProject;\r\n}\r\n\r\ntype AllProps = PropsFromState & PropsFromDispatch;\r\n\r\nclass DialogManagement extends Component<AllProps> {\r\n  render() {\r\n    switch (this.props.type) {\r\n      case DialogType.NONE:\r\n        return null;\r\n      case DialogType.NEW:\r\n        return (\r\n          <NewDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(title: string, audioUrl: string) => {\r\n              this.props.createdProject({\r\n                analysis: initialAnalysisState,\r\n                project: { ...initialProjectState, audioUrl, title }\r\n              });\r\n              this.props.switchedPage(Page.STRUCTURE);\r\n              this.props.closedDialog();\r\n            }}\r\n          ></NewDialog>\r\n        );\r\n      case DialogType.OPEN:\r\n        return (\r\n          <OpenDialog\r\n            onCancel={() => this.props.closedDialog()}\r\n            onSubmit={(zip: File, zipUrl: string) => {\r\n              PersistenceApi.open(zip).then(({ audioBlob, state }) => {\r\n                let audioUrl = PersistenceApi.getLocalFileUrl(audioBlob);\r\n                PersistenceApi.revokeLocalFile(zipUrl);\r\n\r\n                this.props.createdProject({\r\n                  analysis: state.analysis,\r\n                  project: { ...state.project, audioUrl }\r\n                });\r\n                this.props.switchedPage(Page.STRUCTURE);\r\n                this.props.closedDialog();\r\n              });\r\n            }}\r\n          ></OpenDialog>\r\n        );\r\n      case DialogType.SAVE:\r\n        return (\r\n          <ModalDialog\r\n            title=\"Save Transcription\"\r\n            onCancel={this.props.closedDialog}\r\n            actions={[\r\n              {\r\n                label: \"Save\",\r\n                onClick: () => {\r\n                  PersistenceApi.save(\"transcription.zip\", {\r\n                    audioFileUrl: this.props.audioUrl,\r\n                    state: store.getState()\r\n                  });\r\n                  this.props.closedDialog();\r\n                }\r\n              }\r\n            ]}\r\n          >\r\n            <p>Save Transcription</p>\r\n          </ModalDialog>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n}\r\n\r\nconst NewDialog: FunctionComponent<{\r\n  onSubmit: (title: string, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [title, setTitle] = useState(\"\");\r\n\r\n  const handleTitleChange = (event: any) => setTitle(event.target.value);\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Create new Transcription\"\r\n      actions={[\r\n        {\r\n          label: \"Create\",\r\n          onClick: () => props.onSubmit(title, fileUrl)\r\n        }\r\n      ]}\r\n      onCancel={props.onCancel}\r\n    >\r\n      <FormControl fullWidth>\r\n        <TextField\r\n          id=\"title\"\r\n          label=\"Project title\"\r\n          margin=\"normal\"\r\n          InputProps={{\r\n            readOnly: false\r\n          }}\r\n          variant=\"outlined\"\r\n          onChange={handleTitleChange}\r\n        />\r\n        <FileInput\r\n          fileType={FileType.AUDIO}\r\n          id=\"audio_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst OpenDialog: FunctionComponent<{\r\n  onSubmit: (file: File, fileUrl: string) => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [file, setFile] = useState<File>();\r\n\r\n  return (\r\n    <ModalDialog\r\n      title=\"Open Transcription\"\r\n      onCancel={props.onCancel}\r\n      actions={[\r\n        {\r\n          label: \"Open\",\r\n          onClick: () => props.onSubmit(file!, fileUrl)\r\n        }\r\n      ]}\r\n    >\r\n      <FormControl>\r\n        <FileInput\r\n          fileType={FileType.ZIP}\r\n          id=\"zip_file\"\r\n          callback={(file, fileUrl) => {\r\n            setFileUrl(fileUrl);\r\n            setFile(file);\r\n          }}\r\n        ></FileInput>\r\n      </FormControl>\r\n    </ModalDialog>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ dialog, project }: ApplicationState) => {\r\n  return {\r\n    type: dialog.currentDialog,\r\n    audioUrl: project.audioUrl\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  closedDialog,\r\n  switchedPage,\r\n  createdProject\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogManagement);\r\n","import blueGrey from \"@material-ui/core/colors/blueGrey\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"light\",\n    primary: blueGrey\n  }\n});\n\nexport default theme;\n","import CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport React from \"react\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport App from \"./components/app/app\";\nimport AudioManagement from \"./components/audioManagement/audioManagement\";\nimport DialogManagement from \"./components/dialogManagement/dialogManagement\";\nimport store from \"./states/store\";\nimport theme from \"./styles/theme\";\n\nif (process.env.NODE_ENV !== \"production\") {\n  localStorage.setItem(\"debug\", \"transcribe:*\");\n}\n\nconst renderApp = () =>\n  render(\n    <Provider store={store}>\n      <ThemeProvider theme={theme}>\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n        <CssBaseline />\n        <AudioManagement />\n        <DialogManagement />\n        <App />\n      </ThemeProvider>\n    </Provider>,\n    document.getElementById(\"root\")\n  );\n\nif (process.env.NODE_ENV !== \"production\" && module.hot) {\n  module.hot.accept(\"./components/app/app\", renderApp);\n}\n\nrenderApp();\n"],"sourceRoot":""}